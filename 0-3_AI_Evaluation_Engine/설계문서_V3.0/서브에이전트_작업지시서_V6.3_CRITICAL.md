# V6.3 서브에이전트 작업지시서 (비판적 평가 강화)

## ⚠️ V6.3 핵심 변경사항

**문제**: V6.2에서 긍정 편향으로 과대평가 발생 (오세훈 892점 → 실제 750점 정도가 적정)
**원인**: 부정적 데이터 수집 부족 (부정 4.7%, 긍정 92.7%)
**해결**: 비판적 데이터 수집 의무화

---

## Step 1: 항목 파악

70개 항목 문서(`4_70개항목_구성내역_V6.2.md`)에서 **담당 카테고리의 7개 항목**을 확인합니다.

**예시**: 카테고리 1 (전문성)
```
## 분야 1: 전문성 (7개: 공식 4, 공개 3)
**1-1. 최종 학력 수준**
**1-2. 직무 관련 자격증 보유 개수**
...
**1-7. Google Scholar 피인용 수**
```

---

## Step 2: 데이터 수집 (⚠️ 비판적 평가 필수)

**각 항목당 10~30개 데이터 수집**

### 수집 규칙

1. **목표**: 항목당 최소 10개
2. **재시도**: 10개 미만 시 3회 추가 수집
3. **출처 다양성**: 공식 + 공개 데이터 균형

### ⚠️ 비판적 데이터 수집 의무 (V6.3 핵심)

**각 항목당 최소 30% 이상은 부정적/논란 사례 포함 필수**

#### 부정적 데이터 예시
- **실패 사례**: 공약 미이행, 정책 실패, 사업 중단
- **논란**: 윤리 논란, 특혜 의혹, 편파 행정
- **비판**: 시민단체 비판, 언론 문제 제기, 야당 지적
- **사고**: 참사 대응 실패, 안전 관리 소홀
- **갈등**: 시의회 대립, 주민투표 실패, 사퇴 사건
- **낭비**: 예산 낭비 논란, 불필요한 사업
- **처벌**: 법원 판결, 감사원 지적, 징계

#### 검색 키워드 (반드시 사용)
- "[정치인명] 논란"
- "[정치인명] 비판"
- "[정치인명] 실패"
- "[정치인명] 문제"
- "[정치인명] 의혹"
- "[정치인명] 사퇴"
- "[정치인명] 책임"

#### 출처 다양성 (비판적 관점 포함)
**공식 (Official)**
- 선거관리위원회
- 국회 의안정보시스템
- 정보공개포털
- 재산공개시스템
- **법원 판결문** (판결 확인)
- **감사원 감사 결과** (문제 지적)

**공개 (Public)**
- Wikipedia
- **시민단체 보고서** (참여연대, 경실련, 서울와치 등)
- **언론 기사** (문제 제기 기사 포함)
- SNS (공식 계정)
- Google Scholar

---

## Step 3: Rating 부여

**각 데이터에 -5 ~ +5 Rating**

| Rating | 평가 | 예시 |
|:---:|---|---|
| **+5** | 매우 좋음 | 국제 수상, 획기적 성과 |
| **+4** | 좋음 | 주요 법안 통과 |
| **+3** | 양호 | 활발한 활동 |
| **+2** | 약간 좋음 | 평균 이상 |
| **+1** | 조금 좋음 | 평균 근처 |
| **0** | 보통 | 평균 |
| **-1** | 조금 나쁨 | 소극적 |
| **-2** | 약간 나쁨 | 미이행 일부 |
| **-3** | 나쁨 | 윤리 논란, 공약 불이행 |
| **-4** | 매우 나쁨 | 법 위반, 참사 책임 |
| **-5** | 극도로 나쁨 | 범죄 유죄 판결 |

### Rating 원칙

1. **객관적 사실 기반**
2. **출처 신뢰도 고려**
3. **맥락 고려**
4. **일관성 유지**
5. **근거 명시** (rationale 필수)
6. **⚠️ 부정적 사건은 정확히 부정 Rating 부여** (긍정으로 해석하지 말 것!)

### Rating 예시 (오세훈 사례)

#### ❌ 잘못된 예시 (V6.2 문제)
```python
{
    'title': '무상급식 조례 거부권 행사',
    'content': '2011년 무상급식 조례에 거부권 행사, 주민투표 실시',
    'rating': +2,  # ❌ 잘못됨!
    'rationale': '주민투표라는 민주적 절차를 거쳐 결정'
}
```

#### ✅ 올바른 예시 (V6.3)
```python
{
    'title': '무상급식 조례 거부권으로 시장직 사퇴',
    'content': '2011년 무상급식 조례 거부권 → 주민투표 실패 (투표율 25.7%) → 시장직 사퇴',
    'rating': -4,  # ✅ 올바름!
    'rationale': '거부권 행사로 민의와 대립, 투표율 미달로 실패, 책임지고 사퇴한 중대 실패 사례'
}
```

#### ❌ 잘못된 예시
```python
{
    'title': '이태원 참사 대응',
    'content': '이태원 참사 후 재발 방지 대책 수립',
    'rating': +1,  # ❌ 잘못됨!
    'rationale': '재발 방지 노력'
}
```

#### ✅ 올바른 예시
```python
{
    'title': '이태원 참사 안전 관리 실패',
    'content': '이태원 참사 159명 사망, 사전 안전 대책 부재, 현장 통제 실패',
    'rating': -5,  # ✅ 올바름!
    'rationale': '대형 참사 발생, 사전 예방 실패, 159명 사망이라는 극단적 결과'
}
```

---

## Step 4: Supabase DB에 저장

### Python 코드 (Supabase Python SDK 사용)

```python
import os
from dotenv import load_dotenv
from supabase import create_client

load_dotenv()

# Supabase 연결
supabase = create_client(
    os.getenv('SUPABASE_URL'),
    os.getenv('SUPABASE_SERVICE_KEY')
)

# 데이터 삽입
for item_num in range(1, 8):  # 7개 항목
    for data_point in data_points:  # 각 항목당 10-30개

        data = {
            'politician_id': politician_id,  # 정치인 ID
            'ai_name': 'Claude',
            'category_num': category_num,  # 카테고리 번호
            'item_num': item_num,  # 항목 번호
            'data_title': data_point['title'],
            'data_content': data_point['content'],
            'data_source': data_point['source'],
            'source_url': data_point['url'],
            'collection_date': '2025-10-31',
            'rating': data_point['rating'],  # -5 ~ +5
            'rating_rationale': data_point['rationale'],
            'reliability': 0.85  # 출처 신뢰도
        }

        response = supabase.table('collected_data').insert(data).execute()
```

---

## Step 5: 자동 점수 계산 (DB 트리거)

데이터 삽입 후 자동 실행:

1. **ai_item_scores**: Item_Score = 7.0 + (평균 Rating × 0.6)
2. **ai_category_scores**: 7개 항목 평균 × 10
3. **ai_final_scores**: 10개 분야 합계 (10개 완료 시)

---

## Step 6: 검증

```python
# 데이터 수 확인
response = supabase.table('collected_data')\
    .select('*', count='exact')\
    .eq('politician_id', politician_id)\
    .eq('category_num', category_num)\
    .execute()

print(f"Total data: {response.count}")

# ⚠️ 부정 비율 확인 (30% 이상이어야 함)
response = supabase.table('collected_data')\
    .select('rating')\
    .eq('politician_id', politician_id)\
    .eq('category_num', category_num)\
    .execute()

ratings = [d['rating'] for d in response.data]
negative_count = len([r for r in ratings if r < 0])
negative_ratio = negative_count / len(ratings) * 100

print(f"Negative ratio: {negative_ratio:.1f}%")
if negative_ratio < 30:
    print("⚠️ WARNING: Too few negative ratings! Need more critical data.")
```

---

## V6.3 체크리스트

작업 완료 전 반드시 확인:

- [ ] 각 항목당 10~30개 데이터 수집
- [ ] **부정적 데이터 30% 이상 포함** (매우 중요!)
- [ ] 부정적 사건에 정확히 부정 Rating 부여
- [ ] 논란/실패/비판 키워드로 검색 완료
- [ ] 시민단체 비판 보고서 확인
- [ ] Rating rationale 모두 작성
- [ ] Supabase DB 저장 완료
- [ ] 부정 비율 검증 (30% 이상)

---

**V6.3 핵심 메시지**:
긍정적 데이터만 수집하면 과대평가됩니다.
부정적 데이터를 적극적으로 수집하여 객관적 평가를 해야 합니다.

**목표 점수**:
- 우수한 정치인: 800-850점
- 보통 정치인: 700-800점
- 문제 많은 정치인: 600-700점
