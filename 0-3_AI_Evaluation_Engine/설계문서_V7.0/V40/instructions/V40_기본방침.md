# V40 기본 방침

**작성일**: 2026-02-01
**버전**: V40
**목적**: 웹검색 기반 2개 AI 분담 수집 (Gemini + Naver) + 4개 AI 풀링 평가

---

## 1. V40 핵심 변경사항

### V30 → V40 변경 요약

| 항목 | V30 | V40 |
|------|-----|-----|
| 수집 채널 | Gemini + Perplexity | **Gemini + Naver Search API** |
| 카테고리당 수집 | 50개 (버퍼 60개) | **100개 (버퍼 120개)** |
| 소스 제한 | 뉴스 차단, 플랫폼 지정 등 | **없음 (OFFICIAL/PUBLIC 구분만)** |
| 비용 | Perplexity $53/100명 | **$0 (전부 무료)** |

### V40 핵심 원리
- **글로벌 검색의 최강자 Google + 국내 검색의 최강자 Naver = 쌍두마차**
- **소스 제한 일체 없음**: OFFICIAL이냐 PUBLIC이냐, 이 2가지 구분만 존재
- **네이버 API 무료**: 일 25,000건, 카테고리별 분리 검색 가능

---

## 2. 수집 배분 (카테고리당 100개 + 20% 버퍼)

### 배분표

```
┌────────┬────────────┬────────────┬───────┬───────────┐
│   AI   │  OFFICIAL  │   PUBLIC   │ 합계  │ 버퍼 포함 │
├────────┼────────────┼────────────┼───────┼───────────┤
│ Gemini │ 30개       │ 20개       │ 50개  │ 60개      │
├────────┼────────────┼────────────┼───────┼───────────┤
│ Naver  │ 10개       │ 40개       │ 50개  │ 60개      │
├────────┼────────────┼────────────┼───────┼───────────┤
│ 합계   │ 40개 (40%) │ 60개 (60%) │ 100개 │ 120개     │
└────────┴────────────┴────────────┴───────┴───────────┘
```

### 비율 구조
- **OFFICIAL : PUBLIC = 40% : 60%**
- **Gemini : Naver = 50% : 50% (1:1)**
- **OFFICIAL 내 Gemini:Naver = 3:1** (Gemini가 .go.kr 인덱싱에 강함)
- **PUBLIC 내 Gemini:Naver = 1:2** (Naver가 블로그/카페/뉴스에 강함)
- **모든 개수에 20% 버퍼 적용**

### 검증 후 처리

```
120개 수집 → 검증 (URL 유효성, 중복 등)

결과:
├── 100개 이상 → 그대로 패스 ✅
└── 100개 미만 → 추가 수집 🔄
```

---

## 3. OFFICIAL / PUBLIC 정의

### 제한은 딱 2개뿐

1. **OFFICIAL 수집 시 → OFFICIAL 데이터만 수집**
2. **PUBLIC 수집 시 → PUBLIC 데이터만 수집**

**그 외 어떤 소스에서 가져올지, 어떤 도메인을 쓸지 - 일체 제한 없음.**
**각 AI가 알아서 자유롭게 수집.**

### OFFICIAL = 사실(fact) 기반 공식 기록
- 국회 의정활동, 법안 발의, 국정감사, 정부 발표, 공식 경력, 선거 기록
- 기간: **최근 4년**

### PUBLIC = 여론/평가/의견 기반 비공식 콘텐츠
- 뉴스 보도, 블로그, 유튜브, 위키, 커뮤니티, 카페, 시민단체, 학술자료
- 기간: **최근 2년**

---

## 4. OFFICIAL 소스 (참고용 - 제한 아님)

사실(fact) 기반 공식 기록만. 의견/평가 제외.

**[정부/공공기관]**
- 국회 (assembly.go.kr, likms.assembly.go.kr)
- 정부 대표 (korea.kr)
- 정보공개 (open.go.kr)
- 행안부 (mois.go.kr)
- 권익위 (acrc.go.kr)
- 감사원 (bai.go.kr)
- 선관위 (nec.go.kr)
- 인권위 (humanrights.go.kr)
- 헌법재판소 (ccourt.go.kr)

**[지방자치]**
- 서울 (seoul.go.kr), 경기 (gg.go.kr), 부산 (busan.go.kr)
- 인천, 대구, 대전, 광주, 울산, 세종 등 (.go.kr)

**[정당/선거]**
- 매니페스토 (manifesto.or.kr)
- 국민의힘 (peoplepowerparty.kr)
- 더불어민주당 (theminjoo.kr)

**[공식 활동 유형]**
- 법안 발의, 국정감사 질의, 위원회 활동
- 기자회견, 공식 성명, 정책 발표
- 경력, 학력, 수상, 공적 기록

---

## 5. PUBLIC 소스 (참고용 - 제한 아님)

여론/평가/의견 기반. 비공식 콘텐츠.

**[뉴스/언론]**
- 종합일간지, 방송사, 통신사, 경제지, 인터넷매체
- 지역언론, 해외언론

**[위키]**
- 나무위키 (namu.wiki)
- 위키백과 한글 (ko.wikipedia.org)
- 위키백과 영문 (en.wikipedia.org)

**[동영상]**
- YouTube, 네이버TV, 카카오TV, 아프리카TV, Vimeo

**[블로그]**
- 네이버 블로그 (blog.naver.com)
- 티스토리 (tistory.com)
- 브런치 (brunch.co.kr)
- 미디엄 (medium.com)
- 워드프레스, 다음 블로그, 개인 블로그

**[커뮤니티]**
- 디시인사이드, 클리앙, 더쿠, 펨코, 뽐뿌
- 오늘의유머, 루리웹, 보배드림, SLR클럽, MLB파크, 82cook

**[카페]**
- 네이버 카페 (cafe.naver.com)
- 다음 카페 (cafe.daum.net)

**[지식iN]**
- 네이버 지식iN (kin.naver.com)

**[시민단체/NGO]**
- 참여연대 (peoplepower21.org)
- 경실련 (ccej.or.kr)
- 환경운동연합 (kfem.or.kr)

**[학술/연구]**
- Google Scholar, KISS, DBpia, RISS

**[SNS]**
- Instagram, Facebook, Threads

---

## 6. 센티멘트 배분 (OFFICIAL 10-10-80 / PUBLIC 20-20-60)

### Sentiment 배분 (OFFICIAL 데이터와 PUBLIC 데이터 차등 적용)

```
┌────────────────────┬──────────┬──────────┬──────┬──────┬───────────────────────────┐
│                    │ negative │ positive │ free │ 합계 │ 버퍼 20% (neg/pos/free)   │
├────────────────────┼──────────┼──────────┼──────┼──────┼───────────────────────────┤
│ Gemini OFFICIAL 30 │ 3 (10%)  │ 3 (10%)  │ 24   │ 30   │ 36개 (4/4/28)             │
├────────────────────┼──────────┼──────────┼──────┼──────┼───────────────────────────┤
│ Gemini PUBLIC 20   │ 4 (20%)  │ 4 (20%)  │ 12   │ 20   │ 24개 (5/5/14)             │
├────────────────────┼──────────┼──────────┼──────┼──────┼───────────────────────────┤
│ Naver OFFICIAL 10  │ 1 (10%)  │ 1 (10%)  │ 8    │ 10   │ 12개 (1/1/10)             │
├────────────────────┼──────────┼──────────┼──────┼──────┼───────────────────────────┤
│ Naver PUBLIC 40    │ 8 (20%)  │ 8 (20%)  │ 24   │ 40   │ 48개 (10/10/28)           │
├────────────────────┼──────────┼──────────┼──────┼──────┼───────────────────────────┤
│ OFFICIAL 소계      │ 4 (10%)  │ 4 (10%)  │ 32   │ 40   │ 48개 (5/5/38)             │
├────────────────────┼──────────┼──────────┼──────┼──────┼───────────────────────────┤
│ PUBLIC 소계        │ 12 (20%) │ 12 (20%) │ 36   │ 60   │ 72개 (15/15/42)           │
├────────────────────┼──────────┼──────────┼──────┼──────┼───────────────────────────┤
│ 합계               │ 16 (16%) │ 16 (16%) │ 68   │ 100  │ 120개 (20/20/80)          │
└────────────────────┴──────────┴──────────┴──────┴──────┴───────────────────────────┘
```

**차등 비율 설명**:
- **OFFICIAL (40→48개)**: negative 10% (4→5개) / positive 10% (4→5개) / free 80% (32→38개)
  - 공식 데이터는 사실 기반이므로 자유 검색 비중 높임
- **PUBLIC (60→72개)**: negative 20% (12→15개) / positive 20% (12→15개) / free 60% (36→42개)
  - 여론 데이터는 긍정/부정 균형 있게 수집
- **버퍼 계산 방식 (bottom-up)**: 각 AI별 개수에 20%를 적용한 후 합산
  - 예: Gemini OFF neg 3×1.2≈4, Naver OFF neg 1×1.2≈1 → OFFICIAL neg 합계 = 5
  - top-down(OFFICIAL 40→48에 10% 적용)과 동일 결과: 총합 120개 (20/20/80)

---

## 7. 각 AI 웹검색 도구

### Gemini (50%) - Gemini CLI ✅ 무료

**방식**: Gemini CLI 터미널에서 직접 구글 검색 수행 (API 아님)

```
[수집 프로세스]
1. gemini_collect_helper.py fetch → 필요량 확인
2. Gemini CLI에 프롬프트 붙여넣기 → 구글 검색 실행 → 결과 JSON 저장
3. gemini_collect_helper.py save → DB 저장
```

**비용**: 무료 (Gemini CLI 무료)

**강점**:
- Google 검색 기반 (.go.kr 인덱싱 강함)
- 한국어 콘텐츠 특화
- JavaScript 렌더링 강함
- YouTube 검색 (Google 소유)

---

### Naver Search API (50%) - 네이버 검색 ✅ 무료

```python
import requests
headers = {
    "X-Naver-Client-Id": NAVER_CLIENT_ID,
    "X-Naver-Client-Secret": NAVER_CLIENT_SECRET
}
# 블로그, 뉴스, 카페, 지식iN, 웹문서, 전문정보, 백과사전
response = requests.get(
    f"https://openapi.naver.com/v1/search/{endpoint}.json",
    params={"query": query, "display": 100, "sort": "sim"},
    headers=headers
)
```

**비용**: 완전 무료 (일 25,000건)

**강점**:
- 국내 검색 최강자
- 카테고리별 분리 검색 (블로그, 뉴스, 카페, 지식iN 등)
- JSON 응답에 title, link, description, postdate 포함
- 한 번에 최대 100건 반환

**네이버 검색 API 엔드포인트**:

| # | 엔드포인트 | 용도 |
|---|-----------|------|
| 1 | blog.json | 네이버 블로그 검색 |
| 2 | news.json | 뉴스 검색 |
| 3 | cafearticle.json | 카페 글 검색 |
| 4 | kin.json | 지식iN 검색 |
| 5 | webkr.json | 웹문서 검색 |
| 6 | doc.json | 전문정보 검색 |
| 7 | encyc.json | 백과사전 검색 |

---

## 8. 평가 AI (4개)

### Claude - CLI Direct ⚠️ 평가만 (수집 제외)
**평가 방식**: Claude CLI 세션에서 직접 평가 (API 아님, $0)
**수집 제외 사유**: web_search 도구 검색당 $0.01 추가 과금

### Gemini - CLI ✅ 수집 + 평가
**평가 방식**: Gemini CLI 터미널에서 직접 평가 (API 아님, $0)
**프로세스**: gemini_eval_helper.py fetch → Gemini CLI 프롬프트 → gemini_eval_helper.py save

### ChatGPT - API ⚠️ 평가만 (수집 제외)
**수집 제외 사유**: Bing 검색 별도 과금

### Grok - API ⚠️ 평가만 (수집 제외)
**제외 사유**: X/Twitter 데이터 수집 불안정

---

## 9. 평가 시스템 (4개 AI 풀링)

### 풀링 구조

```
[수집 단계]
Gemini 50개 (50%) + Naver 50개 (50%) = 100개 풀
(중복 제거 안 함, 그대로 합침)

[평가 단계]
4개 AI × 100개 = 400개 평가
- Claude: 100개 평가
- ChatGPT: 100개 평가
- Grok: 100개 평가
- Gemini: 100개 평가
```

### 자연 가중치
- 동일 뉴스를 여러 번 수집 → 풀에 여러 번 포함 → 자연스럽게 가중치 반영
- 별도 가중치 계산 불필요

---

## 10. 비용 분석

### 수집 비용

| AI | 카테고리당 | 정치인당 (10개 카테고리) | 100명 |
|----|------------|--------------------------|-------|
| Gemini | $0 | $0 | **$0** |
| Naver | $0 | $0 | **$0** |
| **합계** | **$0** | **$0** | **$0** |

### 평가 비용

```
✅ Claude: $0 (CLI Direct)
✅ 나머지 AI: 별도 확인 필요

→ 수집 $0 + 평가 $0 = 총 $0/100명 (이상적)
```

---

## 11. 예상 작업량

### 1명 정치인 기준

```
수집:
- Gemini OFFICIAL: 300개 (10개 카테고리 × 30개)
- Gemini PUBLIC: 200개 (10개 카테고리 × 20개)
- Naver OFFICIAL: 100개 (10개 카테고리 × 10개)
- Naver PUBLIC: 400개 (10개 카테고리 × 40개)
- 총 카테고리: 10개 × 100개 = 1,000개
- 버퍼 포함 최대: 1,200개 (120%)

검증 후 최종:
- 1,000개 이상 → 패스 ✅
- 1,000개 미만 → 추가 수집 🔄

평가:
- Claude: 1,000개 (CLI Direct)
- ChatGPT: 1,000개
- Grok: 1,000개
- Gemini: 1,000개
- 총 4,000개 평가

점수 계산:
- 10개 카테고리 점수 산출
- 최종 종합 점수 산출
```

### 100명 기준

```
수집: 100,000개 (10만개)
버퍼 포함 최대: 120,000개 (12만개)
평가: 400,000개 (40만개)
비용: $0 (Gemini + Naver 모두 무료)
```

---

## 12. 실행 명령

### 수집

```bash
# Gemini + Naver 전체 수집
python collect_v40.py --politician_id=ID --politician_name="이름"

# 특정 AI만
python collect_v40.py --politician_id=ID --politician_name="이름" --ai=Gemini
python collect_v40.py --politician_id=ID --politician_name="이름" --ai=Naver

# 병렬 실행 (권장)
python collect_v40.py --politician_id=ID --politician_name="이름" --parallel
```

### 평가 (Claude CLI Direct)

```bash
# 작업 생성
python evaluate_claude_auto.py \
  --politician_id=ID \
  --politician_name="이름" \
  --category=expertise \
  --output=eval_expertise.md

# DB 저장
python evaluate_claude_auto.py \
  --politician_id=ID \
  --politician_name="이름" \
  --category=expertise \
  --import_results=eval_expertise_result.json
```

---

## 13. URL 검증 기술

### URL 검증 방식

```python
# GET stream=True + User-Agent → 90%+ 성공률
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'}
response = requests.get(url, timeout=5, allow_redirects=True, headers=headers, stream=True)
response.close()
return response.status_code < 400
```

### Gemini redirect URL 해결

```python
# Location 헤더에서 실제 URL 추출
response = requests.head(redirect_url, allow_redirects=False)
if response.status_code in [301, 302, 303, 307, 308]:
    real_url = response.headers['Location']
```

---

## 14. 최종 요약

### 배분표

| AI | OFFICIAL | PUBLIC | 합계 | 버퍼 포함 |
|----|----------|--------|------|-----------|
| **Gemini** | 30개 | 20개 | **50개** | **60개** |
| **Naver** | 10개 | 40개 | **50개** | **60개** |
| **합계** | **40개 (40%)** | **60개 (60%)** | **100개** | **120개** |

### 핵심 원칙

1. **제한은 딱 2개**: OFFICIAL은 OFFICIAL만, PUBLIC은 PUBLIC만
2. **그 외 소스 제한 일체 없음**: 각 AI가 자유롭게 수집
3. **센티멘트 배분**: OFFICIAL 10-10-80 / PUBLIC 20-20-60 (통합 16-16-68)
4. **모든 개수에 20% 버퍼**
5. **평가 AI 4개 동일**: Claude, ChatGPT, Gemini, Grok
6. **비용 $0**: Gemini 무료 + Naver 무료

---

**최종 업데이트**: 2026-02-01
**다음 단계**: collect_v40.py 구현
