# V40 검증 후 조정 가이드 (Post-Validation Adjustment Guide)

**작성일**: 2026-02-13
**버전**: V40
**목적**: Phase 3 완료 후 데이터 균형 조정 및 품질 최적화

---

## 1. 개요

### 1.1 왜 조정이 필요한가?

Phase 3 (데이터 검증) 완료 후에도 다음과 같은 불균형이 발생할 수 있습니다:

**발견된 문제**:
- ❌ **카테고리별 불균형**: 일부 카테고리 60개 초과, 일부 50개 미달
- ❌ **채널 불균형**: Gemini/Naver 비율 불균형 (목표 50/50)
- ❌ **버퍼 초과**: 일부 카테고리 120% 버퍼 초과

**예시 (조은희 데이터)**:
```
Gemini: 706개 (목표 500-600)
  ├── publicinterest: 147개 (60 초과 87개!)
  ├── integrity: 14개 (50 미달 36개!)
  └── ...

Naver: 488개 (목표 500-600)
  └── 6개 카테고리 50개 미달 (총 26개 부족)
```

### 1.2 조정 목표

**카테고리별 목표**:
- 최소: 100개 (Gemini 50 + Naver 50)
- 최대: 120개 (Gemini 60 + Naver 60)

**채널별 목표**:
- Gemini: 500-600개 (50%)
- Naver: 500-600개 (50%)

**전체 목표**:
- 최소: 1,000개
- 최대: 1,200개

---

## 2. 조정 프로세스 (Phase 3-3)

### 2.1 프로세스 위치

```
Phase 3-1: 데이터 검증 (validate_v40_fixed.py)
  ├── URL 유효성 검증
  ├── 필드 검증
  ├── 기간 제한 검증
  └── 무효 데이터 삭제
  ↓
Phase 3-2: 풀링 & 중복 제거
  ├── 카테고리별 데이터 통합
  └── URL/제목 기반 중복 제거
  ↓
Phase 3-3: 검증 후 조정 ⭐ 이 단계
  ├── 초과분 삭제 (60개 초과)
  ├── 부족분 재수집 트리거 (50개 미달)
  ├── 균형 검증
  └── 조정 보고서 생성
  ↓
Phase 4: AI 평가 시작
```

### 2.2 조정 단계

**Step 1: 현재 상태 분석**
- 카테고리별, collector별 데이터 개수 확인
- 초과/부족 카테고리 식별

**Step 2: 초과분 삭제 (Overflow Trimming)**
- 60개 초과 카테고리 식별
- 가장 오래된 데이터부터 삭제
- 목표: 정확히 60개까지

**Step 3: 부족분 재수집 트리거 (Shortage Recollection)**
- 50개 미달 카테고리 식별
- 재수집 명령 생성
- 목표: 버퍼까지 (60개)

**Step 4: 균형 검증 (Balance Validation)**
- Gemini 총 500-600개 확인
- Naver 총 500-600개 확인
- 전체 1,000-1,200개 확인

**Step 5: 조정 보고서 생성**
- 삭제된 항목 로그
- 재수집 트리거 로그
- 조정 전후 비교

---

## 3. 실행 방법

### 3.1 기본 실행

**위치**: `V40/scripts/core/`

**시뮬레이션 (DRY RUN, 권장)**:
```bash
cd scripts/core

python adjust_v40_data.py \
  --politician_id=d0a5d6e1 \
  --politician_name="조은희"
```

**실제 실행 (삭제 및 재수집)**:
```bash
python adjust_v40_data.py \
  --politician_id=d0a5d6e1 \
  --politician_name="조은희" \
  --no-dry-run
```

### 3.2 실행 플래그

| 플래그 | 설명 | 기본값 |
|--------|------|--------|
| `--politician_id` | 정치인 ID (필수) | - |
| `--politician_name` | 정치인 이름 (필수) | - |
| `--no-dry-run` | 실제 삭제/재수집 실행 | False (시뮬레이션) |
| `--max_rounds` | 최대 조정 횟수 | 3 |

### 3.3 출력 예시

```
================================================================================
V40 데이터 조정 시작: 조은희
모드: DRY RUN
================================================================================

[Step 1] 현재 상태 분석
--------------------------------------------------------------------------------
expertise            | Gemini     |  97개 ⚠️ 초과 (+37)
expertise            | Naver      |  46개 ⚠️ 부족 (-4)
leadership           | Gemini     |  94개 ⚠️ 초과 (+34)
leadership           | Naver      |  43개 ⚠️ 부족 (-7)
...

[Step 2] 초과분 삭제
--------------------------------------------------------------------------------
publicinterest (Gemini): 147개 → 60개 (삭제 87개)
  [DRY RUN] 87개 삭제 예정
ethics (Gemini): 99개 → 60개 (삭제 39개)
  [DRY RUN] 39개 삭제 예정
...
총 삭제: 231개

[Step 3] 부족분 재수집 트리거
--------------------------------------------------------------------------------
leadership (Naver): 43개 → 60개 (재수집 17개)
vision (Naver): 44개 → 60개 (재수집 16개)
...
총 재수집 명령: 6개

재수집 명령:
  python scripts/workflow/collect_naver_v40_final.py --politician_id=d0a5d6e1 --politician_name="조은희" --category=leadership --target=17
  python scripts/workflow/collect_naver_v40_final.py --politician_id=d0a5d6e1 --politician_name="조은희" --category=vision --target=16
  ...

[Step 4] 채널 균형 검증
--------------------------------------------------------------------------------
Gemini: 475개 (목표 500-600) ⚠️ 부족
Naver:  550개 (목표 500-600) ✅ OK
전체:  1025개 (목표 1,000-1,200) ✅ OK

⚠️ 균형 목표 미달성:
  - Gemini: 475개 (목표 500-600)

================================================================================
조정 보고서
================================================================================

[삭제된 항목]
  publicinterest       | Gemini     |  87개 삭제
  ethics               | Gemini     |  39개 삭제
  expertise            | Gemini     |  37개 삭제
  leadership           | Gemini     |  34개 삭제
  vision               | Gemini     |  34개 삭제

[재수집 트리거]
  leadership           | Naver      |  17개 재수집 필요
  vision               | Naver      |  16개 재수집 필요
  expertise            | Naver      |   4개 재수집 필요
  accountability       | Naver      |   4개 재수집 필요
  communication        | Naver      |   3개 재수집 필요
  transparency         | Naver      |   2개 재수집 필요

[최종 균형 상태]
  Gemini: 475개 (목표 500-600)
  Naver:  550개 (목표 500-600)
  전체:  1025개 (목표 1,000-1,200)

================================================================================
```

---

## 4. 삭제 우선순위 전략

### 4.1 시간 기반 삭제 (기본값, 권장)

**방법**: 가장 오래된 데이터부터 삭제

```sql
SELECT id, created_at
FROM collected_data_v40
WHERE politician_id = '{ID}'
  AND category = '{CATEGORY}'
  AND collector_ai = '{COLLECTOR}'
ORDER BY created_at ASC
LIMIT {EXCESS_COUNT}
```

**장점**:
- ✅ 최신 데이터 유지 (더 관련성 높음)
- ✅ 구현 단순
- ✅ 예측 가능
- ✅ 공정함

**단점**:
- ❌ 품질 무시 (오래됐어도 고품질 데이터 삭제 가능)

### 4.2 품질 기반 삭제 (고급 옵션)

**방법**: 품질 점수가 낮은 데이터부터 삭제

```python
quality_score = (
    (content_length / 1000) * 0.4 +  # 내용 풍부도
    (url_valid ? 1 : 0) * 0.3 +      # URL 유효성
    (has_date ? 1 : 0) * 0.3          # 날짜 정보
)
ORDER BY quality_score ASC
```

**장점**:
- ✅ 저품질 데이터 우선 제거
- ✅ 전체 데이터 품질 향상

**단점**:
- ❌ 구현 복잡
- ❌ 주관적 기준
- ❌ 계산 오버헤드

**권장**: **시간 기반 삭제** (v1.0)
향후 품질 기반 옵션 추가 가능 (v2.0)

---

## 5. 재수집 프로세스

### 5.1 재수집 명령 생성

**Gemini 재수집**:
```bash
python scripts/workflow/collect_gemini_subprocess.py \
  --politician "조은희" \
  --category {CATEGORY} \
  --period 2
```

**Naver 재수집**:
```bash
python scripts/workflow/collect_naver_v40_final.py \
  --politician_id=d0a5d6e1 \
  --politician_name="조은희" \
  --category={CATEGORY} \
  --target={SHORTAGE}
```

### 5.2 재수집 프로세스 (3단계)

**전체 프로세스**:
```
Step 1: 부족 카테고리 식별
  ↓
Step 2: AI별 재수집 실행
  ↓
Step 3: 확인 및 반복 (최대 4회, 포기 규칙 적용)
```

#### Step 1: 부족 카테고리 식별

```bash
# 현재 상태 확인
cd V40/scripts/utils
python check_collection_status.py --politician "조은희"

# 출력 예시:
# expertise: Gemini 47개, Naver 52개 → Gemini 부족 (3개)
# integrity: Gemini 18개, Naver 48개 → Gemini 부족 (32개)
```

#### Step 2: AI별 재수집 실행

**Gemini 재수집** (50개 미만 카테고리):
```bash
cd V40/scripts/workflow
python recollect_gemini_v40.py --politician "조은희"

# 또는 특정 카테고리만:
python recollect_gemini_v40.py --politician "조은희" --category integrity
```

**특징**:
- 1회 실행 = 약 10개 수집
- 60개 달성 = 6-7회 실행 필요
- 5-10분/회 소요
- 자동으로 부족한 카테고리만 재수집

**Naver 재수집** (50개 미만 카테고리):
```bash
cd V40/scripts/workflow
python recollect_naver_v40.py --politician_id d0a5d6e1 --politician_name "조은희"

# 또는 특정 카테고리만:
python recollect_naver_v40.py --politician_id d0a5d6e1 --politician_name "조은희" --category expertise
```

**특징**:
- 1회 실행 = 60개 목표 자동 수집
- 1-2분 소요
- 자동으로 부족한 카테고리만 재수집

#### Step 3: 확인 및 반복

```bash
# 재수집 후 상태 재확인
cd V40/scripts/utils
python check_collection_status.py --politician "조은희"

# 판단:
# - 60개 이상 → ✅ 완료
# - 50-59개 → ✅ 완료 (최소 목표 달성)
# - 50개 미만 → 🔄 Step 2 반복 (최대 4회 라운드)
# - 4회 후: 25-49개=부족허용 / <25개=leverage score 0 (60점)
```

**최대 반복 횟수**: 4회 라운드
**이유**: 무한 루프 방지
**포기 규칙 (4회 후)**: 50+개=정상 / 25-49개=부족허용 / <25개=leverage score 0 (60점)

---

### 5.3 재수집 실행 방법 (옵션)

**Option 1: 수동 실행 (권장, 안전)**

조정 스크립트 출력에서 명령 복사 후 실행:
```bash
# 1. 조정 스크립트 실행 (재수집 명령 출력)
python adjust_v40_data.py --politician_id=d0a5d6e1 --politician_name="조은희" --no-dry-run

# 2. 출력된 재수집 명령 복사 후 실행
python scripts/workflow/collect_naver_v40_final.py --politician_id=d0a5d6e1 --politician_name="조은희" --category=leadership --target=17
python scripts/workflow/collect_naver_v40_final.py --politician_id=d0a5d6e1 --politician_name="조은희" --category=vision --target=16
...
```

**Option 2: 재수집 스크립트 사용 (권장)**

전용 재수집 스크립트 사용:
```bash
# Gemini 재수집
cd V40/scripts/workflow
python recollect_gemini_v40.py --politician "조은희"

# Naver 재수집
python recollect_naver_v40.py --politician_id d0a5d6e1 --politician_name "조은희"
```

**Option 3: 자동 실행 (고급, 향후 구현)**

조정 스크립트가 재수집 명령을 자동 실행:
```bash
python adjust_v40_data.py \
  --politician_id=d0a5d6e1 \
  --politician_name="조은희" \
  --no-dry-run \
  --auto-recollect  # 자동 재수집 (v2.0)
```

### 5.3 재수집 목표

**목표 개수**: 버퍼까지 (60개)

**예시**:
- 현재: 43개
- 부족: 50 - 43 = 7개 (최소 목표 미달)
- **재수집 목표**: 60 - 43 = 17개 (버퍼까지)

**이유**:
- 검증 과정에서 일부 삭제 가능성
- 여유분 확보로 안정성 향상
- 다음 검증 시 최소 목표 보장

---

## 6. 균형 검증 기준

### 6.1 카테고리별 균형

**목표**:
```
각 카테고리별로:
  Gemini: 50-60개
  Naver:  50-60개
  합계:   100-120개
```

**검증 항목**:
- ✅ 모든 카테고리 최소 100개 이상
- ✅ 모든 카테고리 최대 120개 이하
- ✅ Gemini/Naver 각각 50-60개 범위

### 6.2 채널별 균형

**목표**:
```
Gemini:  500-600개 (50%)
Naver:   500-600개 (50%)
전체:   1,000-1,200개
```

**검증 항목**:
- ✅ Gemini 500개 이상, 600개 이하
- ✅ Naver 500개 이상, 600개 이하
- ✅ 전체 1,000개 이상, 1,200개 이하
- ✅ Gemini/Naver 비율 45-55% (10% 오차 허용)

### 6.3 Sentiment 비율 균형

**V40 기본방침 섹션 6 규칙 (OFFICIAL 10-10-80 / PUBLIC 20-20-60):**

**OFFICIAL 데이터 (카테고리별):**
- negative ≥ 10%
- positive ≥ 10%
- free: 나머지

**PUBLIC 데이터 (카테고리별):**
- negative ≥ 20%
- positive ≥ 20%
- free: 나머지

**검증 항목**:
- ✅ 모든 카테고리의 OFFICIAL negative ≥ 10%
- ✅ 모든 카테고리의 OFFICIAL positive ≥ 10%
- ✅ 모든 카테고리의 PUBLIC negative ≥ 20%
- ✅ 모든 카테고리의 PUBLIC positive ≥ 20%

**미달 시 조치:**
- 부족한 sentiment의 데이터를 해당 카테고리에 추가 수집
- Gemini CLI 또는 Naver API로 특정 sentiment 지정 수집

### 6.4 균형 미달 시 조치

**Gemini 부족 시**:
```bash
# 부족한 카테고리만 재수집
python scripts/workflow/collect_gemini_subprocess.py \
  --politician "조은희" \
  --category {CATEGORY}
```

**Naver 부족 시**:
```bash
# 부족한 카테고리만 재수집
python scripts/workflow/collect_naver_v40_final.py \
  --politician_id=d0a5d6e1 \
  --politician_name="조은희" \
  --category={CATEGORY} \
  --target={SHORTAGE}
```

**전체 초과 시 (1,200개 초과)**:
```bash
# 가장 많은 카테고리부터 삭제
# 조정 스크립트가 자동 처리
```

---

## 7. 무한 루프 방지

### 7.1 최대 조정 횟수

**기본값**: 3회

```bash
python adjust_v40_data.py \
  --politician_id=d0a5d6e1 \
  --politician_name="조은희" \
  --max_rounds=4  # 최대 4회 조정 (포기 규칙 적용)
```

### 7.2 조정 루프

**프로세스**:
```
라운드 1:
  ├── 상태 분석
  ├── 초과분 삭제
  ├── 부족분 재수집
  └── 균형 확인 → 미달 시 라운드 2

라운드 2:
  └── (반복)

라운드 3:
  └── (반복)

라운드 3 완료 후에도 미달:
  └── ⚠️ 수동 개입 필요
```

### 7.3 수동 개입 케이스

**다음 경우 수동 확인 필요**:

1. **4회 조정 후에도 불균형** → 포기 규칙 자동 적용
   - 25-49개: 부족 허용, 보유 데이터로 평가 진행
   - <25개: 포기, leverage score 0 처리 (60점)
   - 원인: 해당 정치인의 실제 데이터 부족 (지방의원 등)

2. **재수집 반복 실패**
   - 원인: 네트워크 오류, API 오류
   - 조치: 에러 로그 확인, 수동 재수집

3. **특정 카테고리 지속 부족**
   - 원인: 해당 정치인의 실제 데이터 부족
   - 조치: 목표 하향 조정 또는 다른 출처 탐색

---

## 8. 조정 보고서

### 8.1 보고서 내용

**포함 정보**:
1. 삭제된 항목 (카테고리별, AI별, 개수)
2. 재수집 트리거 (카테고리별, AI별, 부족분)
3. 최종 균형 상태 (Gemini/Naver/전체)
4. 조정 전후 비교
5. 경고 및 권장사항

### 8.2 보고서 저장 위치

**자동 생성**: `V40/reports/adjustments/`

**파일명**: `{정치인명}_adjustment_{YYYYMMDD_HHMMSS}.txt`

**예시**: `조은희_adjustment_20260213_143022.txt`

### 8.3 보고서 예시

```
================================================================================
V40 데이터 조정 보고서
================================================================================
정치인: 조은희 (d0a5d6e1)
조정 일시: 2026-02-13 14:30:22
모드: 실제 실행

[조정 전 상태]
--------------------------------------------------------------------------------
Gemini: 706개
Naver:  488개
전체:  1,194개

카테고리별 (Gemini):
  publicinterest: 147개 (초과 87개)
  ethics:          99개 (초과 39개)
  expertise:       97개 (초과 37개)
  leadership:      94개 (초과 34개)
  vision:          94개 (초과 34개)
  integrity:       14개 (부족 36개)
  accountability:  36개 (부족 14개)
  transparency:    17개 (부족 33개)
  communication:   51개 (OK)
  responsiveness:  57개 (OK)

카테고리별 (Naver):
  leadership:      43개 (부족 7개)
  vision:          44개 (부족 6개)
  expertise:       46개 (부족 4개)
  accountability:  46개 (부족 4개)
  communication:   47개 (부족 3개)
  transparency:    48개 (부족 2개)
  (나머지 OK)

[조정 작업]
--------------------------------------------------------------------------------
삭제된 항목:
  publicinterest (Gemini): 87개 삭제
  ethics (Gemini):         39개 삭제
  expertise (Gemini):      37개 삭제
  leadership (Gemini):     34개 삭제
  vision (Gemini):         34개 삭제

총 삭제: 231개

재수집 트리거:
  leadership (Naver):     17개 재수집 필요
  vision (Naver):         16개 재수집 필요
  expertise (Naver):       4개 재수집 필요
  accountability (Naver):  4개 재수집 필요
  communication (Naver):   3개 재수집 필요
  transparency (Naver):    2개 재수집 필요

총 재수집: 46개

[조정 후 상태]
--------------------------------------------------------------------------------
Gemini: 475개 (목표 500-600) ⚠️ 부족 25개
Naver:  534개 (목표 500-600) ✅ OK
전체:  1,009개 (목표 1,000-1,200) ✅ OK

[권장사항]
--------------------------------------------------------------------------------
⚠️ Gemini가 목표 최소값(500) 미달입니다.
   다음 카테고리에서 추가 수집 권장:
   - integrity:      25개 재수집 (14 → 50)
   - transparency:   33개 재수집 (17 → 50)
   - accountability: 14개 재수집 (36 → 50)

✅ 재수집 후 균형이 달성될 것으로 예상됩니다.

================================================================================
```

---

## 9. 에러 처리 및 복구

### 9.1 일반적인 에러

**Error 1: Supabase 연결 실패**
```
Error: supabase_url is required
```
**해결**: `.env` 파일 확인, `SUPABASE_URL` 및 `SUPABASE_SERVICE_ROLE_KEY` 설정

**Error 2: 삭제 실패**
```
Error: Failed to delete item {ID}
```
**해결**: 로그 확인, DB 접근 권한 확인, 수동 삭제

**Error 3: 재수집 실패**
```
Error: Collection failed for category {CATEGORY}
```
**해결**: 수집 스크립트 에러 로그 확인, API 한도 확인

### 9.2 백업 및 복구

**조정 전 백업 (권장)**:
```bash
# PostgreSQL 백업
pg_dump -U postgres -d politician_finder -t collected_data_v40 \
  --data-only \
  --inserts \
  > backup_before_adjustment_$(date +%Y%m%d_%H%M%S).sql
```

**복구 방법**:
```bash
# 백업에서 복원
psql -U postgres -d politician_finder < backup_before_adjustment_*.sql
```

### 9.3 롤백 계획

**자동 롤백**: 현재 미지원 (v1.0)

**수동 롤백**:
1. 조정 보고서에서 삭제된 항목 ID 확인
2. 백업 파일에서 해당 항목 복원
3. 재수집된 항목 삭제 (필요 시)

---

## 10. 체크리스트

### 10.1 조정 전 체크리스트

- [ ] Phase 3-1 (데이터 검증) 완료
- [ ] Phase 3-2 (풀링 & 중복 제거) 완료
- [ ] 현재 데이터 상태 확인 (`check_v40_data.py`)
- [ ] 백업 생성 (선택, 권장)
- [ ] DRY RUN 실행으로 조정 내용 미리보기

### 10.2 조정 실행 체크리스트

- [ ] `--no-dry-run` 플래그로 실제 실행
- [ ] 조정 보고서 확인
- [ ] 삭제된 항목 개수 확인
- [ ] 재수집 명령 확인 및 저장

### 10.3 재수집 실행 체크리스트

- [ ] 재수집 명령 복사
- [ ] 재수집 순차 실행
- [ ] 재수집 결과 확인
- [ ] 최종 데이터 개수 확인 (`check_v40_data.py`)

### 10.4 조정 후 체크리스트

- [ ] 모든 카테고리 50-60개 범위 확인
- [ ] Gemini 500-600개 확인
- [ ] Naver 500-600개 확인
- [ ] 전체 1,000-1,200개 확인
- [ ] Phase 4로 진행 준비

---

## 11. FAQ

**Q1: 조정은 필수인가요?**
A: 검증 후 불균형이 있다면 필수입니다. Phase 4 (AI 평가) 전에 균형을 맞춰야 공정한 평가가 가능합니다.

**Q2: DRY RUN으로 무엇을 확인하나요?**
A: 실제 삭제 없이 삭제될 항목 개수, 재수집 명령, 조정 후 예상 상태를 미리 확인합니다.

**Q3: 삭제된 데이터는 복구할 수 있나요?**
A: 백업이 있다면 가능합니다. 백업 없이는 복구 불가능하므로, 조정 전 백업을 권장합니다.

**Q4: 재수집은 자동으로 되나요?**
A: v1.0에서는 수동 실행입니다. 조정 스크립트가 출력한 명령을 복사하여 실행하세요.

**Q5: 4회 조정 후에도 불균형이면?**
A: 포기 규칙이 자동 적용됩니다. 25-49개는 부족 허용(보유 데이터로 평가), 25개 미만은 포기(leverage score 0 = 60점). 수동 개입이 불필요합니다.

**Q6: Gemini와 Naver 중 어느 것을 우선 조정하나요?**
A: 둘 다 동시에 조정합니다. 초과분 삭제와 부족분 재수집을 병렬로 수행합니다.

**Q7: 조정 시간은 얼마나 걸리나요?**
A: DRY RUN: 1-2분, 실제 삭제: 3-5분, 재수집: 10-30분 (카테고리 수에 따라 다름)

**Q8: 버퍼 20%는 어떻게 적용되나요?**
A: 최소 목표 100개, 버퍼 포함 최대 120개입니다. 재수집 시 60개까지 목표로 합니다.

---

## 12. 실전 교훈 (Lessons Learned)

### 12.1 핵심 교훈: Phase 3-3를 아예 방지하라!

**⭐ 가장 중요한 교훈:**
> **처음부터 버퍼 목표(60개/AI/카테고리)로 수집하면 Phase 3-3가 거의 필요 없습니다!**

**실제 사례 (조은희):**
```
❌ 잘못된 접근 (실제 발생):
Phase 2: 최소 목표(50개)로 수집
→ Phase 3: 검증 후 일부 카테고리 50개 미달 (Gemini integrity: 18개)
→ Phase 3-3: 8라운드 재수집 (총 2시간 35분 소요)
→ 결과: 18 → 51개 (33개 추가 수집)

✅ 올바른 접근 (권장):
Phase 2: 버퍼 목표(60개)로 수집
→ Phase 3: 검증 후 대부분 50-60개 유지
→ Phase 3-3: 1-2라운드만 필요 또는 스킵 (15분 이내)
→ 시간 절약: 2시간 20분
```

### 12.2 시간 소요 분석

**조은희 Phase 3-3 실제 소요 시간:**

| 단계 | 소요 시간 | 비고 |
|------|----------|------|
| 경로 오류 수정 | 30분 | 스크립트 경로 문제 (초기 1회만) |
| Naver 재수집 | 10분 | 1라운드로 완료 (6개 카테고리) |
| Gemini 재수집 | 100분 | 8라운드 (integrity 집중) |
| 검증 & 모니터링 | 15분 | 상태 확인 및 라운드 간 검증 |
| **총계** | **155분 (2.6시간)** | |

**시간 소요 주요 원인:**
1. Gemini CLI 느린 속도 (5-10분/라운드)
2. Integrity 카테고리 낮은 수집률 (평균 4개/라운드)
3. 일부 라운드 timeout 발생
4. 순차 실행 구조 (병렬 불가)

### 12.3 카테고리별 수집 난이도

**실전 데이터 (조은희 기준):**

| 카테고리 | 난이도 | 라운드당 수집량 | 총 라운드 |
|---------|--------|----------------|----------|
| expertise | 쉬움 | 10-12개 | 5라운드 |
| leadership | 쉬움 | 10-15개 | 4라운드 |
| vision | 보통 | 8-10개 | 5라운드 |
| **integrity** | **어려움** | **2-4개** | **8라운드** |
| ethics | 보통 | 6-8개 | 6라운드 |
| accountability | 보통 | 6-10개 | 5라운드 |
| transparency | 어려움 | 4-6개 | 7라운드 |
| communication | 쉬움 | 10-12개 | 4라운드 |
| responsiveness | 보통 | 8-10개 | 5라운드 |
| publicinterest | 쉬움 | 12-15개 | 4라운드 |

**교훈:**
- **청렴성(integrity)은 가장 어려운 카테고리**
- PUBLIC 2년 내 청렴성 데이터가 부족한 정치인이 많음
- 깨끗한 정치인일수록 청렴성 데이터 수집이 어려움 (역설적!)

### 12.4 다음 Claude Code를 위한 Best Practices

**✅ DO (반드시 따를 것):**
1. **Phase 2부터 버퍼 목표(60개) 수집**: 재수집 거의 불필요
2. **50-50 분배 엄수**: Gemini 60 + Naver 60 = 120개 (비율 유지)
3. **청렴성은 여유있게**: 어려운 카테고리는 초기 수집 시 집중
4. **DRY RUN 먼저**: 삭제/재수집 전 반드시 시뮬레이션
5. **recollect 스크립트 활용**: 수동 재수집보다 자동화 스크립트 사용

**❌ DON'T (하지 말 것):**
1. **최소 목표(50개)만 수집**: Phase 3-3 재수집 2-3시간 소요
2. **50-50 비율 무시**: Naver 우선 등 규칙 위반 (예: Naver 55 + Gemini 5)
3. **버퍼 초과 목표**: 65개 등 버퍼(60) 초과 수집
4. **카테고리 차별**: 어려운/쉬운 구분하여 다른 목표 설정
5. **새 파일 생성**: 기존 문서 업데이트, 혼란 방지

### 12.5 규칙 준수 체크리스트

**Phase 2 수집 시 확인:**
- [ ] Gemini 60개/카테고리 목표
- [ ] Naver 60개/카테고리 목표
- [ ] 50-50 분배 유지 (Gemini:Naver = 1:1)
- [ ] OFFICIAL:PUBLIC = 40:60 비율 유지
- [ ] 모든 카테고리 동일 목표

**Phase 3-3 조정 시 확인:**
- [ ] 최소 목표: 50개/AI/카테고리
- [ ] 버퍼 목표: 60개/AI/카테고리 (최대)
- [ ] 전체 범위: 1,000-1,200개
- [ ] DRY RUN으로 먼저 시뮬레이션
- [ ] 재수집은 부족분만 (100개까지만)

### 12.6 향후 개선 가능성

**기술적 개선:**
1. **병렬 수집**: 정치인별 동시 수집 (10명 → 1명 시간)
2. **자동 Timeout 재시도**: 실패 시 즉시 재시도
3. **카테고리별 키워드 최적화**: 청렴성 등 어려운 카테고리 전용 키워드
4. **실시간 균형 모니터링**: 수집 중 부족 카테고리 즉시 보충

**프로세스 개선:**
1. **Phase 2-Phase 3 통합**: 수집 중 실시간 검증
2. **동적 목표 조정**: 카테고리 난이도에 따라 목표 자동 조정
3. **One-Shot 자동화**: 전체 프로세스 단일 명령 실행

**⚠️ 단, 모든 개선은 V40 규칙 준수 전제 하에!**

---

## 13. 참조 문서

- **V40_전체_프로세스_가이드.md**: 전체 프로세스 설명
- **V40_기본방침.md**: V40 핵심 규칙 및 목표
- **CLAUDE.md**: 새 세션 시작 시 필수 지침
- **validate_v40_fixed.py**: 검증 스크립트 (Phase 3-1)
- **adjust_v40_data.py**: 조정 스크립트 (Phase 3-3, 본 가이드 대상)

---

**최종 업데이트**: 2026-02-13
**버전**: 1.0
**작성자**: V40 System
