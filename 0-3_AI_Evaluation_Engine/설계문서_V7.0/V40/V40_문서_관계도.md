# V40 문서 관계도

**생성일**: 2026-02-10
**최종 수정**: 2026-02-22 (실행타입 ABC 비교분석 문서 추가)
**목적**: V40 시스템의 모든 문서와 스크립트 간 연결 관계를 시각화하여 다른 Claude Code 세션이 쉽게 참조할 수 있도록 함

---

## 📊 전체 구조 (계층적 관계도)

```mermaid
graph TD
    %% 최상위 허브
    README[🌟 README.md<br/>V40 시스템 허브]

    %% 1계층: 핵심 방침 문서
    README --> BASIC[📋 V40_기본방침.md<br/>핵심 규칙]
    README --> PROCESS[📋 V40_전체_프로세스_가이드.md<br/>Phase 0-5 프로세스]
    README --> ORCH[📋 V40_오케스트레이션_가이드.md<br/>자동화 가이드]
    README --> ADJUST_GUIDE[📋 V40_검증후조정_가이드.md<br/>Phase 2-2 상세]
    README --> ARCH[📋 V40_아키텍처_철학.md<br/>설계 원칙]
    README --> TERM[📋 TERMINOLOGY.md<br/>용어 정의]
    README --> COST[📋 V40_AI_평가_방식_및_비용_종합_분석.md<br/>CLI vs API 비용 분석]
    README --> TYPE_ABC[📋 V40_실행타입_ABC_비교분석.md<br/>Type A/B/C 비교]
    COST --> TYPE_ABC

    %% 2계층: 정치인 정보 (11개 파일)
    README --> POL_DIR[📁 instructions/1_politicians/<br/>11개 파일]
    POL_DIR --> POL_TEMP[📄 _TEMPLATE.md]
    POL_DIR --> POL_DONE[📄 정원오/박주민/조은희<br/>오세훈/오준환 ✅ 평가완료]
    POL_DIR --> POL_WAIT[📄 김진태/명재성/우상호<br/>이동환/이재준 ⏳ 대기]

    %% 3계층: 수집 (Collection)
    README --> COLLECT_DIR[📁 instructions/2_collect/]
    COLLECT_DIR --> GEMINI_GUIDE[📄 GEMINI_CLI_수집_가이드.md]
    COLLECT_DIR --> NAVER_GUIDE[📄 NAVER_API_수집_가이드.md]
    COLLECT_DIR --> COLLECT_CATS[📄 cat01~10.md<br/>10개 카테고리]
    COLLECT_DIR --> PROMPTS[📁 prompts/]
    PROMPTS --> PROMPT_G_OFF[📄 gemini_official.md]
    PROMPTS --> PROMPT_G_PUB[📄 gemini_public.md]
    PROMPTS --> PROMPT_N_OFF[📄 naver_official.md]
    PROMPTS --> PROMPT_N_PUB[📄 naver_public.md]

    %% 4계층: 수집 스크립트
    COLLECT_DIR --> COLLECT_NAVER[⚙️ workflow/collect_naver_v40_final.py<br/>Naver API 수집]
    COLLECT_DIR --> COLLECT_GEM[⚙️ workflow/collect_gemini_subprocess.py<br/>Gemini 단일]
    COLLECT_DIR --> COLLECT_GEM_PAR[⚙️ workflow/collect_gemini_subprocess_parallel.py<br/>Gemini 병렬]

    %% 5계층: 검증 + 조정
    README --> VALIDATE[⚙️ core/validate_v40_fixed.py<br/>Phase 2: 수집 검증]
    PROCESS --> VALIDATE
    VALIDATE --> ADJUST[⚙️ core/adjust_v40_data.py<br/>Phase 2-2: 균형 조정]
    ADJUST_GUIDE --> ADJUST

    %% 6계층: 평가 (Evaluation)
    README --> EVAL_DIR[📁 instructions/3_evaluate/]
    EVAL_DIR --> EVAL_UNIFIED[📄 AI_평가_통합가이드_V40.md<br/>4개 AI 평가 통합 가이드]
    EVAL_DIR --> EVAL_CATS[📄 cat01~10.md<br/>10개 카테고리]

    %% 7계층: 평가 스크립트 (4개 AI)
    EVAL_DIR --> EVAL_GEM[⚙️ workflow/evaluate_gemini_subprocess.py<br/>Gemini CLI Subprocess]
    EVAL_DIR --> CLAUDE_HELPER[⚙️ helpers/claude_eval_helper.py<br/>Claude Haiku 4.5]
    EVAL_DIR --> CODEX_HELPER[⚙️ helpers/codex_eval_helper.py<br/>ChatGPT gpt-5.1-codex-mini]
    EVAL_DIR --> GROK_HELPER[⚙️ helpers/grok_eval_helper.py<br/>Grok 3 xAI API]
    EVAL_DIR --> COMMON_SAVER[⚙️ helpers/common_eval_saver.py<br/>4개 AI 공통 저장]

    %% 8계층: 점수 계산
    README --> CALC[⚙️ core/calculate_v40_scores.py<br/>Phase 4: 점수 계산]
    ADJUST --> CALC

    %% 9계층: 보고서
    README --> REPORT_DIR[📁 보고서/]
    REPORT_DIR --> REPORT_GUIDE[📄 V40_보고서_작성_가이드.md]
    REPORT_DIR --> REPORT_GEN[⚙️ core/generate_report_v40.py<br/>Phase 5: 보고서 생성]
    CALC --> REPORT_GEN

    %% 10계층: 수집 → 검증 플로우
    COLLECT_NAVER --> VALIDATE
    COLLECT_GEM_PAR --> VALIDATE

    %% 11계층: 상태 추적 & 유틸리티
    README --> TRACKER[⚙️ helpers/phase_tracker.py<br/>Phase 상태 추적]
    README --> UTILS_DIR[📁 scripts/utils/]
    UTILS_DIR --> CHECK_COLLECT[⚙️ check_collection_status.py]
    UTILS_DIR --> CHECK_EVAL[⚙️ check_evaluation_status.py]

    %% 12계층: n8n 자동화
    README --> N8N_DIR[📁 n8n/]
    N8N_DIR --> N8N_WORKFLOW[⚙️ v40_workflow.json<br/>n8n 워크플로우]
    N8N_DIR --> N8N_SHELL[⚙️ run_phase1_collection.sh]

    %% 스타일
    classDef hub fill:#ff6b6b,stroke:#c92a2a,stroke-width:3px,color:#fff
    classDef doc fill:#4dabf7,stroke:#1971c2,stroke-width:2px,color:#fff
    classDef script fill:#51cf66,stroke:#2f9e44,stroke-width:2px,color:#000
    classDef folder fill:#ffd43b,stroke:#f08c00,stroke-width:2px,color:#000

    class README hub
    class BASIC,PROCESS,ORCH,ADJUST_GUIDE,ARCH,TERM,COST,TYPE_ABC,GEMINI_GUIDE,NAVER_GUIDE,EVAL_UNIFIED,REPORT_GUIDE,POL_TEMP,POL_DONE,POL_WAIT doc
    class COLLECT_NAVER,COLLECT_GEM,COLLECT_GEM_PAR,VALIDATE,ADJUST,EVAL_GEM,CALC,REPORT_GEN,CLAUDE_HELPER,CODEX_HELPER,GROK_HELPER,COMMON_SAVER,TRACKER,CHECK_COLLECT,CHECK_EVAL,N8N_WORKFLOW,N8N_SHELL script
    class POL_DIR,COLLECT_DIR,PROMPTS,EVAL_DIR,REPORT_DIR,UTILS_DIR,N8N_DIR folder
```

---

## 🔄 프로세스 플로우 (실행 순서 — Phase 0~5)

```mermaid
flowchart TD
    START([시작]) --> README_READ[📖 README.md 읽기]
    README_READ --> BASIC_READ[📖 V40_기본방침.md 읽기]
    BASIC_READ --> POL_INFO[📖 정치인 정보 확인<br/>instructions/1_politicians/]

    POL_INFO --> PHASE0[Phase 0: 정치인 정보 DB 등록<br/>12개 필드 필수]

    PHASE0 --> PHASE1[Phase 1: 데이터 수집<br/>목표 1,200개]
    PHASE1 --> COLLECT_NAVER[Naver 수집 50%<br/>collect_naver_v40_final.py<br/>60개/카테고리]
    PHASE1 --> COLLECT_GEMINI[Gemini 수집 50%<br/>collect_gemini_subprocess.py<br/>60개/카테고리]

    COLLECT_NAVER --> GATE1{Phase Gate 1<br/>총 1,000개 이상?}
    COLLECT_GEMINI --> GATE1

    GATE1 -->|Yes| PHASE2[Phase 2: 데이터 검증<br/>validate_v40_fixed.py --no-dry-run]
    GATE1 -->|No| RECOLLECT1[재수집<br/>부족 채널 보충]
    RECOLLECT1 --> GATE1

    PHASE2 --> PHASE22[Phase 2-2: 균형 조정<br/>adjust_v40_data.py]
    PHASE22 --> GATE2{Phase Gate 2<br/>50-60개/AI/카테고리?}

    GATE2 -->|Yes| PHASE3[Phase 3: AI 평가<br/>4개 AI 병렬]
    GATE2 -->|부족| RECOLLECT2[재수집<br/>최대 4라운드]
    RECOLLECT2 --> GATE2
    GATE2 -.->|4라운드 후 포기| GIVEUP[포기 규칙 적용<br/>25-49: 부족허용<br/>25미만: score 0]
    GIVEUP --> PHASE3

    PHASE3 --> EVAL_CLAUDE[Claude 평가<br/>claude_eval_helper.py]
    PHASE3 --> EVAL_CHATGPT[ChatGPT 평가<br/>codex_eval_helper.py]
    PHASE3 --> EVAL_GEMINI[Gemini 평가<br/>evaluate_gemini_subprocess.py]
    PHASE3 --> EVAL_GROK[Grok 평가<br/>grok_eval_helper.py]

    EVAL_CLAUDE --> GATE3{Phase Gate 3<br/>평가 2,000개 이상?}
    EVAL_CHATGPT --> GATE3
    EVAL_GEMINI --> GATE3
    EVAL_GROK --> GATE3

    GATE3 -->|Yes| PHASE4[Phase 4: 점수 계산<br/>calculate_v40_scores.py]
    GATE3 -->|No| REEVAL[추가 평가<br/>Helper 재실행]
    REEVAL --> GATE3

    PHASE4 --> PHASE5[Phase 5: 보고서 생성<br/>generate_report_v40.py]
    PHASE5 --> END([완료])

    %% 스타일
    classDef phaseClass fill:#845ef7,stroke:#5f3dc4,stroke-width:2px,color:#fff
    classDef scriptClass fill:#51cf66,stroke:#2f9e44,stroke-width:2px,color:#000
    classDef gateClass fill:#ffd43b,stroke:#f08c00,stroke-width:3px,color:#000
    classDef warnClass fill:#ff8787,stroke:#c92a2a,stroke-width:2px,color:#000

    class PHASE0,PHASE1,PHASE2,PHASE22,PHASE3,PHASE4,PHASE5 phaseClass
    class COLLECT_NAVER,COLLECT_GEMINI,EVAL_CLAUDE,EVAL_CHATGPT,EVAL_GEMINI,EVAL_GROK scriptClass
    class GATE1,GATE2,GATE3 gateClass
    class GIVEUP,RECOLLECT1,RECOLLECT2,REEVAL warnClass
```

---

## 📂 디렉토리별 문서 분류

### 1. 핵심 문서 (Root)
| 파일명 | 역할 | 참조 대상 |
|--------|------|-----------|
| **README.md** | 🌟 전체 시스템 허브 | 모든 문서의 시작점 |
| TERMINOLOGY.md | 용어 정의 | 수집/평가 용어 통일 |
| V40_AI_평가_방식_및_비용_종합_분석.md | CLI vs API 비용 분석 | Type A 비용 상세 |
| **V40_실행타입_ABC_비교분석.md** | Type A/B/C 실행 방식 비교 | 비용/속도/이식성 의사결정 |

### 2. 기본 방침 (instructions/)
| 파일명 | 역할 | 참조 대상 |
|--------|------|-----------|
| V40_기본방침.md | 핵심 규칙 정의 | README → 이 문서 → 상세 가이드 |
| V40_전체_프로세스_가이드.md | Phase 0-5 프로세스 상세 | 실행 시 참조 |
| V40_오케스트레이션_가이드.md | 자동화 가이드 | workflow 스크립트 작성 시 |
| V40_검증후조정_가이드.md | Phase 2-2 균형 조정 상세 | adjust_v40_data.py 사용 시 |
| V40_아키텍처_철학.md | V40 설계 원칙 | 시스템 이해 시 |

### 3. 정치인 정보 (instructions/1_politicians/) — 11개 파일
| 파일명 | 역할 | 참조 대상 |
|--------|------|-----------|
| _TEMPLATE.md | 새 정치인 추가 템플릿 | 신규 정치인 작성 시 복사 |
| 정원오/박주민/조은희/오세훈/오준환.md | ✅ 평가 완료 정치인 | 수집/평가 시 자동 참조 |
| 김진태/명재성/우상호/이동환/이재준.md | ⏳ 대기 중 정치인 | 수집/평가 시 자동 참조 |

### 4. 수집 (instructions/2_collect/)
| 파일명 | 역할 | 참조 대상 |
|--------|------|-----------|
| GEMINI_CLI_수집_가이드.md | Gemini 수동 수집 절차 | collect_gemini_subprocess.py |
| NAVER_API_수집_가이드.md | Naver API 수집 절차 | collect_naver_v40_final.py |
| cat01~10.md | 10개 카테고리 정의 | 수집 시 범위 참조 |
| prompts/gemini_official.md | Gemini OFFICIAL 프롬프트 | Gemini 수집 |
| prompts/gemini_public.md | Gemini PUBLIC 프롬프트 | Gemini 수집 |
| prompts/naver_official.md | Naver OFFICIAL 프롬프트 | Naver 수집 |
| prompts/naver_public.md | Naver PUBLIC 프롬프트 | Naver 수집 |

### 5. 평가 (instructions/3_evaluate/)
| 파일명 | 역할 | 참조 대상 |
|--------|------|-----------|
| AI_평가_통합가이드_V40.md | 4개 AI 평가 통합 가이드 | 모든 eval helper 스크립트 |
| cat01~10.md | 10개 카테고리 평가 기준 | 평가 시 등급 기준 |

### 6. 보고서 (보고서/)
| 파일명 | 역할 | 참조 대상 |
|--------|------|-----------|
| V40_보고서_작성_가이드.md | 보고서 작성 규칙 | generate_report_v40.py |
| HTML_개선_적용_가이드.md | HTML 출력 가이드 | HTML 변환 시 |
| PDF생성_사용법.md | PDF 변환 가이드 | PDF 생성 시 |

### 7. 스크립트 (scripts/)
| 경로 | 파일명 | 역할 |
|------|--------|------|
| workflow/ | collect_naver_v40_final.py | Naver API 수집 |
| workflow/ | collect_gemini_subprocess.py | Gemini 단일 수집 |
| workflow/ | collect_gemini_subprocess_parallel.py | Gemini 병렬 수집 |
| workflow/ | evaluate_gemini_subprocess.py | Gemini CLI Subprocess 평가 |
| workflow/ | recollect_gemini_v40.py | Gemini 재수집 (Phase 2-2) |
| workflow/ | recollect_naver_v40.py | Naver 재수집 (Phase 2-2) |
| core/ | validate_v40_fixed.py | Phase 2: 수집 검증 |
| core/ | adjust_v40_data.py | Phase 2-2: 균형 조정 |
| core/ | calculate_v40_scores.py | Phase 4: 점수 계산 |
| core/ | generate_report_v40.py | Phase 5: 보고서 생성 |
| helpers/ | claude_eval_helper.py | Claude Haiku 4.5 평가 (CLI Direct) |
| helpers/ | codex_eval_helper.py | ChatGPT gpt-5.1-codex-mini 평가 (Codex CLI stdin) |
| helpers/ | grok_eval_helper.py | Grok 3 평가 (xAI Agent Tools API, curl) |
| helpers/ | common_eval_saver.py | 4개 AI 공통 저장 함수 |
| helpers/ | phase_tracker.py | Phase 상태 추적 (.phase_status/) |
| helpers/ | duplicate_check_utils.py | 중복 체크 유틸리티 |
| utils/ | check_collection_status.py | 수집 상태 확인 |
| utils/ | check_evaluation_status.py | 평가 상태 확인 |
| utils/ | check_v40_results.py | 전체 결과 확인 |

### 8. n8n 자동화 (n8n/)
| 파일명 | 역할 | 참조 대상 |
|--------|------|-----------|
| v40_workflow.json | n8n 워크플로우 정의 | n8n 자동화 실행 |
| run_phase1_collection.sh | Phase 1 수집 쉘 스크립트 | n8n executeCommand |
| n8n_start.sh | n8n 서버 시작 | V40_DIR 환경변수 설정 |

---

## 🔗 참조 관계 요약

### 새 세션 시작 시 읽어야 할 순서

1. **README.md** (이 문서부터 시작) ← 🌟 **시작점**
2. **V40_문서_관계도.md** (문서 간 관계 파악)
3. **V40_기본방침.md** (핵심 규칙 파악)
4. **V40_전체_프로세스_가이드.md** (상세 프로세스)
5. **V40_오케스트레이션_가이드.md** (자동화 가이드)

### 작업별 참조 문서

| 작업 | 읽어야 할 문서 |
|------|---------------|
| **정치인 등록** | V40_오케스트레이션_가이드.md, _TEMPLATE.md |
| **수집** | GEMINI_CLI_수집_가이드.md, NAVER_API_수집_가이드.md, cat01~10.md, prompts/ |
| **검증** | V40_전체_프로세스_가이드.md (Phase 2 섹션) |
| **균형 조정** | V40_검증후조정_가이드.md |
| **평가** | AI_평가_통합가이드_V40.md, cat01~10.md |
| **점수 계산** | V40_기본방침.md (점수 공식) |
| **보고서 생성** | V40_보고서_작성_가이드.md |
| **전체 자동화** | V40_오케스트레이션_가이드.md, n8n/v40_workflow.json |
| **실행 타입 선택** | V40_실행타입_ABC_비교분석.md, V40_AI_평가_방식_및_비용_종합_분석.md |

---

## 📌 핵심 원칙

**⚠️⚠️⚠️ 새 세션 시작 시 반드시 읽어야 할 문서 (필수!) ⚠️⚠️⚠️**

**모든 Claude Code 세션은 작업 시작 전에 다음 5개 문서를 반드시 순서대로 읽어야 합니다:**

1. **README.md** (V40/) ⭐ 필독!
2. **V40_문서_관계도.md** (V40/) ⭐ 필독!
3. **V40_기본방침.md** (instructions/) ⭐ 필독!
4. **V40_전체_프로세스_가이드.md** (instructions/) ⭐ 필독!
5. **V40_오케스트레이션_가이드.md** (instructions/) ⭐ 필독!

**이 5개 문서를 읽지 않고 작업하면 오류가 발생합니다!**

---

**이 관계도를 사용하는 방법:**

1. **새 세션 시작**: CLAUDE.md 읽기 → 위 5개 필수 문서 순서대로 읽기
2. **특정 작업 수행**: 작업별 참조 문서 테이블 확인
3. **스크립트 실행**: 해당 스크립트의 참조 문서 먼저 읽기
4. **문제 해결**: 프로세스 플로우 다이어그램 참조

**문서 간 일관성:**
- 모든 문서는 README.md의 정의를 따름
- OFFICIAL: 4년, PUBLIC: 2년 (수집일 기준)
- 등급: +4 ~ -4 (점수 = 등급 × 2)
- 수집: Gemini 50% + Naver 50%
- 평가: Claude (Haiku 4.5), ChatGPT (gpt-5.1-codex-mini), Gemini (2.0 Flash), Grok (Grok 3) - 4개 AI
- 배치 크기: API 25개, Gemini Subprocess 25개, Claude Skill 50개

---

**생성일**: 2026-02-10
**최종 수정**: 2026-02-22
**생성 목적**: 다른 Claude Code 세션이 V40 시스템의 문서 구조를 빠르게 파악하고 올바른 문서를 참조할 수 있도록 함
