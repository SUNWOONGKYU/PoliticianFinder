# P2D3: 정치인 최근 글 시스템

## 작업 ID
P2D3

## 작업 개요
정치인이 직접 작성하는 공식 글(공약, 활동, 입장표명 등) 시스템 구축

## 담당 AI
fullstack-developer

## 의존 작업
없음

## 작업 내용

### 1. politician_posts 테이블 생성
```sql
CREATE TABLE politician_posts (
  id BIGSERIAL PRIMARY KEY,
  politician_id INTEGER NOT NULL REFERENCES politicians(id),
  user_id UUID REFERENCES auth.users(id),
  category VARCHAR(50) NOT NULL DEFAULT 'general',
  title VARCHAR(200),
  content TEXT NOT NULL,
  view_count INTEGER DEFAULT 0,
  upvotes INTEGER DEFAULT 0,
  downvotes INTEGER DEFAULT 0,
  comment_count INTEGER DEFAULT 0,
  is_pinned BOOLEAN DEFAULT false,
  is_official BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
)
```

카테고리: '공약', '활동', '입장표명', '공지', '소통', '보도자료'

### 2. v_politician_posts_recent9 뷰
- 최근 30일 이내 글
- 정치인 기본 정보 포함
- is_pinned 우선 정렬
- 최신순 9개

### 3. RLS 정책
- 모두 읽기 가능
- 정치인 본인과 admin만 작성 가능
- 본인 글만 수정/삭제 가능

### 4. 자동 업데이트
- comment_count 자동 업데이트 트리거
- updated_at 자동 업데이트 트리거

## 산출물
- `supabase/migrations/20251020_P2D3_politician_posts_system.sql`

## 검증 방법
```sql
SELECT * FROM v_politician_posts_recent9;
SELECT * FROM politician_posts WHERE is_pinned = true;
```

## 예상 소요 시간
30분

## 완료 조건
- [x] politician_posts 테이블 생성
- [x] 인덱스 5개 생성
- [x] v_politician_posts_recent9 뷰 생성
- [x] RLS 정책 4개 설정
- [x] 트리거 2개 생성
- [x] 샘플 데이터 50개 삽입

## 상태
✅ 완료 (2025-10-20 01:00)
