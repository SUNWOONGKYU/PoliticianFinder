# ê°„ì ‘ ì„œë¸Œ ì—ì´ì „íŠ¸ í™œìš© ì™„ë²½ ê°€ì´ë“œ

**ì‘ì„±ì¼**: 2025-10-31
**ëª©ì **: Custom Agentë¥¼ Built-in Agentë¥¼ í†µí•´ ê°„ì ‘ ì†Œí™˜í•˜ëŠ” ë°©ë²•

---

## ğŸ“š ëª©ì°¨

1. [ë°°ê²½: ì™œ ê°„ì ‘ ì†Œí™˜ì¸ê°€?](#ë°°ê²½-ì™œ-ê°„ì ‘-ì†Œí™˜ì¸ê°€)
2. [2ë‹¨ê³„ ë§¤í•‘ êµ¬ì¡°](#2ë‹¨ê³„-ë§¤í•‘-êµ¬ì¡°)
3. [ê°„ì ‘ ì†Œí™˜ ì›ë¦¬](#ê°„ì ‘-ì†Œí™˜-ì›ë¦¬)
4. [ì‹¤ì œ êµ¬í˜„ ë°©ë²•](#ì‹¤ì œ-êµ¬í˜„-ë°©ë²•)
5. [í†µí•© ì‹¤í–‰ê¸°](#í†µí•©-ì‹¤í–‰ê¸°)
6. [FAQ](#faq)

---

## ë°°ê²½: ì™œ ê°„ì ‘ ì†Œí™˜ì¸ê°€?

### ì§ì ‘ ì†Œí™˜ì´ ì•ˆ ë˜ëŠ” ì´ìœ 

#### 1. ë³´ì•ˆ ë¬¸ì œ
```
ë§Œì•½ ì§ì ‘ ì†Œí™˜ì´ ê°€ëŠ¥í•˜ë‹¤ë©´:
- ì•…ì˜ì ì¸ .md íŒŒì¼ë¡œ ì‹œìŠ¤í…œ íŒŒê´´ ê°€ëŠ¥
- ê²€ì¦ë˜ì§€ ì•Šì€ ì½”ë“œ ì‹¤í–‰ ìœ„í—˜
```

#### 2. í’ˆì§ˆ ê´€ë¦¬
```
Built-in Agent (4ê°œ):
- Anthropicì´ ì§ì ‘ ê°œë°œ ë° í…ŒìŠ¤íŠ¸
- ì•ˆì •ì„± ë³´ì¥

Custom Agent (14ê°œ):
- ì‚¬ìš©ì ì‘ì„±
- í…ŒìŠ¤íŠ¸ í•„ìš”
```

#### 3. ê¸°ìˆ  êµ¬ì¡°
```python
# Task toolì˜ subagent_typeì€ Enumìœ¼ë¡œ í•˜ë“œì½”ë”©
subagent_type: "general-purpose" | "Explore" | "statusline-setup" | "output-style-setup"

# ë™ì  ì¶”ê°€ ë¶ˆê°€ëŠ¥
```

#### 4. ì±…ì„ ë²”ìœ„
```
Built-in ì‚¬ìš© ë¬¸ì œ â†’ Anthropic ì±…ì„
Custom ì§ì ‘ ì‹¤í–‰ ë¬¸ì œ â†’ ì±…ì„ ì†Œì¬ ë¶ˆëª…í™•
```

### ê°„ì ‘ ì†Œí™˜ì˜ ì¥ì 

âœ… **ì•ˆì „ì„±**: Built-in Agentê°€ í•„í„°ë§
âœ… **ìœ ì—°ì„±**: .md íŒŒì¼ë§Œ ìˆ˜ì •í•˜ë©´ ì¦‰ì‹œ ë°˜ì˜
âœ… **ì¡°í•© ê°€ëŠ¥**: ì—¬ëŸ¬ Agent ì—­í•  ë™ì‹œ ë¶€ì—¬
âœ… **ë²„ì „ ê´€ë¦¬**: Gitìœ¼ë¡œ ì´ë ¥ ê´€ë¦¬ ê°€ëŠ¥

---

## 2ë‹¨ê³„ ë§¤í•‘ êµ¬ì¡°

### ì „ì²´ íë¦„

```
[144ê°œ Task]
    â†“
[1ë‹¨ê³„ ë§¤í•‘: Task â†’ Custom Agent]
    â†“
[14ê°œ Custom Agent]
    â†“
[2ë‹¨ê³„ ë§¤í•‘: Custom Agent â†’ Built-in Agent]
    â†“
[4ê°œ Built-in Agent]
    â†“
[ì‹¤í–‰]
```

### 1ë‹¨ê³„ ë§¤í•‘: Task â†’ Custom Agent

| Area | ì„¤ëª… | Task ìˆ˜ | Custom Agent |
|------|------|---------|--------------|
| O | DevOps | 9 | devops-troubleshooter |
| D | Database | 30 | database-developer |
| BI | Backend Infrastructure | 3 | backend-developer |
| BA | Backend APIs | 53 | api-designer |
| F | Frontend | 31 | frontend-developer, ui-designer |
| T | Test | 18 | test-engineer, code-reviewer |

**ë§¤í•‘ ë¡œì§**:
```python
def get_custom_agent(task_id: str) -> str:
    """Task IDì—ì„œ Custom Agent ì¶”ì¶œ"""
    # P1BA1 â†’ BA â†’ api-designer
    area = extract_area_from_task_id(task_id)

    mapping = {
        'O': 'devops-troubleshooter',
        'D': 'database-developer',
        'BI': 'backend-developer',
        'BA': 'api-designer',
        'F': 'frontend-developer',
        'T': 'test-engineer'
    }

    return mapping[area]
```

### 2ë‹¨ê³„ ë§¤í•‘: Custom Agent â†’ Built-in Agent

| Built-in Agent | ìš©ë„ | ë§¤í•‘ë˜ëŠ” Custom Agent |
|----------------|------|---------------------|
| general-purpose | ë²”ìš© ê°œë°œ | 11ê°œ (ëŒ€ë¶€ë¶„) |
| Explore | ì½”ë“œ íƒìƒ‰ | code-reviewer (í•„ìš” ì‹œ) |
| statusline-setup | ìƒíƒœë°” ì„¤ì • | ì—†ìŒ |
| output-style-setup | ì¶œë ¥ ìŠ¤íƒ€ì¼ | ì—†ìŒ |

**ëŒ€ë¶€ë¶„ general-purpose ì‚¬ìš©**:
```python
def get_builtin_agent(custom_agent: str) -> str:
    """Custom Agent â†’ Built-in Agent"""
    # íŠ¹ìˆ˜ ì¼€ì´ìŠ¤ë§Œ ì²˜ë¦¬
    if custom_agent == 'code-reviewer':
        return 'Explore'  # ì½”ë“œ íƒìƒ‰ í•„ìš” ì‹œ

    # ê¸°ë³¸ê°’: general-purpose
    return 'general-purpose'
```

---

## ê°„ì ‘ ì†Œí™˜ ì›ë¦¬

### í•µì‹¬ ê°œë…

**ì§ì ‘ ì†Œí™˜ (ë¶ˆê°€ëŠ¥)**:
```python
# âŒ ì‘ë™ ì•ˆ í•¨
Task(
    subagent_type="api-designer",  # Custom Agent ì§ì ‘ í˜¸ì¶œ
    prompt="API ë§Œë“¤ì–´ì¤˜"
)
# Error: Agent type 'api-designer' not found
```

**ê°„ì ‘ ì†Œí™˜ (ì‘ë™)**:
```python
# âœ… ì‘ë™í•¨
# 1. Custom Agent ì—­í•  ì •ì˜ ì½ê¸°
agent_role = Read("/c/Users/home/.claude/agents/api-designer.md")

# 2. Built-in Agentì— ì—­í•  ë¶€ì—¬
Task(
    subagent_type="general-purpose",  # Built-in Agent
    prompt=f"""
{agent_role}

---

ìœ„ ì—­í• ë¡œ ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì„¸ìš”:
API ë§Œë“¤ì–´ì¤˜
"""
)
```

### ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°

**ë°°ìš°ì™€ ì—°ê¸°**:
```
ì§ì ‘ ì†Œí™˜ (ë¶ˆê°€ëŠ¥):
"api-designerì•¼, ë¬´ëŒ€ì— ë‚˜ì™€!" âŒ
â†’ api-designerëŠ” ì‹¤ì œ ë°°ìš°ê°€ ì•„ë‹˜

ê°„ì ‘ ì†Œí™˜ (ê°€ëŠ¥):
"general-purposeì•¼, ë¬´ëŒ€ì— ë‚˜ì™€!" âœ…
"ì—¬ê¸° api-designer ëŒ€ë³¸ ìˆì–´, ì´ ì—­í• ë¡œ ì—°ê¸°í•´!"
â†’ general-purposeê°€ api-designer ì—­í•  ì—°ê¸°
```

---

## ì‹¤ì œ êµ¬í˜„ ë°©ë²•

### ë°©ë²• 1: ìˆ˜ë™ ê°„ì ‘ ì†Œí™˜

**ë‹¨ê³„ë³„ ê³¼ì •**:

```markdown
1. Custom Agent íŒŒì¼ ì½ê¸°
â†’ Read("/c/Users/home/.claude/agents/api-designer.md")

2. ì‘ì—… ì§€ì‹œì„œ ì½ê¸°
â†’ Read("./tasks/P1BA1.md")

3. Task toolë¡œ ê°„ì ‘ ì†Œí™˜
â†’ Task(
    subagent_type="general-purpose",
    description="API ì„¤ê³„ ì‘ì—…",
    prompt=f"""
{agent_content}

---

ì‘ì—… ì§€ì‹œ:
{task_instruction}
"""
)
```

### ë°©ë²• 2: ìë™í™”ëœ ê°„ì ‘ ì†Œí™˜ (í†µí•© ì‹¤í–‰ê¸°)

**í†µí•© ì‹¤í–‰ê¸° ì½”ë“œ**:

```python
#!/usr/bin/env python3
"""
PROJECT GRID í†µí•© ì‹¤í–‰ê¸°
144ê°œ ì‘ì—…ì„ ìë™ìœ¼ë¡œ ìˆœì°¨ ì‹¤í–‰
"""

import json
from pathlib import Path

class ProjectGridExecutor:
    """PROJECT GRID ìë™ ì‹¤í–‰ ì‹œìŠ¤í…œ"""

    def __init__(self):
        self.base_dir = Path(__file__).parent
        self.tasks_file = self.base_dir / "generated_grid_full_v4.json"
        self.agents_dir = Path("/c/Users/home/.claude/agents")

        # ë§¤í•‘ í…Œì´ë¸”
        self.agent_mapping = {
            'O': 'devops-troubleshooter',
            'D': 'database-developer',
            'BI': 'backend-developer',
            'BA': 'api-designer',
            'F': 'frontend-developer',
            'T': 'test-engineer'
        }

        # ì‹¤í–‰ ë¡œê·¸
        self.execution_log = []

    def load_tasks(self):
        """144ê°œ ì‘ì—… ë¡œë“œ"""
        with open(self.tasks_file, 'r', encoding='utf-8') as f:
            return json.load(f)

    def get_custom_agent(self, task_id: str) -> str:
        """Task ID â†’ Custom Agent"""
        # P1BA1 â†’ BA
        area_code = ''.join([c for c in task_id[2:] if c.isalpha()])
        return self.agent_mapping.get(area_code, 'fullstack-developer')

    def load_agent_prompt(self, agent_name: str) -> str:
        """Custom Agent .md íŒŒì¼ ì½ê¸°"""
        agent_file = self.agents_dir / f"{agent_name}.md"

        if not agent_file.exists():
            return f"# {agent_name}\n\nê¸°ë³¸ ê°œë°œì ì—­í• "

        with open(agent_file, 'r', encoding='utf-8') as f:
            return f.read()

    def load_task_instruction(self, task_id: str) -> str:
        """ì‘ì—… ì§€ì‹œì„œ ì½ê¸°"""
        instruction_file = self.base_dir / "tasks" / f"{task_id}.md"

        with open(instruction_file, 'r', encoding='utf-8') as f:
            return f.read()

    def check_dependency(self, task: dict, completed_tasks: set) -> bool:
        """ì˜ì¡´ì„± ì²´í¬"""
        deps = task.get('dependency_chain', 'ì—†ìŒ')

        if deps == 'ì—†ìŒ':
            return True

        # ì˜ì¡´ ì‘ì—…ë“¤ì´ ëª¨ë‘ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸
        dep_list = [d.strip() for d in deps.split(',')]
        return all(dep in completed_tasks for dep in dep_list)

    def generate_execution_prompt(self, task: dict, agent_prompt: str, task_instruction: str) -> str:
        """ì‹¤í–‰ í”„ë¡¬í”„íŠ¸ ìƒì„±"""
        return f"""
{agent_prompt}

---

## ì‘ì—… ì •ë³´

- Task ID: {task['task_id']}
- Task Name: {task['task_name']}
- Area: {task['area']}
- Phase: {task['phase']}

---

## ì‘ì—… ì§€ì‹œ

{task_instruction}

---

ìœ„ ì—­í• ë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³ , ì™„ë£Œ í›„ ë‹¤ìŒì„ ë³´ê³ í•˜ì„¸ìš”:
1. ìƒì„±ëœ íŒŒì¼ ëª©ë¡
2. ì£¼ìš” êµ¬í˜„ ë‚´ìš©
3. í…ŒìŠ¤íŠ¸ ê²°ê³¼
4. ë‹¤ìŒ ì˜ì¡´ ì‘ì—…ì— ì˜í–¥
"""

    def execute_task(self, task: dict) -> dict:
        """ë‹¨ì¼ ì‘ì—… ì‹¤í–‰"""
        task_id = task['task_id']

        print(f"\n{'='*80}")
        print(f"EXECUTING: {task_id} - {task['task_name']}")
        print(f"{'='*80}")

        # 1. Custom Agent ê²°ì •
        custom_agent = self.get_custom_agent(task_id)
        print(f"[1ë‹¨ê³„] {task_id} â†’ {custom_agent}")

        # 2. Built-in Agent ê²°ì •
        builtin_agent = 'general-purpose'
        print(f"[2ë‹¨ê³„] {custom_agent} â†’ {builtin_agent}")

        # 3. Agent ì—­í•  ë¡œë“œ
        agent_prompt = self.load_agent_prompt(custom_agent)
        print(f"[ë¡œë“œ] Agent: {len(agent_prompt)} ë¬¸ì")

        # 4. ì‘ì—… ì§€ì‹œì„œ ë¡œë“œ
        task_instruction = self.load_task_instruction(task_id)
        print(f"[ë¡œë“œ] Instruction: {len(task_instruction)} ë¬¸ì")

        # 5. ì‹¤í–‰ í”„ë¡¬í”„íŠ¸ ìƒì„±
        execution_prompt = self.generate_execution_prompt(
            task, agent_prompt, task_instruction
        )

        # 6. ì‹¤í–‰ ëª…ë ¹ ë°˜í™˜
        execution_command = {
            'task_id': task_id,
            'task_name': task['task_name'],
            'custom_agent': custom_agent,
            'builtin_agent': builtin_agent,
            'execution_prompt': execution_prompt,
            'prompt_length': len(execution_prompt)
        }

        self.execution_log.append({
            'task_id': task_id,
            'status': 'ready',
            'custom_agent': custom_agent
        })

        return execution_command

    def run_all(self):
        """144ê°œ ì‘ì—… ì „ì²´ ì‹¤í–‰"""
        tasks = self.load_tasks()
        completed = set()

        print(f"\n{'='*80}")
        print(f"PROJECT GRID í†µí•© ì‹¤í–‰ê¸°")
        print(f"ì´ {len(tasks)}ê°œ ì‘ì—…")
        print(f"{'='*80}")

        # Phaseë³„ë¡œ ì •ë ¬
        tasks_by_phase = {}
        for task in tasks:
            phase = task['phase']
            if phase not in tasks_by_phase:
                tasks_by_phase[phase] = []
            tasks_by_phase[phase].append(task)

        # Phaseë³„ ìˆœì°¨ ì‹¤í–‰
        for phase in sorted(tasks_by_phase.keys()):
            print(f"\n\n{'#'*80}")
            print(f"# Phase {phase}: {len(tasks_by_phase[phase])}ê°œ ì‘ì—…")
            print(f"{'#'*80}")

            phase_tasks = tasks_by_phase[phase]

            # ì˜ì¡´ì„± ìˆœì„œë¡œ ì‹¤í–‰
            while phase_tasks:
                executed_in_round = []

                for task in phase_tasks:
                    # ì˜ì¡´ì„± ì²´í¬
                    if self.check_dependency(task, completed):
                        # ì‹¤í–‰ ê°€ëŠ¥
                        cmd = self.execute_task(task)

                        # ì—¬ê¸°ì„œ ì‹¤ì œë¡œ Task tool í˜¸ì¶œ
                        print(f"\n[ì‹¤í–‰] Task tool í˜¸ì¶œ ì¤€ë¹„:")
                        print(f"  - subagent_type: {cmd['builtin_agent']}")
                        print(f"  - prompt ê¸¸ì´: {cmd['prompt_length']} ë¬¸ì")

                        # ì™„ë£Œ ì²˜ë¦¬
                        completed.add(task['task_id'])
                        executed_in_round.append(task)

                # ì‹¤í–‰ëœ ì‘ì—… ì œê±°
                for task in executed_in_round:
                    phase_tasks.remove(task)

                # ë¬´í•œ ë£¨í”„ ë°©ì§€
                if not executed_in_round and phase_tasks:
                    print(f"\n[ê²½ê³ ] ì˜ì¡´ì„± ë¬¸ì œë¡œ ì‹¤í–‰ ë¶ˆê°€: {[t['task_id'] for t in phase_tasks]}")
                    break

        # ì‹¤í–‰ ë¡œê·¸ ì €ì¥
        log_file = self.base_dir / "execution_log.json"
        with open(log_file, 'w', encoding='utf-8') as f:
            json.dump(self.execution_log, f, ensure_ascii=False, indent=2)

        print(f"\n\n{'='*80}")
        print(f"ì‹¤í–‰ ì™„ë£Œ: {len(completed)}/{len(tasks)}ê°œ")
        print(f"ë¡œê·¸ ì €ì¥: {log_file}")
        print(f"{'='*80}")

# ì‹¤í–‰
if __name__ == "__main__":
    executor = ProjectGridExecutor()
    executor.run_all()
```

---

## í†µí•© ì‹¤í–‰ê¸°

### íŠ¹ì§•

âœ… **ì™„ì „ ìë™**: 144ê°œ ì‘ì—… ìˆœì°¨ ì‹¤í–‰
âœ… **ì˜ì¡´ì„± ê´€ë¦¬**: dependency_chain ìë™ ì²´í¬
âœ… **Phase ìˆœì„œ**: Phase 1 â†’ 2 â†’ ... â†’ 7
âœ… **ë¡œê¹…**: ì‹¤í–‰ ì´ë ¥ ìë™ ì €ì¥
âœ… **ì—ëŸ¬ ì²˜ë¦¬**: ë¬¸ì œ ë°œìƒ ì‹œ ë¡œê·¸ ê¸°ë¡

### ì‚¬ìš© ë°©ë²•

```bash
# ì‹¤í–‰
python project_grid_executor.py

# ê²°ê³¼
Phase 1: 20ê°œ ì‘ì—… ì‹¤í–‰
Phase 2: 24ê°œ ì‘ì—… ì‹¤í–‰
...
Phase 7: 18ê°œ ì‘ì—… ì‹¤í–‰

ì™„ë£Œ: 144/144ê°œ
```

### ì‹¤í–‰ íë¦„

```
1. generated_grid_full_v4.json ë¡œë“œ
2. Phaseë³„ë¡œ ê·¸ë£¹í™”
3. Phase 1 ì‹œì‘:
   3.1. ì˜ì¡´ì„± ì—†ëŠ” ì‘ì—… ì°¾ê¸° (P1O1)
   3.2. Custom Agent ê²°ì • (devops-troubleshooter)
   3.3. Agent .md íŒŒì¼ ì½ê¸°
   3.4. ì‘ì—… ì§€ì‹œì„œ ì½ê¸°
   3.5. Task toolë¡œ ê°„ì ‘ ì†Œí™˜
   3.6. ì™„ë£Œ ëŒ€ê¸°
   3.7. ë‹¤ìŒ ì‘ì—… (P1D1 - P1O1 ì˜ì¡´)
   ...
4. Phase 2 ì‹œì‘
5. ...
7. Phase 7 ì™„ë£Œ
8. ì‹¤í–‰ ë¡œê·¸ ì €ì¥
```

---

## FAQ

### Q1: ì™œ ì§ì ‘ ì†Œí™˜ì´ ì•ˆ ë˜ë‚˜ìš”?
A: ë³´ì•ˆ, í’ˆì§ˆ ê´€ë¦¬, ê¸°ìˆ  êµ¬ì¡°ìƒ ì œì•½ ë•Œë¬¸ì…ë‹ˆë‹¤. Anthropicì´ ê²€ì¦í•œ Built-in Agentë§Œ ì§ì ‘ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### Q2: ê°„ì ‘ ì†Œí™˜ìœ¼ë¡œ ì„±ëŠ¥ ì €í•˜ëŠ”?
A: ê±°ì˜ ì—†ìŠµë‹ˆë‹¤. .md íŒŒì¼ ì½ê¸°ëŠ” ë§¤ìš° ë¹ ë¥´ë©°, í”„ë¡¬í”„íŠ¸ ê¸¸ì´ë§Œ ì•½ê°„ ì¦ê°€í•©ë‹ˆë‹¤.

### Q3: Custom Agentë¥¼ ì—¬ëŸ¬ ê°œ ì¡°í•©í•  ìˆ˜ ìˆë‚˜ìš”?
A: ê°€ëŠ¥í•©ë‹ˆë‹¤. ì—¬ëŸ¬ .md íŒŒì¼ì„ ì½ì–´ì„œ í•˜ë‚˜ì˜ í”„ë¡¬í”„íŠ¸ë¡œ ê²°í•©í•˜ë©´ ë©ë‹ˆë‹¤.

```python
api_designer = Read("api-designer.md")
security_specialist = Read("security-specialist.md")

combined_prompt = f"""
{api_designer}

{security_specialist}

ë‘ ì—­í• ì„ ëª¨ë‘ ê³ ë ¤í•´ì„œ ë³´ì•ˆì´ ê°•í™”ëœ APIë¥¼ ì„¤ê³„í•˜ì„¸ìš”.
"""
```

### Q4: 144ê°œë¥¼ ì¼ì¼ì´ ì‹¤í–‰í•´ì•¼ í•˜ë‚˜ìš”?
A: ì•„ë‹ˆìš”. í†µí•© ì‹¤í–‰ê¸°ê°€ ìë™ìœ¼ë¡œ ìˆœì°¨ ì‹¤í–‰í•©ë‹ˆë‹¤.

### Q5: ì¤‘ê°„ì— ì‹¤íŒ¨í•˜ë©´?
A: execution_log.jsonì— ê¸°ë¡ë˜ë©°, ì‹¤íŒ¨í•œ ì‘ì—…ë¶€í„° ì¬ê°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## í•µì‹¬ ì •ë¦¬

### âœ… DO
- ê°„ì ‘ ì†Œí™˜ ë°©ì‹ ì‚¬ìš©
- .md íŒŒì¼ë¡œ Agent ì—­í•  ì •ì˜
- í†µí•© ì‹¤í–‰ê¸°ë¡œ ìë™í™”
- ì˜ì¡´ì„± ìˆœì„œ ì¤€ìˆ˜

### âŒ DON'T
- ì§ì ‘ ì†Œí™˜ ì‹œë„ (ì‘ë™ ì•ˆ í•¨)
- Custom Agentë¥¼ subagent_typeì— ì§ì ‘ ì…ë ¥
- ìˆ˜ë™ìœ¼ë¡œ 144ê°œ ì‹¤í–‰
- ì˜ì¡´ì„± ë¬´ì‹œ

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2025-10-31
**ë²„ì „**: 1.0
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: ì‹¤ì œ ì‹¤í–‰ ê²°ê³¼ ë°˜ì˜ í›„
