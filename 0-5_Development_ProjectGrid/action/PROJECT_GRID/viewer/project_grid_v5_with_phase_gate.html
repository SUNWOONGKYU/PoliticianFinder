<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROJECT GRID V5 - Phase Gate í¬í•¨</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow-x: hidden;
            color: #333;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        header h1 { font-size: 2em; margin-bottom: 10px; }

        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        /* ========== Phase í†µê³„ ì„¹ì…˜ ========== */
        .phase-statistics {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .phase-stats-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .phase-item {
            padding: 15px;
            margin-bottom: 15px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            border-radius: 5px;
        }

        .phase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 1.1em;
        }

        .phase-stats {
            color: #666;
            font-size: 0.95em;
        }

        .phase-completion { color: #28a745; font-weight: bold; }
        .phase-incomplete { color: #666; }

        /* ========== Phase Gate ìŠ¤íƒ€ì¼ ========== */
        .phase-gate-container {
            margin-top: 10px;
            padding-left: 20px;
        }

        .phase-gate {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 5px;
            font-size: 0.95em;
        }

        .phase-gate.completed {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .phase-gate.locked {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .gate-icon {
            font-size: 1.2em;
            min-width: 20px;
            text-align: center;
        }

        .gate-status {
            font-weight: 600;
            flex: 1;
        }

        .approval-info {
            color: #666;
            font-size: 0.9em;
        }

        .locked-reason {
            color: #666;
            font-style: italic;
        }

        .approve-btn {
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .approve-btn:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* ========== ì‘ì—… ì¹´ë“œ ========== */
        .tasks-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .tasks-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .area-section {
            margin-bottom: 25px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            overflow: hidden;
        }

        .area-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }

        .area-header:hover { background: linear-gradient(135deg, #5568d3 0%, #6b3a8f 100%); }

        .area-content {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 15px;
        }

        .area-content.collapsed { display: none; }

        /* ========== ì‘ì—… ì¹´ë“œ ========== */
        .task-card {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .task-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .task-card.completed::before { background: #28a745; }
        .task-card.in-progress::before { background: #ffc107; }
        .task-card.pending::before { background: #6c757d; }

        .task-card:hover {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e9ecef;
        }

        .task-id {
            font-size: 1.1em;
            font-weight: bold;
            color: #667eea;
        }

        .task-status {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .status-completed { background: #d4edda; color: #155724; }
        .status-in-progress { background: #fff3cd; color: #856404; }
        .status-pending { background: #e2e3e5; color: #383d41; }

        .task-title {
            font-size: 1em;
            font-weight: 600;
            margin-bottom: 12px;
            color: #333;
        }

        .task-attributes {
            display: grid;
            gap: 8px;
            font-size: 0.85em;
            margin-bottom: 12px;
        }

        .attr-row {
            display: grid;
            grid-template-columns: 100px 1fr;
            gap: 10px;
            padding: 6px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .attr-label {
            font-weight: 600;
            color: #667eea;
        }

        .attr-value {
            color: #555;
            word-break: break-word;
        }

        .generated-files {
            background: #e7f3ff;
            border-left: 3px solid #2196F3;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            max-height: 150px;
            overflow-y: auto;
        }

        .generated-files-title {
            font-weight: 600;
            color: #1976D2;
            margin-bottom: 8px;
            font-size: 0.9em;
        }

        .file-item {
            padding: 4px 8px;
            background: white;
            border-radius: 3px;
            margin: 4px 0;
            font-size: 0.85em;
            word-break: break-all;
            border-left: 2px solid #2196F3;
        }

        .file-item::before {
            content: 'ğŸ“„ ';
        }

        /* ========== ëª¨ë‹¬ ë‹¤ì´ì–¼ë¡œê·¸ ========== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            background: #f8f9fa;
        }

        .modal-header h2 {
            color: #667eea;
            font-size: 1.4em;
        }

        .modal-body {
            padding: 20px;
        }

        .phase-summary {
            background: #f0f8ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .phase-summary h3 {
            color: #1976D2;
            margin-bottom: 10px;
        }

        .phase-summary ul {
            list-style: none;
            padding-left: 0;
        }

        .phase-summary li {
            padding: 6px 0;
            color: #333;
        }

        .approval-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .approval-form label {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .approval-form input,
        .approval-form textarea {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.95em;
            font-family: inherit;
        }

        .approval-form textarea {
            min-height: 80px;
            resize: vertical;
        }

        .auto-timestamp {
            background: #f5f5f5;
            padding: 12px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .timestamp {
            font-weight: 600;
            color: #2196F3;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #e9ecef;
            background: #f8f9fa;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn-cancel {
            padding: 10px 20px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-cancel:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .btn-approve {
            padding: 10px 20px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-approve:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        /* ========== ê¸°íƒ€ ========== */
        .no-data {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <header>
        <h1>ğŸ¯ PROJECT GRID V5</h1>
        <p>Phase Gate ìŠ¹ì¸ ì‹œìŠ¤í…œ í¬í•¨</p>
    </header>

    <div class="container">
        <!-- Phase í†µê³„ ë° Gate ì„¹ì…˜ -->
        <div class="phase-statistics">
            <div class="phase-stats-title">ğŸ“Š Phaseë³„ ì§„í–‰ í˜„í™©</div>
            <div id="phaseStatsContainer"></div>
        </div>

        <!-- ì‘ì—… ì¹´ë“œ ì„¹ì…˜ -->
        <div class="tasks-section">
            <div class="tasks-title">ğŸ“‹ ì‘ì—… ìƒì„¸ ì •ë³´</div>
            <div id="tasksContainer" class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</div>
        </div>
    </div>

    <!-- Phase Gate ìŠ¹ì¸ ëª¨ë‹¬ -->
    <div class="modal" id="approvalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ”’ Phase Gate ìŠ¹ì¸</h2>
            </div>

            <div class="modal-body">
                <div class="phase-summary" id="phaseSummaryContainer"></div>

                <div class="approval-form">
                    <label for="approver-name">ìŠ¹ì¸ì (ìë™ ì…ë ¥):</label>
                    <input type="text" id="approver-name" value="SUNWOONGKYU" disabled>

                    <label for="approval-notes">ìŠ¹ì¸ ë©”ëª¨ (ì„ íƒ):</label>
                    <textarea id="approval-notes" placeholder="ìŠ¹ì¸ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>

                    <div class="auto-timestamp">
                        <span>ìŠ¹ì¸ ì‹œê°„:</span>
                        <span class="timestamp" id="approval-timestamp">ìë™ ìƒì„±</span>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeApprovalModal()">ì·¨ì†Œ</button>
                <button class="btn-approve" onclick="submitApproval()">âœ… ìŠ¹ì¸ ì™„ë£Œ</button>
            </div>
        </div>
    </div>

    <script>
        // ========== ì „ì—­ ë³€ìˆ˜ ==========
        let allTasks = [];
        let phaseGates = {}; // Phaseë³„ Gate ì •ë³´
        const AREA_NAMES = {
            'O': 'ğŸ—‚ï¸ ìš´ì˜',
            'D': 'ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤',
            'BI': 'âš™ï¸ ë°±ì—”ë“œ ê¸°ë°˜',
            'BA': 'ğŸ”Œ ë°±ì—”ë“œ API',
            'F': 'ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ',
            'T': 'ğŸ§ª í…ŒìŠ¤íŠ¸',
            'GATE': 'ğŸ”’ Phase Gate'
        };

        const DEMO_MODE = true; // ë°ëª¨ ëª¨ë“œ (ì‹¤ì œë¡œëŠ” Supabase ì—°ë™)

        // ========== ì´ˆê¸°í™” ==========
        async function init() {
            console.log('í”„ë¡œì íŠ¸ ê·¸ë¦¬ë“œ V5 ì´ˆê¸°í™” ì¤‘...');

            if (DEMO_MODE) {
                loadDemoData();
            } else {
                // Supabase ì—°ë™ (ì‹¤ì œ êµ¬í˜„ ì‹œ)
                loadFromSupabase();
            }

            renderPhaseStatistics();
            renderTasks();
        }

        // ========== ë°ëª¨ ë°ì´í„° ë¡œë“œ ==========
        function loadDemoData() {
            // Phase 1: ì™„ë£Œ (100%)
            const phase1Tasks = [
                {
                    ì‘ì—…ID: 'P1O1',
                    phase: 1,
                    area: 'O',
                    ì—…ë¬´: 'í”„ë¡œì íŠ¸ ì´ˆê¸°í™”',
                    ìƒíƒœ: 'ì™„ë£Œ',
                    ì§„ë„: '100%',
                    ì„œë¸Œì—ì´ì „íŠ¸: 'devops-troubleshooter',
                    ì‚¬ìš©ë„êµ¬: 'Bash, Git',
                    ì‘ì—…ë°©ì‹: 'ìë™í™”',
                    ì˜ì¡´ì„±ì²´ì¸: 'ì—†ìŒ',
                    ë¹Œë“œê²°ê³¼: 'âœ… ì„±ê³µ',
                    ì¢…í•©ê²€ì¦ê²°ê³¼: 'âœ… í†µê³¼',
                    ìƒì„±íŒŒì¼: ['package.json', 'tsconfig.json', '.eslintrc.js']
                },
                {
                    ì‘ì—…ID: 'P1D1',
                    phase: 1,
                    area: 'D',
                    ì—…ë¬´: 'ì¸ì¦ ìŠ¤í‚¤ë§ˆ ìƒì„±',
                    ìƒíƒœ: 'ì™„ë£Œ',
                    ì§„ë„: '100%',
                    ì„œë¸Œì—ì´ì „íŠ¸: 'database-developer',
                    ì‚¬ìš©ë„êµ¬: 'PostgreSQL, Supabase',
                    ì‘ì—…ë°©ì‹: 'SQL ë§ˆì´ê·¸ë ˆì´ì…˜',
                    ì˜ì¡´ì„±ì²´ì¸: 'ì—†ìŒ',
                    ë¹Œë“œê²°ê³¼: 'âœ… ì„±ê³µ',
                    ì¢…í•©ê²€ì¦ê²°ê³¼: 'âœ… í†µê³¼',
                    ìƒì„±íŒŒì¼: ['1_database/001_auth_schema.sql', '1_database/002_auth_types.sql']
                },
                {
                    ì‘ì—…ID: 'P1BA1',
                    phase: 1,
                    area: 'BA',
                    ì—…ë¬´: 'íšŒì›ê°€ì… API',
                    ìƒíƒœ: 'ì™„ë£Œ',
                    ì§„ë„: '100%',
                    ì„œë¸Œì—ì´ì „íŠ¸: 'backend-developer',
                    ì‚¬ìš©ë„êµ¬: 'TypeScript, Next.js',
                    ì‘ì—…ë°©ì‹: 'ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜',
                    ì˜ì¡´ì„±ì²´ì¸: 'P1D1',
                    ë¹Œë“œê²°ê³¼: 'âœ… ì„±ê³µ',
                    ì¢…í•©ê²€ì¦ê²°ê³¼: 'âœ… í†µê³¼',
                    ìƒì„±íŒŒì¼: ['3_Backend_APIs/auth/P1BA1_signup.ts', '3_Backend_APIs/auth/P1BA1_signup.test.ts']
                },
                {
                    ì‘ì—…ID: 'P1F1',
                    phase: 1,
                    area: 'F',
                    ì—…ë¬´: 'ë¡œê·¸ì¸ í¼ ì»´í¬ë„ŒíŠ¸',
                    ìƒíƒœ: 'ì™„ë£Œ',
                    ì§„ë„: '100%',
                    ì„œë¸Œì—ì´ì „íŠ¸: 'frontend-developer',
                    ì‚¬ìš©ë„êµ¬: 'React, TypeScript',
                    ì‘ì—…ë°©ì‹: 'ì»´í¬ë„ŒíŠ¸ ê°œë°œ',
                    ì˜ì¡´ì„±ì²´ì¸: 'P1BA1',
                    ë¹Œë“œê²°ê³¼: 'âœ… ì„±ê³µ',
                    ì¢…í•©ê²€ì¦ê²°ê³¼: 'âœ… í†µê³¼',
                    ìƒì„±íŒŒì¼: ['1_Frontend/src/components/LoginForm.tsx', '1_Frontend/src/components/LoginForm.module.css']
                }
            ];

            // Phase 2: ì§„í–‰ ì¤‘ (0%)
            const phase2Tasks = [
                {
                    ì‘ì—…ID: 'P2BA1',
                    phase: 2,
                    area: 'BA',
                    ì—…ë¬´: 'ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ API',
                    ìƒíƒœ: 'ëŒ€ê¸°',
                    ì§„ë„: '0%',
                    ì„œë¸Œì—ì´ì „íŠ¸: 'backend-developer',
                    ì‚¬ìš©ë„êµ¬: 'TypeScript, Next.js',
                    ì‘ì—…ë°©ì‹: 'ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜',
                    ì˜ì¡´ì„±ì²´ì¸: 'P1BA1',
                    ë¹Œë“œê²°ê³¼: 'â³ ëŒ€ê¸°',
                    ì¢…í•©ê²€ì¦ê²°ê³¼: 'â³ ëŒ€ê¸°',
                    ìƒì„±íŒŒì¼: []
                }
            ];

            allTasks = [...phase1Tasks, ...phase2Tasks];

            // Phase Gate ì •ë³´
            phaseGates = {
                1: {
                    status: 'ìŠ¹ì¸ì™„ë£Œ',
                    approved_by: 'SUNWOONGKYU',
                    approved_at: '2025-11-03T15:45:32Z',
                    approval_notes: 'Phase 1 ì™„ë£Œ, Phase 2 ì§„ì… ìŠ¹ì¸',
                    completed_tasks: 4,
                    total_tasks: 4
                },
                2: {
                    status: 'ëŒ€ê¸°ì¤‘',
                    approved_by: null,
                    approved_at: null,
                    approval_notes: null,
                    completed_tasks: 0,
                    total_tasks: 1
                }
            };
        }

        // ========== Phase í†µê³„ ë Œë”ë§ ==========
        function renderPhaseStatistics() {
            const phases = [...new Set(allTasks.map(t => t.phase))].sort();
            let html = '';

            phases.forEach(phase => {
                const phaseTasks = allTasks.filter(t => t.phase === phase);
                const completed = phaseTasks.filter(t => t.ìƒíƒœ.includes('ì™„ë£Œ')).length;
                const inProgress = phaseTasks.filter(t => t.ìƒíƒœ.includes('ì§„í–‰')).length;
                const pending = phaseTasks.filter(t => t.ìƒíƒœ.includes('ëŒ€ê¸°')).length;

                const completionRate = ((completed / phaseTasks.length) * 100).toFixed(1);
                const gate = phaseGates[phase] || { status: 'ì¤€ë¹„ì¤‘' };

                html += `
                    <div class="phase-item">
                        <div class="phase-header">
                            <div>Phase ${phase}</div>
                            <div class="phase-stats">
                                ì „ì²´: ${phaseTasks.length} |
                                <span class="phase-completion">âœ… ì™„ë£Œ: ${completed}</span>
                                (${completionRate}%) |
                                <span class="phase-incomplete">ì§„í–‰: ${inProgress} | ëŒ€ê¸°: ${pending}</span>
                            </div>
                        </div>

                        <div class="phase-gate-container">
                            ${renderPhaseGate(phase, gate)}
                        </div>
                    </div>
                `;
            });

            document.getElementById('phaseStatsContainer').innerHTML = html;
        }

        // ========== Phase Gate ë Œë”ë§ ==========
        function renderPhaseGate(phase, gate) {
            if (gate.status === 'ìŠ¹ì¸ì™„ë£Œ') {
                return `
                    <div class="phase-gate completed">
                        <span class="gate-icon">âœ…</span>
                        <span class="gate-status">Phase Gate: âœ… ìŠ¹ì¸ì™„ë£Œ</span>
                        <span class="approval-info">(${formatTimestamp(gate.approved_at)}) by ${gate.approved_by}</span>
                    </div>
                `;
            } else if (gate.status === 'ëŒ€ê¸°ì¤‘' && gate.completed_tasks === gate.total_tasks) {
                return `
                    <div class="phase-gate">
                        <span class="gate-icon">ğŸ”’</span>
                        <span class="gate-status">Phase Gate: â³ ëŒ€ê¸°ì¤‘</span>
                        <button class="approve-btn" onclick="openApprovalModal(${phase})">ğŸ‘¤ ìŠ¹ì¸í•˜ê¸°</button>
                    </div>
                `;
            } else {
                return `
                    <div class="phase-gate locked">
                        <span class="gate-icon">ğŸ”’</span>
                        <span class="gate-status">Phase Gate: â³ ëŒ€ê¸°ì¤‘</span>
                        <span class="locked-reason">(Phase ë¯¸ì™„ë£Œ: ${gate.completed_tasks}/${gate.total_tasks})</span>
                    </div>
                `;
            }
        }

        // ========== íƒ€ì„ìŠ¤íƒí”„ í¬ë§·íŒ… ==========
        function formatTimestamp(isoString) {
            if (!isoString) return '';
            const date = new Date(isoString);
            return date.toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }

        // ========== ì‘ì—… ì¹´ë“œ ë Œë”ë§ ==========
        function renderTasks() {
            const groupedByArea = {};
            allTasks.forEach(task => {
                if (!groupedByArea[task.area]) groupedByArea[task.area] = [];
                groupedByArea[task.area].push(task);
            });

            const areaOrder = ['O', 'D', 'BI', 'BA', 'F', 'T'];
            const sortedAreas = Object.keys(groupedByArea)
                .filter(a => areaOrder.includes(a))
                .sort((a, b) => areaOrder.indexOf(a) - areaOrder.indexOf(b));

            let html = '';
            sortedAreas.forEach(area => {
                const tasks = groupedByArea[area];
                const completed = tasks.filter(t => t.ìƒíƒœ.includes('ì™„ë£Œ')).length;
                const areaName = AREA_NAMES[area] || area;

                html += `
                    <div class="area-section">
                        <div class="area-header" onclick="toggleArea('${area}')">
                            <div><strong>${areaName}</strong></div>
                            <div>ì „ì²´: ${tasks.length} | ì™„ë£Œ: ${completed}</div>
                        </div>
                        <div class="area-content" id="area-${area}">
                            ${tasks.map(task => createTaskCard(task)).join('')}
                        </div>
                    </div>
                `;
            });

            document.getElementById('tasksContainer').innerHTML = html || '<div class="no-data">ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
        }

        // ========== ì‘ì—… ì¹´ë“œ ìƒì„± ==========
        function createTaskCard(task) {
            const statusClass = task.ìƒíƒœ.includes('ì™„ë£Œ') ? 'completed' :
                               task.ìƒíƒœ.includes('ì§„í–‰') ? 'in-progress' : 'pending';
            const statusText = task.ìƒíƒœ.includes('ì™„ë£Œ') ? 'ì™„ë£Œ' :
                              task.ìƒíƒœ.includes('ì§„í–‰') ? 'ì§„í–‰' : 'ëŒ€ê¸°';

            const generatedFiles = Array.isArray(task.ìƒì„±íŒŒì¼) ? task.ìƒì„±íŒŒì¼ :
                                  typeof task.ìƒì„±íŒŒì¼ === 'string' ? [task.ìƒì„±íŒŒì¼] : [];

            const filesHtml = generatedFiles.length > 0 ? `
                <div class="generated-files">
                    <div class="generated-files-title">ğŸ“¦ ìƒì„±ëœ íŒŒì¼ (${generatedFiles.length}ê°œ)</div>
                    ${generatedFiles.map(file => `<div class="file-item">${file}</div>`).join('')}
                </div>
            ` : '';

            return `
                <div class="task-card ${statusClass}">
                    <div class="task-header">
                        <div class="task-id">${task.ì‘ì—…ID}</div>
                        <div class="task-status status-${statusClass}">${statusText}</div>
                    </div>

                    <div class="task-title">${task.ì—…ë¬´}</div>

                    ${filesHtml}

                    <div class="task-attributes">
                        <div class="attr-row">
                            <div class="attr-label">ì—ì´ì „íŠ¸</div>
                            <div class="attr-value">${task.ì„œë¸Œì—ì´ì „íŠ¸ || '-'}</div>
                        </div>
                        <div class="attr-row">
                            <div class="attr-label">ì‚¬ìš©ë„êµ¬</div>
                            <div class="attr-value">${task.ì‚¬ìš©ë„êµ¬}</div>
                        </div>
                        <div class="attr-row">
                            <div class="attr-label">ì˜ì¡´ì„±</div>
                            <div class="attr-value">${task.ì˜ì¡´ì„±ì²´ì¸ || '-'}</div>
                        </div>
                        <div class="attr-row">
                            <div class="attr-label">ì§„ë„</div>
                            <div class="attr-value">${task.ì§„ë„}</div>
                        </div>
                        <div class="attr-row">
                            <div class="attr-label">ë¹Œë“œê²°ê³¼</div>
                            <div class="attr-value">${task.ë¹Œë“œê²°ê³¼}</div>
                        </div>
                        <div class="attr-row">
                            <div class="attr-label">ê²€ì¦ê²°ê³¼</div>
                            <div class="attr-value">${task.ì¢…í•©ê²€ì¦ê²°ê³¼}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ========== Area í† ê¸€ ==========
        function toggleArea(area) {
            const element = document.getElementById(`area-${area}`);
            element.classList.toggle('collapsed');
        }

        // ========== ìŠ¹ì¸ ëª¨ë‹¬ ì—´ê¸° ==========
        function openApprovalModal(phase) {
            const phaseTasks = allTasks.filter(t => t.phase === phase);
            const completed = phaseTasks.filter(t => t.ìƒíƒœ.includes('ì™„ë£Œ')).length;

            document.getElementById('phaseSummaryContainer').innerHTML = `
                <h3>ğŸ”’ Phase ${phase} ì™„ë£Œ ê²€ì¦</h3>
                <ul>
                    <li>âœ… ì „ì²´ ì‘ì—…: ${completed}ê°œ ì™„ë£Œ</li>
                    <li>âœ… 1ì°¨ ì‹¤í–‰: ì™„ë£Œ</li>
                    <li>âœ… 2ì°¨ ê²€ì¦: ì™„ë£Œ</li>
                    <li>âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸: í†µê³¼</li>
                </ul>
            `;

            // íƒ€ì„ìŠ¤íƒí”„ ìë™ ìƒì„±
            const now = new Date();
            const timestamp = now.toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('approval-timestamp').textContent = `${timestamp} (ìë™ ìƒì„±)`;

            // ëª¨ë‹¬ ì €ì¥ìš© ë°ì´í„°
            window.currentApprovalPhase = phase;

            document.getElementById('approvalModal').classList.add('active');
        }

        // ========== ìŠ¹ì¸ ëª¨ë‹¬ ë‹«ê¸° ==========
        function closeApprovalModal() {
            document.getElementById('approvalModal').classList.remove('active');
            document.getElementById('approval-notes').value = '';
        }

        // ========== ìŠ¹ì¸ ì œì¶œ ==========
        function submitApproval() {
            const phase = window.currentApprovalPhase;
            const approverName = document.getElementById('approver-name').value;
            const approvalNotes = document.getElementById('approval-notes').value;
            const timestamp = new Date().toISOString();

            // Phase Gate ì •ë³´ ì—…ë°ì´íŠ¸
            phaseGates[phase] = {
                status: 'ìŠ¹ì¸ì™„ë£Œ',
                approved_by: approverName,
                approved_at: timestamp,
                approval_notes: approvalNotes,
                completed_tasks: allTasks.filter(t => t.phase === phase).length,
                total_tasks: allTasks.filter(t => t.phase === phase).length
            };

            console.log(`âœ… Phase ${phase} Gate ìŠ¹ì¸ë¨:`, phaseGates[phase]);

            // ëª¨ë‹¬ ë‹«ê¸°
            closeApprovalModal();

            // UI ì—…ë°ì´íŠ¸
            renderPhaseStatistics();

            // ì„±ê³µ ë©”ì‹œì§€
            alert(`âœ… Phase ${phase} Gate ìŠ¹ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nìŠ¹ì¸ì: ${approverName}\nì‹œê°„: ${formatTimestamp(timestamp)}`);
        }

        // ========== Supabase ë¡œë“œ (ì‹¤ì œ êµ¬í˜„ ì‹œ) ==========
        function loadFromSupabase() {
            // ì‹¤ì œ Supabase ì—°ë™ ë¡œì§
            console.log('Supabaseì—ì„œ ë°ì´í„° ë¡œë”© ì¤‘...');
        }

        // ========== í˜ì´ì§€ ë¡œë“œ ==========
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
