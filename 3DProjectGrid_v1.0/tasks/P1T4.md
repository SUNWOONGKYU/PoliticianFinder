# P1T4 - E2E 테스트 (Playwright)

## 작업 ID
P1T4

## 담당 영역
Test & QA

## 작업 개요
Playwright를 사용하여 사용자 관점의 End-to-End 테스트를 구현합니다.

## 상세 설명
실제 브라우저에서 사용자 시나리오를 자동화하여 전체 플로우가 정상 작동하는지 검증합니다.

## 기술 스택
- Playwright
- @playwright/test

## 구현 사항
1. Playwright 설치 및 설정
2. 회원가입 E2E 테스트
3. 로그인 E2E 테스트
4. 프로필 수정 E2E 테스트
5. 로그아웃 E2E 테스트

## 설치 및 설정
```bash
npm install --save-dev @playwright/test
npx playwright install
```

## playwright.config.js
```javascript
import { defineConfig } from '@playwright/test'

export default defineConfig({
  testDir: './e2e',
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  use: {
    baseURL: 'http://localhost:3000',
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
  },
  projects: [
    {
      name: 'chromium',
      use: { browserName: 'chromium' },
    },
  ],
  webServer: {
    command: 'npm run dev',
    port: 3000,
    reuseExistingServer: !process.env.CI,
  },
})
```

## E2E 테스트 예시

### 회원가입 플로우
```javascript
// e2e/auth/signup.spec.js
import { test, expect } from '@playwright/test'

test('사용자 회원가입 전체 플로우', async ({ page }) => {
  // 회원가입 페이지로 이동
  await page.goto('/signup')
  
  // 폼 입력
  await page.fill('input[name="email"]', 'newuser@example.com')
  await page.fill('input[name="password"]', 'SecurePass123!')
  await page.fill('input[name="name"]', '홍길동')
  
  // 제출
  await page.click('button[type="submit"]')
  
  // 성공 메시지 확인
  await expect(page.locator('text=회원가입 성공')).toBeVisible()
  
  // 이메일 확인 안내 메시지
  await expect(page.locator('text=이메일을 확인해주세요')).toBeVisible()
})
```

### 로그인 플로우
```javascript
// e2e/auth/login.spec.js
import { test, expect } from '@playwright/test'

test('사용자 로그인 및 프로필 접근', async ({ page }) => {
  // 로그인 페이지로 이동
  await page.goto('/login')
  
  // 로그인
  await page.fill('input[name="email"]', 'test@example.com')
  await page.fill('input[name="password"]', 'password123')
  await page.click('button[type="submit"]')
  
  // 홈페이지로 리다이렉트 확인
  await expect(page).toHaveURL('/')
  
  // Navbar에 프로필 링크 확인
  await expect(page.locator('text=프로필')).toBeVisible()
  
  // 프로필 페이지 접근
  await page.click('text=프로필')
  await expect(page).toHaveURL('/profile')
  
  // 프로필 정보 확인
  await expect(page.locator('text=test@example.com')).toBeVisible()
})
```

### 인증 헬퍼 함수
```javascript
// e2e/helpers/auth.js
export async function login(page, email, password) {
  await page.goto('/login')
  await page.fill('input[name="email"]', email)
  await page.fill('input[name="password"]', password)
  await page.click('button[type="submit"]')
  await page.waitForURL('/')
}

export async function logout(page) {
  await page.click('text=로그아웃')
  await page.waitForURL('/login')
}
```

## 테스트 시나리오
1. **회원가입 플로우**: 폼 입력 → 제출 → 이메일 확인 안내
2. **로그인 플로우**: 로그인 → 홈 리다이렉트 → Navbar 변화
3. **프로필 수정**: 로그인 → 프로필 페이지 → 정보 수정 → 저장
4. **로그아웃**: 로그아웃 → 로그인 페이지 이동 → 보호된 페이지 차단

## 성공 기준
- [ ] Playwright 설치 및 설정 완료
- [ ] 회원가입 E2E 테스트 작성 및 통과
- [ ] 로그인 E2E 테스트 작성 및 통과
- [ ] 프로필 수정 E2E 테스트 작성 및 통과
- [ ] 로그아웃 E2E 테스트 작성 및 통과
- [ ] 크로스 브라우저 테스트 (Chrome, Firefox, Safari)

## 의존 작업
- P1F1~P1F6 (Frontend 페이지들)
- P1B1~P1B6 (Backend API)
- P1C1~P1C6 (Authentication)

## 예상 소요 시간
4시간

## 참고 사항
- CI/CD 파이프라인에 E2E 테스트 통합
- 테스트 실행 시간 최적화 (병렬 실행)
- 스크린샷 및 비디오 녹화 활용
- 테스트 격리 및 cleanup 중요
