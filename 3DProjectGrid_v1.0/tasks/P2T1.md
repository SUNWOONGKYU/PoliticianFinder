# P2T1 - ì •ì¹˜ì¸ ëª©ë¡ E2E

**Phase**: Phase 2 - ì •ì¹˜ì¸ ëª©ë¡/ìƒì„¸
**ì˜ì—­**: Test (E2E)
**ë‹´ë‹¹ AI**: devops-troubleshooter
**ìƒíƒœ**: ëŒ€ê¸°
**ì§„ë„**: 0%

---

## ğŸ“‹ ì‘ì—… ê°œìš”

ì •ì¹˜ì¸ ëª©ë¡ í˜ì´ì§€ì˜ End-to-End í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. Playwrightë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ìë™í™”í•˜ê³ , ëª©ë¡ ì¡°íšŒ, ê²€ìƒ‰, í•„í„°ë§, í˜ì´ì§€ë„¤ì´ì…˜ ë“±ì˜ ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.

---

## ğŸ¯ ì‘ì—… ëª©í‘œ

- [ ] Playwright ì„¤ì •
- [ ] ëª©ë¡ ì¡°íšŒ í…ŒìŠ¤íŠ¸
- [ ] ê²€ìƒ‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] í•„í„°ë§ í…ŒìŠ¤íŠ¸ (ì •ë‹¹, ì§€ì—­, ì§ê¸‰)
- [ ] ì •ë ¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] í˜ì´ì§€ë„¤ì´ì…˜ í…ŒìŠ¤íŠ¸
- [ ] ë°˜ì‘í˜• ë””ìì¸ í…ŒìŠ¤íŠ¸
- [ ] CI/CD í†µí•©

---

## ğŸ“ ê¸°ìˆ  ì‚¬ì–‘

### Testing
- Framework: Playwright
- Language: TypeScript
- Runner: npm scripts
- CI: GitHub Actions (P2V2)

---

## ğŸ”— ì˜ì¡´ ì‘ì—…

**ì„ í–‰ ì‘ì—…**: P2F7 (ì •ì¹˜ì¸ ëª©ë¡ í˜ì´ì§€)
**í›„ì† ì‘ì—…**: P2V2 (CI/CD íŒŒì´í”„ë¼ì¸)

---

## âœ… ì™„ë£Œ ê¸°ì¤€

1. Playwright ì„¤ì • ì™„ë£Œ
2. 10ê°œ ì´ìƒì˜ E2E í…ŒìŠ¤íŠ¸ ì‘ì„±
3. ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
4. í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 80% ì´ìƒ
5. CI/CD í†µí•© ì™„ë£Œ
6. ìŠ¤í¬ë¦°ìƒ· ë° ë¹„ë””ì˜¤ ë…¹í™” ì„¤ì •

---

## ğŸ’» êµ¬í˜„ ìƒì„¸

### 1. Playwright ì„¤ì¹˜ ë° ì„¤ì •

```bash
# Playwright ì„¤ì¹˜
npm install -D @playwright/test
npx playwright install

# ë¸Œë¼ìš°ì € ì„¤ì¹˜
npx playwright install chromium firefox webkit
```

**playwright.config.ts**

```typescript
import { defineConfig, devices } from '@playwright/test'

export default defineConfig({
  testDir: './tests/e2e',
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  reporter: 'html',

  use: {
    baseURL: process.env.BASE_URL || 'http://localhost:3000',
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
    video: 'retain-on-failure'
  },

  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] }
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] }
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] }
    },
    {
      name: 'Mobile Chrome',
      use: { ...devices['Pixel 5'] }
    }
  ],

  webServer: {
    command: 'npm run dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI,
    timeout: 120 * 1000
  }
})
```

### 2. ëª©ë¡ ì¡°íšŒ í…ŒìŠ¤íŠ¸

```typescript
// tests/e2e/politicians-list.spec.ts
import { test, expect } from '@playwright/test'

test.describe('ì •ì¹˜ì¸ ëª©ë¡ í˜ì´ì§€', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/politicians')
  })

  test('ì •ì¹˜ì¸ ëª©ë¡ì´ í‘œì‹œëœë‹¤', async ({ page }) => {
    // í˜ì´ì§€ ì œëª© í™•ì¸
    await expect(page).toHaveTitle(/ì •ì¹˜ì¸ ëª©ë¡/)

    // ì •ì¹˜ì¸ ì¹´ë“œê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
    const cards = page.locator('[data-testid="politician-card"]')
    await expect(cards).toHaveCount(10) // ì²« í˜ì´ì§€ 10ê°œ

    // ì²« ë²ˆì§¸ ì¹´ë“œ ë‚´ìš© í™•ì¸
    const firstCard = cards.first()
    await expect(firstCard.locator('[data-testid="politician-name"]')).toBeVisible()
    await expect(firstCard.locator('[data-testid="politician-party"]')).toBeVisible()
    await expect(firstCard.locator('[data-testid="politician-rating"]')).toBeVisible()
  })

  test('ì •ì¹˜ì¸ ì¹´ë“œ í´ë¦­ ì‹œ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™', async ({ page }) => {
    const firstCard = page.locator('[data-testid="politician-card"]').first()
    const politicianName = await firstCard.locator('[data-testid="politician-name"]').textContent()

    await firstCard.click()

    // URL ë³€ê²½ í™•ì¸
    await expect(page).toHaveURL(/\/politicians\/\d+/)

    // ìƒì„¸ í˜ì´ì§€ ì œëª© í™•ì¸
    await expect(page.locator('h1')).toContainText(politicianName!)
  })
})
```

### 3. ê²€ìƒ‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

```typescript
// tests/e2e/politicians-search.spec.ts
import { test, expect } from '@playwright/test'

test.describe('ì •ì¹˜ì¸ ê²€ìƒ‰', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/politicians')
  })

  test('ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰', async ({ page }) => {
    const searchInput = page.locator('[data-testid="search-input"]')
    await searchInput.fill('í™ê¸¸ë™')
    await searchInput.press('Enter')

    // URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í™•ì¸
    await expect(page).toHaveURL(/search=í™ê¸¸ë™/)

    // ê²€ìƒ‰ ê²°ê³¼ í™•ì¸
    const cards = page.locator('[data-testid="politician-card"]')
    await expect(cards).toHaveCountGreaterThan(0)

    // ëª¨ë“  ì¹´ë“œì— "í™ê¸¸ë™" í¬í•¨ í™•ì¸
    const names = await cards.locator('[data-testid="politician-name"]').allTextContents()
    names.forEach(name => {
      expect(name).toContain('í™ê¸¸ë™')
    })
  })

  test('ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ ë©”ì‹œì§€', async ({ page }) => {
    const searchInput = page.locator('[data-testid="search-input"]')
    await searchInput.fill('ì¡´ì¬í•˜ì§€ì•ŠëŠ”ì •ì¹˜ì¸')
    await searchInput.press('Enter')

    await expect(page.locator('[data-testid="no-results"]')).toBeVisible()
    await expect(page.locator('[data-testid="no-results"]')).toContainText('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤')
  })

  test('ê²€ìƒ‰ì–´ ë””ë°”ìš´ì‹±', async ({ page }) => {
    const searchInput = page.locator('[data-testid="search-input"]')

    // ë¹ ë¥´ê²Œ íƒ€ì´í•‘
    await searchInput.type('í™', { delay: 50 })
    await searchInput.type('ê¸¸', { delay: 50 })
    await searchInput.type('ë™', { delay: 50 })

    // 500ms ëŒ€ê¸° (ë””ë°”ìš´ìŠ¤ ì‹œê°„)
    await page.waitForTimeout(600)

    // ê²€ìƒ‰ ì‹¤í–‰ í™•ì¸
    await expect(page).toHaveURL(/search=í™ê¸¸ë™/)
  })
})
```

### 4. í•„í„°ë§ í…ŒìŠ¤íŠ¸

```typescript
// tests/e2e/politicians-filter.spec.ts
import { test, expect } from '@playwright/test'

test.describe('ì •ì¹˜ì¸ í•„í„°ë§', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/politicians')
  })

  test('ì •ë‹¹ í•„í„°', async ({ page }) => {
    // ì •ë‹¹ ë“œë¡­ë‹¤ìš´ ì—´ê¸°
    await page.locator('[data-testid="party-filter"]').click()

    // "ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹" ì„ íƒ
    await page.locator('[data-testid="filter-option-ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹"]').click()

    // URL í™•ì¸
    await expect(page).toHaveURL(/party=ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹/)

    // í•„í„°ë§ ê²°ê³¼ í™•ì¸
    const parties = await page.locator('[data-testid="politician-party"]').allTextContents()
    parties.forEach(party => {
      expect(party).toBe('ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹')
    })

    // í•„í„° ë±ƒì§€ í‘œì‹œ í™•ì¸
    await expect(page.locator('[data-testid="filter-badge"]')).toContainText('ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹')
  })

  test('ë‹¤ì¤‘ í•„í„° (ì •ë‹¹ + ì§€ì—­)', async ({ page }) => {
    // ì •ë‹¹ í•„í„°
    await page.locator('[data-testid="party-filter"]').click()
    await page.locator('[data-testid="filter-option-ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹"]').click()

    // ì§€ì—­ í•„í„°
    await page.locator('[data-testid="region-filter"]').click()
    await page.locator('[data-testid="filter-option-ì„œìš¸"]').click()

    // URL í™•ì¸
    await expect(page).toHaveURL(/party=ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹/)
    await expect(page).toHaveURL(/region=ì„œìš¸/)

    // ê²°ê³¼ í™•ì¸
    const cards = page.locator('[data-testid="politician-card"]')
    const count = await cards.count()
    expect(count).toBeGreaterThan(0)

    // 2ê°œì˜ í•„í„° ë±ƒì§€ í‘œì‹œ
    await expect(page.locator('[data-testid="filter-badge"]')).toHaveCount(2)
  })

  test('í•„í„° ì´ˆê¸°í™”', async ({ page }) => {
    // í•„í„° ì ìš©
    await page.locator('[data-testid="party-filter"]').click()
    await page.locator('[data-testid="filter-option-ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹"]').click()

    // ì´ˆê¸°í™” ë²„íŠ¼ í´ë¦­
    await page.locator('[data-testid="reset-filters"]').click()

    // URL í™•ì¸ (í•„í„° ì œê±°ë¨)
    await expect(page).toHaveURL('/politicians')

    // í•„í„° ë±ƒì§€ ì œê±°ë¨
    await expect(page.locator('[data-testid="filter-badge"]')).toHaveCount(0)
  })
})
```

### 5. ì •ë ¬ í…ŒìŠ¤íŠ¸

```typescript
// tests/e2e/politicians-sort.spec.ts
import { test, expect } from '@playwright/test'

test.describe('ì •ì¹˜ì¸ ì •ë ¬', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/politicians')
  })

  test('í‰ì ìˆœ ì •ë ¬', async ({ page }) => {
    // ì •ë ¬ ë“œë¡­ë‹¤ìš´ ì—´ê¸°
    await page.locator('[data-testid="sort-dropdown"]').click()

    // "í‰ì  ë†’ì€ìˆœ" ì„ íƒ
    await page.locator('[data-testid="sort-option-rating-desc"]').click()

    // URL í™•ì¸
    await expect(page).toHaveURL(/sort=avg_rating&order=desc/)

    // ì •ë ¬ ê²°ê³¼ í™•ì¸
    const ratings = await page
      .locator('[data-testid="politician-rating"]')
      .allTextContents()
      .then(texts => texts.map(t => parseFloat(t)))

    // ë‚´ë¦¼ì°¨ìˆœ í™•ì¸
    for (let i = 0; i < ratings.length - 1; i++) {
      expect(ratings[i]).toBeGreaterThanOrEqual(ratings[i + 1])
    }
  })

  test('ì´ë¦„ìˆœ ì •ë ¬', async ({ page }) => {
    await page.locator('[data-testid="sort-dropdown"]').click()
    await page.locator('[data-testid="sort-option-name-asc"]').click()

    await expect(page).toHaveURL(/sort=name&order=asc/)

    const names = await page.locator('[data-testid="politician-name"]').allTextContents()

    // ê°€ë‚˜ë‹¤ìˆœ í™•ì¸
    const sortedNames = [...names].sort()
    expect(names).toEqual(sortedNames)
  })
})
```

### 6. í˜ì´ì§€ë„¤ì´ì…˜ í…ŒìŠ¤íŠ¸

```typescript
// tests/e2e/politicians-pagination.spec.ts
import { test, expect } from '@playwright/test'

test.describe('í˜ì´ì§€ë„¤ì´ì…˜', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/politicians')
  })

  test('ë‹¤ìŒ í˜ì´ì§€ ì´ë™', async ({ page }) => {
    // 2í˜ì´ì§€ë¡œ ì´ë™
    await page.locator('[data-testid="pagination-next"]').click()

    // URL í™•ì¸
    await expect(page).toHaveURL(/page=2/)

    // ìƒˆë¡œìš´ ì •ì¹˜ì¸ ëª©ë¡ ë¡œë“œ í™•ì¸
    const cards = page.locator('[data-testid="politician-card"]')
    await expect(cards).toHaveCount(10)
  })

  test('íŠ¹ì • í˜ì´ì§€ ë²ˆí˜¸ í´ë¦­', async ({ page }) => {
    // 3í˜ì´ì§€ í´ë¦­
    await page.locator('[data-testid="pagination-page-3"]').click()

    await expect(page).toHaveURL(/page=3/)

    // í™œì„± í˜ì´ì§€ í‘œì‹œ í™•ì¸
    await expect(page.locator('[data-testid="pagination-page-3"]')).toHaveClass(/active/)
  })

  test('ì²« í˜ì´ì§€/ë§ˆì§€ë§‰ í˜ì´ì§€ ë²„íŠ¼', async ({ page }) => {
    // ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ì´ë™
    await page.locator('[data-testid="pagination-last"]').click()

    // ë‹¤ìŒ ë²„íŠ¼ ë¹„í™œì„±í™” í™•ì¸
    await expect(page.locator('[data-testid="pagination-next"]')).toBeDisabled()

    // ì²« í˜ì´ì§€ë¡œ ì´ë™
    await page.locator('[data-testid="pagination-first"]').click()

    await expect(page).toHaveURL(/page=1/)

    // ì´ì „ ë²„íŠ¼ ë¹„í™œì„±í™” í™•ì¸
    await expect(page.locator('[data-testid="pagination-prev"]')).toBeDisabled()
  })
})
```

### 7. ë°˜ì‘í˜• í…ŒìŠ¤íŠ¸

```typescript
// tests/e2e/politicians-responsive.spec.ts
import { test, expect, devices } from '@playwright/test'

test.describe('ë°˜ì‘í˜• ë””ìì¸', () => {
  test('ëª¨ë°”ì¼ í™”ë©´ (375x667)', async ({ page }) => {
    await page.setViewportSize({ width: 375, height: 667 })
    await page.goto('/politicians')

    // ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ í™•ì¸
    const grid = page.locator('[data-testid="politician-grid"]')
    await expect(grid).toHaveCSS('grid-template-columns', /1fr/) // 1ì—´

    // í•„í„° ë²„íŠ¼ í™•ì¸ (ëª¨ë°”ì¼ì—ì„œëŠ” í–„ë²„ê±° ë©”ë‰´)
    await expect(page.locator('[data-testid="mobile-filter-button"]')).toBeVisible()
  })

  test('íƒœë¸”ë¦¿ í™”ë©´ (768x1024)', async ({ page }) => {
    await page.setViewportSize({ width: 768, height: 1024 })
    await page.goto('/politicians')

    // íƒœë¸”ë¦¿ ë ˆì´ì•„ì›ƒ í™•ì¸ (2ì—´)
    const grid = page.locator('[data-testid="politician-grid"]')
    await expect(grid).toHaveCSS('grid-template-columns', /2fr/)
  })

  test('ë°ìŠ¤í¬í†± í™”ë©´ (1920x1080)', async ({ page }) => {
    await page.setViewportSize({ width: 1920, height: 1080 })
    await page.goto('/politicians')

    // ë°ìŠ¤í¬í†± ë ˆì´ì•„ì›ƒ í™•ì¸ (3-4ì—´)
    const grid = page.locator('[data-testid="politician-grid"]')
    const columns = await grid.evaluate(el => {
      return window.getComputedStyle(el).gridTemplateColumns.split(' ').length
    })

    expect(columns).toBeGreaterThanOrEqual(3)
  })
})
```

### 8. package.json ìŠ¤í¬ë¦½íŠ¸

```json
{
  "scripts": {
    "test:e2e": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "test:e2e:headed": "playwright test --headed",
    "test:e2e:debug": "playwright test --debug",
    "test:e2e:report": "playwright show-report"
  }
}
```

---

## ğŸ“ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

### ë¡œì»¬ ì‹¤í–‰

```bash
# ëª¨ë“  E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm run test:e2e

# UI ëª¨ë“œë¡œ ì‹¤í–‰ (ì¸í„°ë™í‹°ë¸Œ)
npm run test:e2e:ui

# í—¤ë“œë¦¬ìŠ¤ ëª¨ë“œ OFF (ë¸Œë¼ìš°ì € ë³´ì´ê¸°)
npm run test:e2e:headed

# ë””ë²„ê·¸ ëª¨ë“œ
npm run test:e2e:debug

# íŠ¹ì • íŒŒì¼ë§Œ ì‹¤í–‰
npx playwright test politicians-list.spec.ts
```

### CI/CD ì‹¤í–‰ (GitHub Actions)

```yaml
# .github/workflows/e2e-tests.yml
name: E2E Tests

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install dependencies
        run: npm ci

      - name: Install Playwright browsers
        run: npx playwright install --with-deps

      - name: Run E2E tests
        run: npm run test:e2e
        env:
          BASE_URL: ${{ secrets.STAGING_URL }}

      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v3
        with:
          name: playwright-report
          path: playwright-report/
```

---

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

- í…ŒìŠ¤íŠ¸ ë°ì´í„°ëŠ” ë³„ë„ DB ì‚¬ìš© (test í™˜ê²½)
- ë¯¼ê° ì •ë³´ëŠ” í™˜ê²½ë³€ìˆ˜ë¡œ ê´€ë¦¬
- Production DBì—ì„œ í…ŒìŠ¤íŠ¸ ê¸ˆì§€

---

## ğŸ“Œ ì°¸ê³ ì‚¬í•­

**ì‘ì—… ì™„ë£Œ ì¼ì‹œ**: ëŒ€ê¸°ì¤‘
**í…ŒìŠ¤íŠ¸/ê²€í†  ê²°ê³¼**: ëŒ€ê¸°
**ìë™í™” ë°©ì‹**: AI-only
**ë¸”ë¡œì»¤**: ì—†ìŒ
**ë¹„ê³ **:
- PlaywrightëŠ” Chromium, Firefox, WebKit ëª¨ë‘ ì§€ì›
- í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ ìŠ¤í¬ë¦°ìƒ· ë° ë¹„ë””ì˜¤ ìë™ ì €ì¥
- CI/CD í†µí•©ìœ¼ë¡œ ìë™í™”ëœ íšŒê·€ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

---

**ì‘ì„± ë°©ë²•ë¡ **: 15DGC-AODM v3.0
**AI-Only ì›ì¹™ ì¤€ìˆ˜**: âœ…
