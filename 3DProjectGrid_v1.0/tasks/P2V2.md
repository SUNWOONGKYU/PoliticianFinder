# P2V2 - CI/CD íŒŒì´í”„ë¼ì¸

**Phase**: Phase 2 - ì •ì¹˜ì¸ ëª©ë¡/ìƒì„¸
**ì˜ì—­**: DevOps
**ë‹´ë‹¹ AI**: devops-troubleshooter
**ìƒíƒœ**: ëŒ€ê¸°
**ì§„ë„**: 0%

---

## ğŸ“‹ ì‘ì—… ê°œìš”

GitHub Actionsë¥¼ ì‚¬ìš©í•˜ì—¬ CI/CD íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•©ë‹ˆë‹¤. ì½”ë“œ í‘¸ì‹œ ì‹œ ìë™ìœ¼ë¡œ ë¦°íŒ…, í…ŒìŠ¤íŠ¸, ë¹Œë“œë¥¼ ì‹¤í–‰í•˜ê³ , ì„±ê³µ ì‹œ ìë™ ë°°í¬í•©ë‹ˆë‹¤.

---

## ğŸ¯ ì‘ì—… ëª©í‘œ

- [ ] GitHub Actions ì›Œí¬í”Œë¡œìš° ì‘ì„±
- [ ] Lint ìë™í™”
- [ ] í…ŒìŠ¤íŠ¸ ìë™í™”
- [ ] ë¹Œë“œ ìë™í™”
- [ ] E2E í…ŒìŠ¤íŠ¸ ìë™í™”
- [ ] ìë™ ë°°í¬ ì„¤ì •
- [ ] PR ì²´í¬ ì„¤ì •

---

## ğŸ“ ê¸°ìˆ  ì‚¬ì–‘

### CI/CD
- Platform: GitHub Actions
- Test: Jest, Playwright
- Deploy: Vercel

---

## ğŸ”— ì˜ì¡´ ì‘ì—…

**ì„ í–‰ ì‘ì—…**: P2V1 (Vercel ë°°í¬)
**í›„ì† ì‘ì—…**: P3V2 (ì—ëŸ¬ íŠ¸ë˜í‚¹ - Phase 3)

---

## âœ… ì™„ë£Œ ê¸°ì¤€

1. GitHub Actions ì›Œí¬í”Œë¡œìš° ì‘ì„± ì™„ë£Œ
2. PR ì²´í¬ ë™ì‘ í™•ì¸
3. í…ŒìŠ¤íŠ¸ ìë™í™” í™•ì¸
4. ìë™ ë°°í¬ ë™ì‘ í™•ì¸
5. ì‹¤íŒ¨ ì‹œ ì•Œë¦¼ ì„¤ì •

---

## ğŸ’» êµ¬í˜„ ìƒì„¸

### 1. CI ì›Œí¬í”Œë¡œìš° (Lint + Test)

```yaml
# .github/workflows/ci.yml
name: CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Run ESLint
        run: npm run lint

      - name: Run TypeScript check
        run: npm run type-check

  test:
    name: Unit & Integration Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Run tests
        run: npm test -- --coverage

      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage/coverage-final.json

  e2e:
    name: E2E Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Install Playwright browsers
        run: npx playwright install --with-deps

      - name: Run E2E tests
        run: npm run test:e2e
        env:
          BASE_URL: http://localhost:3000

      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v3
        with:
          name: playwright-report
          path: playwright-report/

  build:
    name: Build
    runs-on: ubuntu-latest
    needs: [lint, test]
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build project
        run: npm run build
        env:
          NEXT_PUBLIC_SUPABASE_URL: ${{ secrets.NEXT_PUBLIC_SUPABASE_URL }}
          NEXT_PUBLIC_SUPABASE_ANON_KEY: ${{ secrets.NEXT_PUBLIC_SUPABASE_ANON_KEY }}
```

### 2. CD ì›Œí¬í”Œë¡œìš° (ìë™ ë°°í¬)

```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  deploy:
    name: Deploy to Vercel
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Install Vercel CLI
        run: npm install --global vercel@latest

      - name: Pull Vercel Environment
        run: vercel pull --yes --environment=production --token=${{ secrets.VERCEL_TOKEN }}

      - name: Build Project
        run: vercel build --prod --token=${{ secrets.VERCEL_TOKEN }}

      - name: Deploy to Production
        run: vercel deploy --prebuilt --prod --token=${{ secrets.VERCEL_TOKEN }}
```

### 3. PR ì²´í¬ ì›Œí¬í”Œë¡œìš°

```yaml
# .github/workflows/pr-check.yml
name: PR Check

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  pr-check:
    name: PR Validation
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Lint check
        run: npm run lint

      - name: Type check
        run: npm run type-check

      - name: Run tests
        run: npm test

      - name: Build check
        run: npm run build
        env:
          NEXT_PUBLIC_SUPABASE_URL: ${{ secrets.NEXT_PUBLIC_SUPABASE_URL }}
          NEXT_PUBLIC_SUPABASE_ANON_KEY: ${{ secrets.NEXT_PUBLIC_SUPABASE_ANON_KEY }}

      - name: Comment PR
        if: always()
        uses: actions/github-script@v6
        with:
          script: |
            const status = '${{ job.status }}' === 'success' ? 'âœ… í†µê³¼' : 'âŒ ì‹¤íŒ¨'
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.name,
              body: `## PR ì²´í¬ ê²°ê³¼\n\n${status}\n\nëª¨ë“  ê²€ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`
            })
```

### 4. ì˜ì¡´ì„± ì—…ë°ì´íŠ¸ ìë™í™”

```yaml
# .github/dependabot.yml
version: 2
updates:
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 10
    reviewers:
      - "your-username"
    labels:
      - "dependencies"
```

### 5. GitHub Secrets ì„¤ì •

**Settings > Secrets and variables > Actions > New repository secret:**

```
NEXT_PUBLIC_SUPABASE_URL
NEXT_PUBLIC_SUPABASE_ANON_KEY
SUPABASE_SERVICE_ROLE_KEY
VERCEL_TOKEN
VERCEL_ORG_ID
VERCEL_PROJECT_ID
```

### 6. Branch Protection Rules

**Settings > Branches > Add rule:**

- Branch name pattern: `main`
- Require pull request reviews: 1 approval
- Require status checks to pass:
  - Lint
  - Unit & Integration Tests
  - Build
- Require branches to be up to date
- Include administrators: false

---

## ğŸ“ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ í™•ì¸

```bash
# 1. feature ë¸Œëœì¹˜ ìƒì„± ë° ì‘ì—…
git checkout -b feature/test-cicd
git add .
git commit -m "test: CI/CD íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸"
git push origin feature/test-cicd

# 2. GitHubì—ì„œ PR ìƒì„±
# â†’ CI ì›Œí¬í”Œë¡œìš° ìë™ ì‹¤í–‰

# 3. PR ë¨¸ì§€
# â†’ CD ì›Œí¬í”Œë¡œìš° ìë™ ì‹¤í–‰ (main ë¸Œëœì¹˜ ë°°í¬)
```

---

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

- GitHub Secretsë¡œ ë¯¼ê° ì •ë³´ ê´€ë¦¬
- Vercel Tokenì€ ì½ê¸° ì „ìš© ê¶Œí•œë§Œ ë¶€ì—¬
- PRì—ì„œ Secrets ë…¸ì¶œ ë°©ì§€

---

## ğŸ“Œ ì°¸ê³ ì‚¬í•­

**ì‘ì—… ì™„ë£Œ ì¼ì‹œ**: ëŒ€ê¸°ì¤‘
**í…ŒìŠ¤íŠ¸/ê²€í†  ê²°ê³¼**: ëŒ€ê¸°
**ìë™í™” ë°©ì‹**: AI-only
**ë¸”ë¡œì»¤**: ì—†ìŒ
**ë¹„ê³ **: GitHub ActionsëŠ” public repo ë¬´ì œí•œ, private repo ì›” 2000ë¶„ ë¬´ë£Œ

---

**ì‘ì„± ë°©ë²•ë¡ **: 15DGC-AODM v3.0
**AI-Only ì›ì¹™ ì¤€ìˆ˜**: âœ…
