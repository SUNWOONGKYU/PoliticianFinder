# P2F3 - 검색 필터링 UI

**Phase**: Phase 2 - 정치인 목록/상세
**영역**: Frontend
**담당 AI**: fullstack-developer
**상태**: 대기
**진도**: 0%

---

## 📋 작업 개요

정치인 목록 페이지에서 사용할 검색 및 필터링 UI 컴포넌트를 개발합니다. 사용자가 정당, 지역, 직급별로 정치인을 필터링하고, 이름으로 검색할 수 있는 인터페이스를 제공합니다.

---

## 🎯 작업 목표

- [ ] 검색 입력창 컴포넌트 생성
- [ ] 정당 필터 드롭다운 구현
- [ ] 지역 필터 드롭다운 구현
- [ ] 직급 필터 드롭다운 구현
- [ ] 필터 초기화 버튼
- [ ] 실시간 검색 (디바운싱)
- [ ] 선택된 필터 태그 표시
- [ ] URL 쿼리 파라미터 동기화

---

## 📐 기술 사양

### Frontend
- Framework: Next.js 14 (App Router)
- Language: TypeScript
- Styling: Tailwind CSS
- UI Components: shadcn/ui (Select, Input, Button, Badge)
- State Management: React useState + URL Search Params

### 파일 구조
```
frontend/
  src/
    components/
      politician/
        SearchFilter.tsx
        FilterBadge.tsx
    hooks/
      useSearchFilter.ts
```

### SearchFilter Props 인터페이스
```typescript
interface SearchFilterProps {
  onFilterChange: (filters: FilterState) => void
  initialFilters?: FilterState
}

interface FilterState {
  search: string
  party: string[]
  region: string[]
  position: string[]
}
```

---

## 🔗 의존 작업

**선행 작업**: P2B4 (검색/필터 API)
**후속 작업**: P2F7 (정치인 목록 페이지)

---

## ✅ 완료 기준

1. 검색 입력창 구현 (500ms 디바운싱)
2. 정당 필터 다중 선택 드롭다운
3. 지역 필터 다중 선택 드롭다운
4. 직급 필터 다중 선택 드롭다운
5. 선택된 필터 뱃지로 표시
6. 필터 초기화 버튼 동작
7. URL 쿼리 파라미터에 필터 상태 반영
8. TypeScript 타입 안정성 확보

---

## 💻 구현 상세

### 컴포넌트 구조

```typescript
// components/politician/SearchFilter.tsx
'use client'

import { useState, useEffect } from 'react'
import { useRouter, useSearchParams } from 'next/navigation'
import { Input } from '@/components/ui/input'
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'
import { Button } from '@/components/ui/button'
import { Badge } from '@/components/ui/badge'
import { Search, X } from 'lucide-react'
import { useDebounce } from '@/hooks/useDebounce'

interface SearchFilterProps {
  onFilterChange: (filters: FilterState) => void
}

interface FilterState {
  search: string
  party: string[]
  region: string[]
  position: string[]
}

const PARTIES = ['더불어민주당', '국민의힘', '정의당', '무소속']
const REGIONS = ['서울', '경기', '인천', '부산', '대구', '광주', '대전', '울산', '세종', '강원', '충북', '충남', '전북', '전남', '경북', '경남', '제주']
const POSITIONS = ['국회의원', '시장', '도지사', '구청장', '시의원']

export default function SearchFilter({ onFilterChange }: SearchFilterProps) {
  const router = useRouter()
  const searchParams = useSearchParams()

  const [search, setSearch] = useState(searchParams.get('search') || '')
  const [selectedParty, setSelectedParty] = useState<string[]>(
    searchParams.get('party')?.split(',').filter(Boolean) || []
  )
  const [selectedRegion, setSelectedRegion] = useState<string[]>(
    searchParams.get('region')?.split(',').filter(Boolean) || []
  )
  const [selectedPosition, setSelectedPosition] = useState<string[]>(
    searchParams.get('position')?.split(',').filter(Boolean) || []
  )

  const debouncedSearch = useDebounce(search, 500)

  useEffect(() => {
    const filters: FilterState = {
      search: debouncedSearch,
      party: selectedParty,
      region: selectedRegion,
      position: selectedPosition
    }

    onFilterChange(filters)

    // URL 쿼리 파라미터 업데이트
    const params = new URLSearchParams()
    if (debouncedSearch) params.set('search', debouncedSearch)
    if (selectedParty.length) params.set('party', selectedParty.join(','))
    if (selectedRegion.length) params.set('region', selectedRegion.join(','))
    if (selectedPosition.length) params.set('position', selectedPosition.join(','))

    router.push(`?${params.toString()}`, { scroll: false })
  }, [debouncedSearch, selectedParty, selectedRegion, selectedPosition])

  const handleReset = () => {
    setSearch('')
    setSelectedParty([])
    setSelectedRegion([])
    setSelectedPosition([])
    router.push('/', { scroll: false })
  }

  const removeFilter = (type: 'party' | 'region' | 'position', value: string) => {
    if (type === 'party') {
      setSelectedParty(prev => prev.filter(p => p !== value))
    } else if (type === 'region') {
      setSelectedRegion(prev => prev.filter(r => r !== value))
    } else {
      setSelectedPosition(prev => prev.filter(p => p !== value))
    }
  }

  const hasFilters = search || selectedParty.length || selectedRegion.length || selectedPosition.length

  return (
    <div className="space-y-4">
      <div className="flex gap-4 flex-wrap">
        {/* 검색 입력창 */}
        <div className="flex-1 min-w-[250px]">
          <div className="relative">
            <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" />
            <Input
              placeholder="정치인 이름 검색..."
              value={search}
              onChange={(e) => setSearch(e.target.value)}
              className="pl-10"
            />
          </div>
        </div>

        {/* 정당 필터 */}
        <Select
          value={selectedParty[0] || ''}
          onValueChange={(value) => {
            if (!selectedParty.includes(value)) {
              setSelectedParty([...selectedParty, value])
            }
          }}
        >
          <SelectTrigger className="w-[150px]">
            <SelectValue placeholder="정당 선택" />
          </SelectTrigger>
          <SelectContent>
            {PARTIES.map(party => (
              <SelectItem key={party} value={party}>{party}</SelectItem>
            ))}
          </SelectContent>
        </Select>

        {/* 지역 필터 */}
        <Select
          value={selectedRegion[0] || ''}
          onValueChange={(value) => {
            if (!selectedRegion.includes(value)) {
              setSelectedRegion([...selectedRegion, value])
            }
          }}
        >
          <SelectTrigger className="w-[150px]">
            <SelectValue placeholder="지역 선택" />
          </SelectTrigger>
          <SelectContent>
            {REGIONS.map(region => (
              <SelectItem key={region} value={region}>{region}</SelectItem>
            ))}
          </SelectContent>
        </Select>

        {/* 직급 필터 */}
        <Select
          value={selectedPosition[0] || ''}
          onValueChange={(value) => {
            if (!selectedPosition.includes(value)) {
              setSelectedPosition([...selectedPosition, value])
            }
          }}
        >
          <SelectTrigger className="w-[150px]">
            <SelectValue placeholder="직급 선택" />
          </SelectTrigger>
          <SelectContent>
            {POSITIONS.map(position => (
              <SelectItem key={position} value={position}>{position}</SelectItem>
            ))}
          </SelectContent>
        </Select>

        {/* 초기화 버튼 */}
        {hasFilters && (
          <Button variant="outline" onClick={handleReset}>
            <X className="w-4 h-4 mr-2" />
            초기화
          </Button>
        )}
      </div>

      {/* 선택된 필터 뱃지 */}
      {hasFilters && (
        <div className="flex gap-2 flex-wrap">
          {selectedParty.map(party => (
            <Badge key={party} variant="secondary">
              {party}
              <button
                onClick={() => removeFilter('party', party)}
                className="ml-2 hover:text-red-600"
              >
                <X className="w-3 h-3" />
              </button>
            </Badge>
          ))}
          {selectedRegion.map(region => (
            <Badge key={region} variant="secondary">
              {region}
              <button
                onClick={() => removeFilter('region', region)}
                className="ml-2 hover:text-red-600"
              >
                <X className="w-3 h-3" />
              </button>
            </Badge>
          ))}
          {selectedPosition.map(position => (
            <Badge key={position} variant="secondary">
              {position}
              <button
                onClick={() => removeFilter('position', position)}
                className="ml-2 hover:text-red-600"
              >
                <X className="w-3 h-3" />
              </button>
            </Badge>
          ))}
        </div>
      )}
    </div>
  )
}
```

### useDebounce Hook

```typescript
// hooks/useDebounce.ts
import { useState, useEffect } from 'react'

export function useDebounce<T>(value: T, delay: number): T {
  const [debouncedValue, setDebouncedValue] = useState<T>(value)

  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value)
    }, delay)

    return () => {
      clearTimeout(handler)
    }
  }, [value, delay])

  return debouncedValue
}
```

---

## 📝 테스트 계획

### 단위 테스트
- [ ] 검색 입력 디바운싱 테스트
- [ ] 필터 선택/해제 테스트
- [ ] 필터 초기화 테스트
- [ ] URL 쿼리 파라미터 동기화 테스트

### 통합 테스트
- [ ] 필터 변경 시 목록 갱신 테스트
- [ ] 다중 필터 조합 테스트
- [ ] 브라우저 뒤로가기 동작 테스트

---

## 🔒 보안 고려사항

- 입력 값 XSS 방지 (React 자동 이스케이프)
- URL 파라미터 인코딩 처리
- SQL Injection 방지 (백엔드 처리)

---

## 📌 참고사항

**작업 완료 일시**: 대기중
**테스트/검토 결과**: 대기
**자동화 방식**: AI-only
**블로커**: 없음
**비고**: -

---

**작성 방법론**: 15DGC-AODM v3.0
**AI-Only 원칙 준수**: ✅
