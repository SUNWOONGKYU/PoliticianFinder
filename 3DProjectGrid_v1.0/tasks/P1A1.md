# P1A1 - Vercel 배포 설정

## 작업 ID
P1A1

## 담당 영역
DevOps

## 작업 개요
Vercel을 사용하여 Next.js 애플리케이션을 배포하고 자동 배포 파이프라인을 구축합니다.

## 상세 설명
GitHub 저장소와 Vercel을 연동하여 main 브랜치에 푸시할 때마다 자동으로 프로덕션에 배포되도록 설정합니다.

## 기술 스택
- Vercel
- GitHub
- Next.js

## 구현 사항
1. Vercel 계정 생성 및 프로젝트 연결
2. GitHub 저장소 연동
3. 환경 변수 설정
4. 빌드 설정 구성
5. 커스텀 도메인 설정 (선택)
6. 프리뷰 배포 설정

## Vercel 설정

### vercel.json
```json
{
  "buildCommand": "npm run build",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "framework": "nextjs",
  "regions": ["icn1"]
}
```

### 환경 변수 설정
Vercel Dashboard에서 다음 환경 변수 추가:
- `NEXT_PUBLIC_SUPABASE_URL`: Supabase 프로젝트 URL
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Supabase Anon Key
- `SUPABASE_SERVICE_ROLE_KEY`: Service Role Key (서버 사이드 전용)

### 빌드 설정
```json
{
  "build": {
    "env": {
      "NEXT_PUBLIC_SUPABASE_URL": "@supabase-url",
      "NEXT_PUBLIC_SUPABASE_ANON_KEY": "@supabase-anon-key"
    }
  }
}
```

## 자동 배포 플로우
1. `main` 브랜치에 푸시 → 프로덕션 배포
2. PR 생성 → 프리뷰 배포 생성
3. 브랜치에 푸시 → 개발 환경 배포

## Git Hook 설정
```bash
# .husky/pre-push
#!/bin/sh
npm run test
npm run lint
```

## Vercel CLI 사용
```bash
# Vercel CLI 설치
npm i -g vercel

# 로컬에서 배포 테스트
vercel dev

# 프로덕션 배포
vercel --prod
```

## 배포 체크리스트
- [ ] Next.js 빌드 성공 (`npm run build`)
- [ ] 환경 변수 모두 설정
- [ ] `.env.local`은 `.gitignore`에 포함
- [ ] Supabase URL 프로덕션 환경 확인
- [ ] API Routes 정상 작동 확인

## 성공 기준
- [ ] Vercel 프로젝트 생성 및 연동 완료
- [ ] GitHub 저장소 연동 성공
- [ ] 환경 변수 설정 완료
- [ ] 첫 배포 성공
- [ ] 배포된 사이트 정상 작동
- [ ] PR 프리뷰 배포 확인
- [ ] 커스텀 도메인 연결 (선택)

## 의존 작업
- P1F1~P1F6 (Frontend 완성)
- P1B1~P1B6 (Backend 완성)

## 예상 소요 시간
1.5시간

## 참고 사항
- Vercel 무료 티어: 100GB 대역폭, 무제한 배포
- 서버리스 함수 제한: 10초 실행 시간
- 리전 선택: icn1 (서울)
- Analytics 및 Speed Insights 활용
