# P1E4 - politicians RLS 정책

## 작업 ID
P1E4

## 담당 영역
RLS Policies

## 작업 개요
politicians 테이블에 대한 Row Level Security 정책을 설정합니다.

## 상세 설명
모든 사용자가 정치인 정보를 조회할 수 있고, 관리자만 정치인 정보를 생성/수정/삭제할 수 있도록 RLS 정책을 설정합니다.

## 기술 스택
- Supabase RLS
- PostgreSQL Security

## 구현 사항
1. RLS 활성화
2. SELECT 정책 (모든 정치인 정보 조회 가능)
3. INSERT 정책 (관리자만 생성)
4. UPDATE 정책 (관리자만 수정)
5. DELETE 정책 (관리자만 삭제)

## RLS 정책 SQL
```sql
-- RLS 활성화
ALTER TABLE politicians ENABLE ROW LEVEL SECURITY;

-- SELECT: 모든 정치인 정보 조회 가능
CREATE POLICY "Politicians are viewable by everyone"
ON politicians FOR SELECT
USING (true);

-- INSERT: 관리자만 정치인 추가
CREATE POLICY "Only admins can insert politicians"
ON politicians FOR INSERT
WITH CHECK (
  EXISTS (
    SELECT 1 FROM profiles
    WHERE id = auth.uid() AND role = 'admin'
  )
);

-- UPDATE: 관리자만 정치인 수정
CREATE POLICY "Only admins can update politicians"
ON politicians FOR UPDATE
USING (
  EXISTS (
    SELECT 1 FROM profiles
    WHERE id = auth.uid() AND role = 'admin'
  )
);

-- DELETE: 관리자만 정치인 삭제
CREATE POLICY "Only admins can delete politicians"
ON politicians FOR DELETE
USING (
  EXISTS (
    SELECT 1 FROM profiles
    WHERE id = auth.uid() AND role = 'admin'
  )
);
```

## 성공 기준
- [ ] RLS가 활성화됨
- [ ] 4개 정책이 모두 생성됨
- [ ] 일반 사용자 조회 테스트 성공
- [ ] 일반 사용자 수정 차단 테스트 성공
- [ ] 관리자 CRUD 테스트 성공

## 의존 작업
- P1D2 (politicians 테이블)
- P1D1 (profiles 테이블 - role 컬럼)

## 예상 소요 시간
40분

## 참고 사항
- profiles 테이블에 role 컬럼 추가 필요
- 관리자 역할 관리 별도 구현 필요
