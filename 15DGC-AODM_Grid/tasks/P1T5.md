# P1T5 - 테스트 커버리지 리포트

## 작업 ID
P1T5

## 담당 영역
Test & QA

## 작업 개요
전체 테스트 커버리지를 측정하고 리포트를 생성합니다.

## 상세 설명
Jest와 Playwright의 커버리지 데이터를 수집하여 종합 리포트를 생성하고, 커버리지 목표를 달성하도록 합니다.

## 기술 스택
- Jest Coverage
- Istanbul/NYC
- Codecov (선택)

## 구현 사항
1. Jest 커버리지 설정
2. 커버리지 리포트 생성
3. HTML 리포트 생성
4. 커버리지 임계값 설정
5. CI/CD 통합

## Jest 커버리지 설정
```javascript
// jest.config.js
module.exports = {
  // ... 기존 설정
  collectCoverage: true,
  collectCoverageFrom: [
    'src/**/*.{js,jsx,ts,tsx}',
    '!src/**/*.d.ts',
    '!src/**/*.stories.{js,jsx,ts,tsx}',
    '!src/**/__tests__/**',
  ],
  coverageThreshold: {
    global: {
      branches: 70,
      functions: 70,
      lines: 70,
      statements: 70,
    },
  },
  coverageReporters: ['json', 'lcov', 'text', 'html'],
}
```

## package.json 스크립트
```json
{
  "scripts": {
    "test": "jest",
    "test:coverage": "jest --coverage",
    "test:coverage:open": "jest --coverage && open coverage/lcov-report/index.html"
  }
}
```

## 커버리지 리포트 분석

### 커버리지 메트릭
- **Statements**: 실행된 구문 비율
- **Branches**: 실행된 분기 비율 (if/else 등)
- **Functions**: 실행된 함수 비율
- **Lines**: 실행된 코드 라인 비율

### 목표 커버리지
- 전체: 70% 이상
- 핵심 로직(Auth, API): 80% 이상
- UI 컴포넌트: 60% 이상

## 커버리지 개선 전략
1. 테스트되지 않은 파일 식별
2. 분기 커버리지 낮은 부분 개선
3. 엣지 케이스 테스트 추가
4. 에러 핸들링 테스트 강화

## .gitignore 추가
```
# Coverage
coverage/
.nyc_output/
*.lcov
```

## CI/CD 통합 (GitHub Actions 예시)
```yaml
# .github/workflows/test.yml
name: Test Coverage

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm run test:coverage
      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage/lcov.info
```

## 리포트 예시
```
--------------------|---------|----------|---------|---------|
File                | % Stmts | % Branch | % Funcs | % Lines |
--------------------|---------|----------|---------|---------|
All files           |   75.5  |   68.2   |   72.8  |   75.1  |
 components/        |   80.3  |   75.5   |   78.9  |   80.1  |
  Navbar.jsx        |   85.7  |   80.0   |   83.3  |   85.7  |
 pages/             |   70.1  |   60.8   |   65.2  |   69.8  |
  login.jsx         |   78.5  |   70.0   |   75.0  |   78.5  |
 utils/             |   90.2  |   85.5   |   88.8  |   90.0  |
--------------------|---------|----------|---------|---------|
```

## 성공 기준
- [ ] Jest 커버리지 설정 완료
- [ ] 전체 커버리지 70% 이상 달성
- [ ] HTML 리포트 생성 성공
- [ ] 커버리지 임계값 설정 완료
- [ ] 미커버 코드 분석 및 개선 계획 수립
- [ ] CI/CD에 커버리지 체크 통합

## 의존 작업
- P1T1 (Jest 테스트 환경)
- P1T2 (컴포넌트 테스트)
- P1T3 (API 통합 테스트)
- P1T4 (E2E 테스트)

## 예상 소요 시간
2시간

## 참고 사항
- 100% 커버리지가 목표가 아님 (실용적 접근)
- 중요한 비즈니스 로직 우선 커버
- 정기적으로 커버리지 모니터링
- PR 시 커버리지 감소 방지
