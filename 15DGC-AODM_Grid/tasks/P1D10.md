# P1D10 - activity_logs 테이블

## 작업 ID
P1D10

## 담당 영역
Database

## 작업 개요
사용자 활동 로그를 기록하는 activity_logs 테이블을 생성합니다.

## 상세 설명
시스템 내 사용자의 모든 활동을 기록하는 테이블입니다. 평가, 댓글, 로그인 등의 활동을 추적하여 분석 및 보안 목적으로 활용합니다.

## 기술 스택
- Supabase (PostgreSQL)
- SQL DDL

## 구현 사항
1. activity_logs 테이블 생성
2. 활동 타입 및 메타데이터 저장
3. 시계열 데이터 최적화
4. 파티셔닝 고려

## 테이블 스키마
```sql
CREATE TABLE activity_logs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES profiles(id) ON DELETE SET NULL,
  activity_type VARCHAR(50) NOT NULL, -- 'login', 'rate', 'comment', 'view' 등
  entity_type VARCHAR(50), -- 'politician', 'rating', 'comment' 등
  entity_id UUID,
  metadata JSONB,
  ip_address INET,
  user_agent TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_activity_logs_user ON activity_logs(user_id);
CREATE INDEX idx_activity_logs_type ON activity_logs(activity_type);
CREATE INDEX idx_activity_logs_created ON activity_logs(created_at DESC);
CREATE INDEX idx_activity_logs_entity ON activity_logs(entity_type, entity_id);
```

## 성공 기준
- [ ] activity_logs 테이블이 정상적으로 생성됨
- [ ] JSONB 타입으로 유연한 메타데이터 저장
- [ ] 시계열 인덱스 최적화
- [ ] 테스트 로그 기록 성공

## 의존 작업
- P1D1 (profiles 테이블)

## 예상 소요 시간
40분

## 참고 사항
- JSONB로 확장 가능한 메타데이터 저장
- 로그 데이터는 추후 파티셔닝 고려
- 개인정보 보호를 위한 IP 암호화 검토
- SET NULL로 사용자 삭제 시에도 로그 유지
