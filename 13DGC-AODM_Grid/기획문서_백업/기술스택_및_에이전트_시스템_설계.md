# Politician Finder 기술 스택 및 Claude 중심 멀티 에이전트 시스템 설계

## 📋 목차
1. [기술 스택](#기술-스택)
2. [시스템 아키텍처](#시스템-아키텍처)
3. [Claude 멀티 에이전트 구조](#claude-멀티-에이전트-구조)
4. [모듈/컴포넌트 구조](#모듈컴포넌트-구조)
5. [폴더 구조](#폴더-구조)
6. [에이전트별 작업 분담](#에이전트별-작업-분담)
7. [외부 AI API 활용](#외부-ai-api-활용)

---

## 🎯 개발 전략

**핵심 원칙:**
- 1인 개발 + Claude 중심 멀티 에이전트
- 모듈화 극대화 (에이전트 독립 작업 가능)
- Claude가 ChatGPT 등 외부 AI API 호출
- 명확한 인터페이스로 에이전트 간 협업
- 오픈소스 활용 극대화

---

## 💻 기술 스택

### 📱 프론트엔드

```yaml
프레임워크: Next.js 14 (App Router)
  이유:
    - 파일 기반 라우팅 (에이전트가 이해하기 쉬움)
    - 서버 컴포넌트로 성능 최적화
    - API Routes로 백엔드 없이도 기능 구현 가능
    - Vercel 자동 배포

언어: TypeScript
  이유:
    - 타입 안정성으로 에이전트 실수 방지
    - IDE 자동완성으로 개발 속도 향상
    - 명확한 인터페이스 정의

스타일: Tailwind CSS
  이유:
    - 유틸리티 클래스 (에이전트가 쉽게 스타일링)
    - 커스텀 CSS 최소화
    - 반응형 디자인 간편

UI 컴포넌트: shadcn/ui
  이유:
    - 복사-붙여넣기 가능한 컴포넌트
    - Tailwind 기반
    - 커스터마이징 자유로움
    - Radix UI 기반 (접근성 좋음)

상태 관리: Zustand
  이유:
    - Redux보다 간단
    - 보일러플레이트 적음
    - 에이전트가 이해하기 쉬운 구조

폼 관리: React Hook Form + Zod
  이유:
    - 타입 안전 검증
    - 퍼포먼스 좋음
    - Zod 스키마로 백엔드와 스펙 공유

데이터 페칭: TanStack Query (React Query)
  이유:
    - 캐싱 자동화
    - 로딩/에러 상태 관리
    - 낙관적 업데이트
```

### ⚙️ 백엔드

```yaml
프레임워크: FastAPI
  이유:
    - Python (AI 에이전트 친화적)
    - 자동 API 문서 (Swagger/OpenAPI)
    - 타입 힌팅으로 안정성
    - 비동기 지원

ORM: SQLAlchemy 2.0
  이유:
    - 타입 안전 쿼리
    - 관계형 데이터 모델링
    - 마이그레이션 지원 (Alembic)

검증: Pydantic v2
  이유:
    - FastAPI 기본 통합
    - 타입 검증 자동화
    - JSON 스키마 자동 생성

인증: JWT + FastAPI Security
  이유:
    - 상태 비저장 (Stateless)
    - 모바일 앱 확장 가능
    - 구현 간단

데이터베이스: PostgreSQL
  이유:
    - 프로덕션급 안정성
    - JSON 컬럼 지원
    - Full-text search
    - 무료 호스팅 (Supabase/Railway)

캐싱: Redis (선택)
  이유:
    - AI 평가 결과 캐싱
    - 세션 저장
    - Rate limiting
```

### 🗄️ 데이터베이스 & 인프라

```yaml
메인 DB: PostgreSQL (Supabase/Railway)
  - 사용자, 게시글, 댓글
  - 정치인 데이터
  - AI 평가 점수

파일 스토리지: Supabase Storage 또는 Cloudflare R2
  - 프로필 사진
  - 게시글 첨부파일
  - 리포트 PDF

인증: Supabase Auth (옵션) 또는 자체 JWT
  - 소셜 로그인 (구글, 카카오)
  - 이메일 인증
  - 정치인 본인 인증

배포:
  - 프론트엔드: Vercel (Next.js 최적화)
  - 백엔드: Railway 또는 Render
  - DB: Supabase (무료 500MB)
  - CDN: Cloudflare (무료)
```

### 🤖 AI & 에이전트

```yaml
Master Agent: Claude (Anthropic)
  - 프로젝트 총괄
  - 작업 분해 및 분배
  - 코드 리뷰 및 통합

Sub Agents: Claude Instances
  - Frontend Agent (UI/컴포넌트)
  - Backend Agent (API/DB)
  - Test Agent (테스트 코드)
  - Deploy Agent (배포 자동화)

외부 AI API (Claude가 호출):
  - ChatGPT API (gpt-4-turbo)
    용도: 대안 아이디어, 코드 리뷰
  - Gemini API (gemini-pro)
    용도: 멀티모달 작업, 이미지 분석
  - Perplexity API
    용도: 최신 기술 검색, 문서 검색

개발 도구:
  - Cursor/Claude Code: 메인 개발 에이전트
  - GitHub Copilot: 코드 자동완성
  - v0.dev: UI 컴포넌트 프로토타입
```

### 📦 기타 라이브러리

```yaml
차트/그래프: Recharts
  - AI 평가 점수 시각화
  - 통계 대시보드

날짜 처리: date-fns
  - Moment.js보다 가벼움
  - Tree-shaking 지원

아이콘: Lucide React
  - 일관된 디자인
  - Tree-shaking 지원

마크다운: react-markdown
  - 게시글 리치 텍스트

테스트:
  - Vitest (유닛 테스트)
  - Playwright (E2E 테스트)
  - pytest (백엔드 테스트)
```

---

## 🏗️ 시스템 아키텍처

```
┌──────────────────────────────────────────────────────────────┐
│                         사용자                               │
│                  (브라우저/모바일)                           │
└────────────────────────┬─────────────────────────────────────┘
                         │
                         ▼
┌──────────────────────────────────────────────────────────────┐
│                    Vercel CDN                                │
│              (Next.js App Router)                            │
├──────────────────────────────────────────────────────────────┤
│  📱 프론트엔드 (Next.js 14)                                  │
│  ┌─────────────────────────────────────────────────┐        │
│  │  Pages (App Router)                             │        │
│  │  ├── / (메인)                                   │        │
│  │  ├── /politician/[id] (정치인 상세)            │        │
│  │  ├── /community (커뮤니티)                     │        │
│  │  ├── /post/[id] (게시글 상세)                  │        │
│  │  └── /admin (관리자)                           │        │
│  │                                                 │        │
│  │  Components (shadcn/ui)                         │        │
│  │  ├── PoliticianCard                            │        │
│  │  ├── PostList                                  │        │
│  │  ├── CommentTree                               │        │
│  │  └── AIScoreChart                              │        │
│  │                                                 │        │
│  │  State Management (Zustand)                    │        │
│  │  ├── authStore                                 │        │
│  │  ├── uiStore                                   │        │
│  │  └── postStore                                 │        │
│  └─────────────────────────────────────────────────┘        │
│                         │                                    │
│                         │ API Calls (TanStack Query)         │
└─────────────────────────┼────────────────────────────────────┘
                          │
                          ▼
┌──────────────────────────────────────────────────────────────┐
│           Railway/Render (FastAPI Server)                    │
├──────────────────────────────────────────────────────────────┤
│  ⚙️ 백엔드 (FastAPI)                                         │
│  ┌─────────────────────────────────────────────────┐        │
│  │  API Routes                                     │        │
│  │  ├── /api/v1/auth (인증)                       │        │
│  │  ├── /api/v1/politicians (정치인)              │        │
│  │  ├── /api/v1/posts (게시글)                    │        │
│  │  ├── /api/v1/comments (댓글)                   │        │
│  │  ├── /api/v1/votes (추천/비추천)               │        │
│  │  ├── /api/v1/ratings (평가)                    │        │
│  │  ├── /api/v1/ai-scores (AI 평가)               │        │
│  │  └── /api/v1/admin (관리자)                    │        │
│  │                                                 │        │
│  │  Services (비즈니스 로직)                      │        │
│  │  ├── AuthService                               │        │
│  │  ├── PostService                               │        │
│  │  ├── VoteService                               │        │
│  │  ├── AIScoreService 🤖                         │        │
│  │  └── NotificationService                       │        │
│  │                                                 │        │
│  │  Models (SQLAlchemy)                           │        │
│  │  ├── User                                      │        │
│  │  ├── Politician                                │        │
│  │  ├── Post                                      │        │
│  │  ├── Comment                                   │        │
│  │  └── AIScore                                   │        │
│  └─────────────────────────────────────────────────┘        │
│                         │                                    │
│                         │ SQL Queries                        │
└─────────────────────────┼────────────────────────────────────┘
                          │
                          ▼
┌──────────────────────────────────────────────────────────────┐
│              Supabase / Railway                              │
├──────────────────────────────────────────────────────────────┤
│  🗄️ PostgreSQL Database                                     │
│  ├── users                                                   │
│  ├── politicians                                             │
│  ├── posts                                                   │
│  ├── comments                                                │
│  ├── votes                                                   │
│  ├── ai_scores 🤖                                            │
│  └── notifications                                           │
│                                                              │
│  📦 Supabase Storage (선택)                                  │
│  ├── avatars/                                               │
│  ├── attachments/                                           │
│  └── reports/                                               │
└──────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────┐
│              외부 AI API (Claude가 호출)                     │
├──────────────────────────────────────────────────────────────┤
│  🤖 ChatGPT API                                              │
│  🤖 Gemini API                                               │
│  🤖 Perplexity API                                           │
└──────────────────────────────────────────────────────────────┘
```

---

## 🤖 Claude 멀티 에이전트 구조

### Master-Sub Agent 계층 구조

```
┌───────────────────────────────────────────────────────────┐
│                    👤 당신 (PM)                           │
│              "커뮤니티 게시판 만들어줘"                   │
└─────────────────────────┬─────────────────────────────────┘
                          │
                          ▼
┌───────────────────────────────────────────────────────────┐
│             🧠 Master Claude Agent                        │
│                  (총괄 조정)                              │
├───────────────────────────────────────────────────────────┤
│  역할:                                                    │
│  1. 요구사항 분석 및 작업 분해                           │
│  2. 서브 에이전트에게 작업 분배                          │
│  3. 작업 결과 통합 및 검증                               │
│  4. 필요시 외부 AI API 호출 결정                         │
│  5. 품질 관리 및 코드 리뷰                               │
└─────────────────┬───────────────┬─────────────────────────┘
                  │               │
        ┌─────────┴─────┬─────────┴──────┬───────────┐
        ▼               ▼                ▼           ▼
┌─────────────┐ ┌─────────────┐ ┌──────────────┐ ┌─────────────┐
│ 🎨 Frontend │ │ ⚙️ Backend  │ │ 📊 Database  │ │ 🧪 Test     │
│   Agent     │ │   Agent     │ │   Agent      │ │   Agent     │
├─────────────┤ ├─────────────┤ ├──────────────┤ ├─────────────┤
│ UI/UX       │ │ API 개발    │ │ 스키마 설계  │ │ 단위 테스트 │
│ 컴포넌트    │ │ 비즈니스    │ │ 마이그레이션 │ │ E2E 테스트  │
│ 페이지      │ │ 로직        │ │ 쿼리 최적화  │ │ 통합 테스트 │
│ 스타일링    │ │ 인증/인가   │ │ 인덱스 설계  │ │ 성능 테스트 │
└─────────────┘ └─────────────┘ └──────────────┘ └─────────────┘
        │               │                │           │
        └───────────────┴────────────────┴───────────┘
                          │
                          ▼
            ┌─────────────────────────┐
            │  🔌 외부 AI API 호출   │
            │   (Master가 판단)      │
            ├─────────────────────────┤
            │ ChatGPT: 대안 아이디어 │
            │ Gemini: 이미지 분석    │
            │ Perplexity: 최신 정보  │
            └─────────────────────────┘
```

### 에이전트 간 통신 프로토콜

```typescript
// 에이전트 간 작업 지시 인터페이스
interface AgentTask {
  taskId: string;
  agentType: 'frontend' | 'backend' | 'database' | 'test';
  title: string;
  description: string;
  requirements: string[];
  dependencies: string[]; // 다른 태스크 ID
  inputSpec: Record<string, any>;
  outputSpec: Record<string, any>;
  priority: 'high' | 'medium' | 'low';
  estimatedTime: string;
  externalAI?: {
    provider: 'chatgpt' | 'gemini' | 'perplexity';
    purpose: string;
    apiKey: string;
  };
}

// 작업 결과 인터페이스
interface AgentResult {
  taskId: string;
  status: 'success' | 'failed' | 'needs_review';
  output: any;
  issues: string[];
  suggestions: string[];
  testsPass: boolean;
}
```

---

## 📂 폴더 구조

### 프론트엔드 (Next.js)

```
politician-finder-web/
├── src/
│   ├── app/                          # Next.js App Router
│   │   ├── layout.tsx                # 루트 레이아웃
│   │   ├── page.tsx                  # 메인 페이지
│   │   ├── politician/
│   │   │   └── [id]/
│   │   │       └── page.tsx          # 정치인 상세
│   │   ├── community/
│   │   │   ├── page.tsx              # 게시판 목록
│   │   │   └── [category]/
│   │   │       └── page.tsx          # 카테고리별 게시판
│   │   ├── post/
│   │   │   ├── write/
│   │   │   │   └── page.tsx          # 글쓰기
│   │   │   └── [id]/
│   │   │       └── page.tsx          # 게시글 상세
│   │   ├── admin/
│   │   │   └── page.tsx              # 관리자
│   │   ├── login/
│   │   │   └── page.tsx              # 로그인
│   │   ├── signup/
│   │   │   └── page.tsx              # 회원가입
│   │   └── api/                      # Next.js API Routes (옵션)
│   │       └── ...
│   │
│   ├── components/                   # 재사용 컴포넌트
│   │   ├── ui/                       # shadcn/ui 컴포넌트
│   │   │   ├── button.tsx
│   │   │   ├── card.tsx
│   │   │   ├── dialog.tsx
│   │   │   └── ...
│   │   │
│   │   ├── layout/                   # 레이아웃 컴포넌트
│   │   │   ├── Header.tsx
│   │   │   ├── Footer.tsx
│   │   │   ├── Sidebar.tsx
│   │   │   └── Navigation.tsx
│   │   │
│   │   ├── politician/               # 정치인 관련 컴포넌트
│   │   │   ├── PoliticianCard.tsx
│   │   │   ├── PoliticianProfile.tsx
│   │   │   ├── AIScoreDisplay.tsx
│   │   │   ├── AIScoreChart.tsx
│   │   │   └── RatingStars.tsx
│   │   │
│   │   ├── community/                # 커뮤니티 컴포넌트
│   │   │   ├── PostList.tsx
│   │   │   ├── PostCard.tsx
│   │   │   ├── PostDetail.tsx
│   │   │   ├── CommentTree.tsx
│   │   │   ├── CommentItem.tsx
│   │   │   ├── VoteButtons.tsx
│   │   │   ├── BestPostBadge.tsx
│   │   │   └── ConceptPostBadge.tsx
│   │   │
│   │   ├── auth/                     # 인증 관련
│   │   │   ├── LoginForm.tsx
│   │   │   ├── SignupForm.tsx
│   │   │   └── AuthGuard.tsx
│   │   │
│   │   └── shared/                   # 공통 컴포넌트
│   │       ├── Loading.tsx
│   │       ├── ErrorBoundary.tsx
│   │       ├── Pagination.tsx
│   │       └── SearchBar.tsx
│   │
│   ├── lib/                          # 유틸리티 함수
│   │   ├── api.ts                    # API 클라이언트
│   │   ├── auth.ts                   # 인증 헬퍼
│   │   ├── utils.ts                  # 공통 유틸
│   │   └── constants.ts              # 상수
│   │
│   ├── hooks/                        # 커스텀 훅
│   │   ├── useAuth.ts
│   │   ├── usePoliticians.ts
│   │   ├── usePosts.ts
│   │   ├── useComments.ts
│   │   └── useVotes.ts
│   │
│   ├── store/                        # Zustand 스토어
│   │   ├── authStore.ts
│   │   ├── uiStore.ts
│   │   ├── postStore.ts
│   │   └── notificationStore.ts
│   │
│   ├── types/                        # TypeScript 타입
│   │   ├── api.ts                    # API 타입
│   │   ├── models.ts                 # 데이터 모델
│   │   └── components.ts             # 컴포넌트 Props
│   │
│   └── styles/
│       └── globals.css               # Tailwind 전역 스타일
│
├── public/                           # 정적 파일
│   ├── images/
│   └── icons/
│
├── .env.local                        # 환경 변수
├── next.config.js                    # Next.js 설정
├── tailwind.config.ts                # Tailwind 설정
├── tsconfig.json                     # TypeScript 설정
└── package.json
```

### 백엔드 (FastAPI)

```
politician-finder-api/
├── app/
│   ├── main.py                       # FastAPI 앱 진입점
│   │
│   ├── api/                          # API 라우트
│   │   ├── v1/
│   │   │   ├── __init__.py
│   │   │   ├── auth.py               # 인증 API
│   │   │   ├── politicians.py        # 정치인 API
│   │   │   ├── posts.py              # 게시글 API
│   │   │   ├── comments.py           # 댓글 API
│   │   │   ├── votes.py              # 투표 API
│   │   │   ├── ratings.py            # 평가 API
│   │   │   ├── ai_scores.py          # AI 평가 API
│   │   │   ├── notifications.py      # 알림 API
│   │   │   ├── bookmarks.py          # 북마크 API
│   │   │   ├── reports.py            # 신고 API
│   │   │   └── admin.py              # 관리자 API
│   │   │
│   │   └── deps.py                   # 의존성 주입
│   │
│   ├── core/                         # 핵심 설정
│   │   ├── config.py                 # 환경 설정
│   │   ├── security.py               # JWT, 비밀번호 해싱
│   │   └── database.py               # DB 연결
│   │
│   ├── models/                       # SQLAlchemy 모델
│   │   ├── __init__.py
│   │   ├── user.py
│   │   ├── politician.py
│   │   ├── post.py
│   │   ├── comment.py
│   │   ├── vote.py
│   │   ├── rating.py
│   │   ├── ai_score.py
│   │   ├── notification.py
│   │   └── bookmark.py
│   │
│   ├── schemas/                      # Pydantic 스키마
│   │   ├── __init__.py
│   │   ├── user.py                   # Request/Response 스키마
│   │   ├── politician.py
│   │   ├── post.py
│   │   ├── comment.py
│   │   └── ...
│   │
│   ├── services/                     # 비즈니스 로직
│   │   ├── __init__.py
│   │   ├── auth_service.py
│   │   ├── post_service.py
│   │   ├── vote_service.py
│   │   ├── ai_score_service.py       # 🤖 AI 평가 로직
│   │   ├── notification_service.py
│   │   └── external_ai_service.py    # 🔌 외부 AI API 호출
│   │
│   ├── utils/                        # 유틸리티
│   │   ├── __init__.py
│   │   ├── email.py
│   │   ├── image.py
│   │   └── validators.py
│   │
│   └── tests/                        # 테스트
│       ├── __init__.py
│       ├── test_auth.py
│       ├── test_posts.py
│       └── ...
│
├── alembic/                          # DB 마이그레이션
│   ├── versions/
│   └── env.py
│
├── .env                              # 환경 변수
├── alembic.ini                       # Alembic 설정
├── requirements.txt                  # Python 의존성
└── Dockerfile                        # 도커 설정
```

---

## 🎯 모듈/컴포넌트 구조

### 프론트엔드 컴포넌트 계층

```
App
├── Layout
│   ├── Header
│   │   ├── Logo
│   │   ├── Navigation
│   │   ├── SearchBar
│   │   ├── NotificationBell 🔔
│   │   └── UserMenu
│   │
│   ├── Main Content
│   │   └── [Page Components]
│   │
│   └── Footer
│
└── Pages
    ├── HomePage
    │   ├── AIRankingSection 🤖
    │   │   ├── RankingTabs (전체/지역/당/직급)
    │   │   ├── PoliticianRankingList
    │   │   └── AIScoreDisplay
    │   │
    │   ├── PoliticianPostsSection 🏛️
    │   │   └── PostList (정치인 글만)
    │   │
    │   ├── BestPostsSection 🔥
    │   │   ├── TimeFilter (1h/6h/24h)
    │   │   └── PostList (베스트글)
    │   │
    │   └── PoliticianCardsSection
    │       └── PoliticianCard[]
    │
    ├── PoliticianDetailPage
    │   ├── PoliticianProfile
    │   │   ├── Avatar
    │   │   ├── BasicInfo
    │   │   └── PoliticianBadge 🏛️
    │   │
    │   ├── AIScoreSection 🤖
    │   │   ├── TotalScore
    │   │   ├── AIScoreChart
    │   │   └── DetailedScoreList
    │   │
    │   ├── CitizenRatingSection
    │   │   ├── AverageRating (★★★★☆)
    │   │   └── RatingForm
    │   │
    │   └── RelatedPostsSection
    │       └── PostList
    │
    ├── CommunityPage
    │   ├── CategoryTabs
    │   ├── SortOptions (최신/추천/조회)
    │   ├── PostList
    │   │   └── PostCard
    │   │       ├── Title
    │   │       ├── Author (+ 🏛️ if politician)
    │   │       ├── Stats (👁️ 조회/💬 댓글/⬆️ 추천)
    │   │       └── Badges (🔥 HOT/⭐ 개념글)
    │   │
    │   └── Pagination
    │
    ├── PostDetailPage
    │   ├── PostHeader
    │   │   ├── Author (+ 🏛️ badge)
    │   │   ├── Category
    │   │   └── CreatedAt
    │   │
    │   ├── PostContent
    │   ├── VoteButtons (⬆️ ⬇️)
    │   ├── ActionButtons
    │   │   ├── BookmarkButton ⭐
    │   │   ├── ShareButton
    │   │   └── ReportButton 🚨
    │   │
    │   └── CommentsSection
    │       ├── CommentForm
    │       └── CommentTree
    │           └── CommentItem
    │               ├── Content
    │               ├── VoteButtons (⬆️ ⬇️)
    │               └── ReplyButton
    │
    └── AdminPage
        ├── Dashboard
        ├── PostManagement
        ├── UserManagement
        ├── PoliticianManagement
        ├── ReportManagement 🚨
        └── AIScoreManagement 🤖
```

### 백엔드 서비스 구조

```
Services (비즈니스 로직 계층)
├── AuthService
│   ├── register()
│   ├── login()
│   ├── verify_token()
│   └── politician_auth()
│
├── PoliticianService
│   ├── get_list()
│   ├── get_detail()
│   ├── create()
│   ├── update()
│   └── delete()
│
├── PostService
│   ├── create_post()
│   ├── get_posts()
│   ├── get_post_detail()
│   ├── update_post()
│   ├── delete_post()
│   └── get_best_posts() 🔥
│
├── CommentService
│   ├── create_comment()
│   ├── get_comments()
│   ├── update_comment()
│   └── delete_comment()
│
├── VoteService
│   ├── upvote()
│   ├── downvote()
│   ├── get_vote_count()
│   └── update_post_score()
│
├── RatingService
│   ├── rate_politician()
│   ├── get_average_rating()
│   └── get_user_rating()
│
├── AIScoreService 🤖
│   ├── calculate_score()
│   ├── get_politician_scores()
│   ├── get_ranking()
│   └── update_score()
│
├── ExternalAIService 🔌
│   ├── call_chatgpt()
│   ├── call_gemini()
│   ├── call_perplexity()
│   └── aggregate_responses()
│
├── NotificationService 🔔
│   ├── create_notification()
│   ├── get_user_notifications()
│   ├── mark_as_read()
│   └── send_realtime_notification()
│
└── ReportService 🚨
    ├── create_report()
    ├── get_reports()
    ├── resolve_report()
    └── dismiss_report()
```

---

## 👥 에이전트별 작업 분담

### 🎨 Frontend Agent (UI/UX 전문)

**담당 영역:**
```
✅ 페이지 구현
✅ 컴포넌트 개발
✅ 스타일링 (Tailwind)
✅ 반응형 디자인
✅ 애니메이션
```

**작업 예시:**
```typescript
// Task: 정치인 카드 컴포넌트 만들기
interface PoliticianCardProps {
  politician: {
    id: string;
    name: string;
    party: string;
    region: string;
    position: string;
    imageUrl: string;
    aiScore: number;
    citizenRating: number;
  };
}

// Frontend Agent가 생성할 파일:
// src/components/politician/PoliticianCard.tsx
```

**입력 스펙:**
- 컴포넌트 요구사항 문서
- 디자인 가이드라인
- API 응답 타입 정의

**출력 스펙:**
- React 컴포넌트 파일
- Storybook 스토리 (옵션)
- 컴포넌트 테스트 파일

---

### ⚙️ Backend Agent (API/비즈니스 로직 전문)

**담당 영역:**
```
✅ API 엔드포인트 개발
✅ 비즈니스 로직 구현
✅ 데이터 검증
✅ 인증/인가
✅ 외부 API 통합
```

**작업 예시:**
```python
# Task: 게시글 생성 API 만들기
# Backend Agent가 생성할 파일:
# app/api/v1/posts.py

@router.post("/posts", response_model=PostResponse)
async def create_post(
    post_data: PostCreate,
    current_user: User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    # 비즈니스 로직
    ...
```

**입력 스펙:**
- API 요구사항 문서
- 데이터 모델 정의
- 인증 규칙

**출력 스펙:**
- FastAPI 라우트 함수
- Pydantic 스키마
- 서비스 레이어 코드
- API 문서 (자동 생성)

---

### 📊 Database Agent (DB 스키마 전문)

**담당 영역:**
```
✅ 데이터베이스 스키마 설계
✅ SQLAlchemy 모델 작성
✅ 마이그레이션 스크립트
✅ 인덱스 최적화
✅ 쿼리 최적화
```

**작업 예시:**
```python
# Task: posts 테이블 설계
# Database Agent가 생성할 파일:
# app/models/post.py

class Post(Base):
    __tablename__ = "posts"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False)
    politician_id = Column(Integer, ForeignKey("politicians.id"))
    title = Column(String(200), nullable=False)
    content = Column(Text, nullable=False)
    category = Column(String(50), nullable=False)
    upvotes = Column(Integer, default=0)
    downvotes = Column(Integer, default=0)
    views = Column(Integer, default=0)
    is_best = Column(Boolean, default=False)
    is_concept = Column(Boolean, default=False)
    created_at = Column(DateTime, default=datetime.utcnow)
    
    # 관계 정의
    author = relationship("User", back_populates="posts")
    politician = relationship("Politician", back_populates="posts")
    comments = relationship("Comment", back_populates="post")
    
    # 인덱스
    __table_args__ = (
        Index('idx_posts_category_created', 'category', 'created_at'),
        Index('idx_posts_upvotes', 'upvotes'),
    )
```

**입력 스펙:**
- ERD (Entity Relationship Diagram)
- 데이터 요구사항
- 성능 요구사항

**출력 스펙:**
- SQLAlchemy 모델 파일
- Alembic 마이그레이션 스크립트
- 인덱스 정의
- 관계 매핑

---

### 🧪 Test Agent (품질 보증 전문)

**담당 영역:**
```
✅ 단위 테스트 (Unit Tests)
✅ 통합 테스트 (Integration Tests)
✅ E2E 테스트 (End-to-End Tests)
✅ 성능 테스트
✅ 보안 테스트
```

**작업 예시:**
```typescript
// Task: 게시글 생성 테스트
// Test Agent가 생성할 파일:
// tests/integration/posts.test.ts

describe('POST /api/v1/posts', () => {
  it('should create a new post with valid data', async () => {
    const response = await request(app)
      .post('/api/v1/posts')
      .set('Authorization', `Bearer ${authToken}`)
      .send({
        title: '테스트 게시글',
        content: '내용',
        category: 'general',
        politicianId: 1
      });
    
    expect(response.status).toBe(201);
    expect(response.body).toHaveProperty('id');
  });
  
  it('should fail without authentication', async () => {
    const response = await request(app)
      .post('/api/v1/posts')
      .send({
        title: '테스트',
        content: '내용'
      });
    
    expect(response.status).toBe(401);
  });
});
```

**입력 스펙:**
- 기능 요구사항
- API 스펙
- 테스트 시나리오

**출력 스펙:**
- 테스트 코드 파일
- 테스트 리포트
- 커버리지 리포트

---

### 🔧 DevOps Agent (배포/인프라 전문)

**담당 영역:**
```
✅ CI/CD 파이프라인
✅ 도커 설정
✅ 배포 자동화
✅ 모니터링 설정
✅ 백업 설정
```

**작업 예시:**
```yaml
# Task: GitHub Actions CI/CD 설정
# DevOps Agent가 생성할 파일:
# .github/workflows/deploy.yml

name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run tests
        run: npm test
  
  deploy-frontend:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v20
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
  
  deploy-backend:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Deploy to Railway
        run: railway up
```

---

## 🔌 외부 AI API 활용 (Claude가 호출)

### Master Claude가 외부 AI를 호출하는 시나리오

```python
# app/services/external_ai_service.py

import anthropic
import openai
from google import generativeai as genai

class ExternalAIService:
    """
    Master Claude가 필요시 다른 AI를 호출하는 서비스
    """
    
    def __init__(self):
        self.openai_client = openai.OpenAI(api_key=settings.OPENAI_API_KEY)
        genai.configure(api_key=settings.GOOGLE_API_KEY)
    
    async def get_alternative_perspective(
        self, 
        prompt: str,
        current_response: str
    ) -> dict:
        """
        Master Claude가 작성한 응답에 대해
        ChatGPT의 대안적 관점을 요청
        """
        chatgpt_prompt = f"""
        다음은 Claude가 작성한 코드/답변입니다:
        {current_response}
        
        이에 대한 대안적 접근 방법이나 개선점을 제안해주세요:
        {prompt}
        """
        
        response = self.openai_client.chat.completions.create(
            model="gpt-4-turbo",
            messages=[
                {"role": "system", "content": "코드 리뷰 전문가"},
                {"role": "user", "content": chatgpt_prompt}
            ]
        )
        
        return {
            "provider": "ChatGPT",
            "suggestion": response.choices[0].message.content
        }
    
    async def analyze_image_with_gemini(
        self, 
        image_data: bytes,
        prompt: str
    ) -> dict:
        """
        이미지 분석이 필요할 때 Gemini 호출
        (Claude도 이미지 분석 가능하지만 비교용)
        """
        model = genai.GenerativeModel('gemini-pro-vision')
        response = model.generate_content([prompt, image_data])
        
        return {
            "provider": "Gemini",
            "analysis": response.text
        }
    
    async def search_latest_tech(
        self, 
        query: str
    ) -> dict:
        """
        최신 기술 정보가 필요할 때 Perplexity 호출
        """
        # Perplexity API 호출 (예시)
        response = await perplexity_client.search(query)
        
        return {
            "provider": "Perplexity",
            "findings": response.results
        }
    
    async def aggregate_ai_opinions(
        self,
        prompt: str
    ) -> dict:
        """
        여러 AI의 의견을 종합
        """
        results = await asyncio.gather(
            self.get_alternative_perspective(prompt, ""),
            self.search_latest_tech(prompt)
        )
        
        return {
            "consensus": self._find_consensus(results),
            "divergence": self._find_differences(results),
            "recommendation": self._make_recommendation(results)
        }
```

### 사용 시나리오

```
시나리오 1: 코드 리뷰
┌────────────────────────────────────────┐
│ Master Claude: "게시글 API 코드 작성"  │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ Backend Agent: FastAPI 코드 생성       │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ Master Claude:                         │
│ "코드를 ChatGPT에게도 리뷰 받아보자"  │
│ → external_ai_service.get_alternative  │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ ChatGPT API 호출                       │
│ "이 FastAPI 코드의 개선점은?"         │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ Master Claude:                         │
│ ChatGPT 제안 + 자신의 판단 → 최종 결정│
└────────────────────────────────────────┘

시나리오 2: UI 컴포넌트 디자인
┌────────────────────────────────────────┐
│ Master Claude: "정치인 카드 UI 만들기" │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ Frontend Agent: 기본 컴포넌트 생성     │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ Master Claude: "v0.dev로 대안 확인"   │
│ → v0.dev API 호출                      │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ 여러 디자인 옵션 비교 → 최선 선택     │
└────────────────────────────────────────┘

시나리오 3: 최신 기술 정보
┌────────────────────────────────────────┐
│ Database Agent: "인덱스 최적화 방법?" │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ Master Claude:                         │
│ "Perplexity로 최신 PostgreSQL         │
│  인덱스 전략 검색"                     │
└────────────┬───────────────────────────┘
             │
             ▼
┌────────────────────────────────────────┐
│ 2024-2025년 최신 베스트 프랙티스 습득 │
└────────────────────────────────────────┘
```

---

## 📝 에이전트 작업지시서 템플릿

### Frontend Agent 작업지시서 예시

```markdown
# Frontend Agent 작업지시서

## Task ID: FE-001
## 제목: 정치인 카드 컴포넌트 개발

### 📋 작업 설명
정치인 목록 페이지에 표시될 정치인 카드 컴포넌트를 개발합니다.

### 🎯 요구사항
1. 정치인 사진 (150x150px, 원형)
2. 이름, 소속 정당, 지역구 표시
3. Claude AI 평가 점수 (별 5개 + 숫자)
4. 시민 평가 점수 (별 5개 + 숫자)
5. 호버 시 그림자 효과
6. 클릭 시 상세 페이지로 이동
7. 반응형 디자인 (모바일/데스크탑)

### 📥 Input Spec
```typescript
interface PoliticianCardProps {
  politician: {
    id: string;
    name: string;
    party: string;
    region: string;
    position: string;
    imageUrl: string;
    aiScore: number; // 0-100
    citizenRating: number; // 0-5
  };
  onClick?: (id: string) => void;
}
```

### 📤 Output Spec
- 파일: `src/components/politician/PoliticianCard.tsx`
- shadcn/ui Card 컴포넌트 활용
- Tailwind CSS 스타일링
- TypeScript 타입 안전성
- 테스트 파일: `src/components/politician/PoliticianCard.test.tsx`

### 🎨 디자인 가이드
- 카드 너비: 300px (데스크탑), 100% (모바일)
- 패딩: 1rem
- 보더: 1px solid gray-200
- 보더 반경: 0.5rem
- 호버: shadow-lg

### ✅ 완료 조건
- [ ] 컴포넌트 파일 생성
- [ ] Props 타입 정의
- [ ] 반응형 디자인 구현
- [ ] 테스트 코드 작성 (최소 3개)
- [ ] Storybook 스토리 작성 (옵션)

### 🔗 의존성
- shadcn/ui Card 컴포넌트
- next/image (이미지 최적화)
- Lucide React 아이콘

### 📚 참고 자료
- [shadcn/ui Card 문서](https://ui.shadcn.com/docs/components/card)
- [Next.js Image 문서](https://nextjs.org/docs/app/api-reference/components/image)
- 디자인 시안: `designs/politician-card.fig`

### 🤖 외부 AI 활용 (옵션)
Master Claude가 판단하여 필요시:
- v0.dev로 UI 프로토타입 생성
- ChatGPT로 접근성(a11y) 검토
```

### Backend Agent 작업지시서 예시

```markdown
# Backend Agent 작업지시서

## Task ID: BE-002
## 제목: 게시글 생성 API 개발

### 📋 작업 설명
커뮤니티 게시글을 생성하는 API 엔드포인트를 개발합니다.

### 🎯 요구사항
1. 인증된 사용자만 게시글 작성 가능
2. 정치인은 [정치인 글] 카테고리만 작성 가능
3. 제목 (2-200자), 내용 (10자 이상) 검증
4. 카테고리 및 정치인 ID 선택 (옵션)
5. 작성 시 자동으로 알림 생성 (관련 사용자)
6. Rate limiting (사용자당 5분에 3개 제한)

### 📥 Input Spec
```python
class PostCreate(BaseModel):
    title: str = Field(..., min_length=2, max_length=200)
    content: str = Field(..., min_length=10)
    category: str = Field(..., pattern="^(general|politician_post|region|issue)$")
    politician_id: Optional[int] = None
    
    @validator('category')
    def validate_politician_category(cls, v, values):
        # 정치인은 politician_post만 가능
        ...
```

### 📤 Output Spec
- 파일: `app/api/v1/posts.py`
- HTTP Method: POST
- URL: `/api/v1/posts`
- Status Code: 201 Created
- Response:
```json
{
  "id": 1,
  "title": "제목",
  "content": "내용",
  "category": "general",
  "author": {
    "id": 1,
    "nickname": "유저1",
    "isPolitician": false
  },
  "createdAt": "2025-10-09T10:00:00Z"
}
```

### 🔒 인증/인가
- JWT 토큰 필수
- `get_current_user` 의존성 주입
- 정치인 여부 체크

### 🗄️ 데이터베이스
- Table: `posts`
- 관계: User (author), Politician (optional)
- 트랜잭션 처리 필요

### ✅ 완료 조건
- [ ] API 라우트 함수 작성
- [ ] Pydantic 스키마 정의
- [ ] 비즈니스 로직 구현 (PostService)
- [ ] 권한 검증 로직
- [ ] Rate limiting 구현
- [ ] 단위 테스트 (pytest)
- [ ] API 문서 업데이트 (자동)

### 🔗 의존성
- Database Agent: `posts` 테이블 스키마
- AuthService: `get_current_user`
- NotificationService: 알림 생성

### 🧪 테스트 케이스
1. 정상 게시글 생성
2. 인증 없이 시도 (401)
3. 정치인이 일반 카테고리 시도 (403)
4. 제목/내용 검증 실패 (422)
5. Rate limit 초과 (429)

### 🤖 외부 AI 활용 (옵션)
Master Claude가 판단하여 필요시:
- ChatGPT로 코드 리뷰
- Perplexity로 FastAPI 최신 보안 패턴 검색
```

---

## 🚀 개발 워크플로우

### 1. Master Claude가 작업 분해

```
당신: "커뮤니티 게시판 만들어줘"
         ↓
Master Claude:
"알겠습니다. 다음 작업으로 분해합니다:
 
 1. Frontend Agent: PostList 컴포넌트
 2. Frontend Agent: PostDetail 페이지
 3. Backend Agent: GET /api/v1/posts
 4. Backend Agent: POST /api/v1/posts
 5. Database Agent: posts 테이블 마이그레이션
 6. Test Agent: 통합 테스트
 
 각 에이전트에게 작업지시서를 전달하고
 순서대로 진행하겠습니다."
```

### 2. 서브 에이전트 작업

```
Frontend Agent → PostList.tsx 생성
Backend Agent → posts.py API 생성
Database Agent → 0001_create_posts.py 마이그레이션 생성
Test Agent → test_posts.py 테스트 생성
```

### 3. Master Claude 통합 및 검증

```
Master Claude:
"모든 작업이 완료되었습니다.
 통합 검증 중...
 
 ✅ 프론트엔드 빌드 성공
 ✅ 백엔드 테스트 통과
 ✅ 데이터베이스 마이그레이션 성공
 
 [옵션] ChatGPT로 코드 리뷰 받아볼까요?
 Y/N"
```

### 4. 필요시 외부 AI 호출

```
당신: "Y"
         ↓
Master Claude → ChatGPT API 호출
         ↓
ChatGPT: "전반적으로 좋습니다.
         다만 이 부분은..."
         ↓
Master Claude: "ChatGPT 제안 검토 후
                해당 부분 수정했습니다."
```

---

## 📊 에이전트 성과 측정

```yaml
Frontend Agent:
  - 컴포넌트 생성 속도
  - 디자인 일관성
  - 반응형 완성도
  - 접근성(a11y) 점수

Backend Agent:
  - API 응답 속도
  - 코드 품질 (SonarQube)
  - 테스트 커버리지
  - 보안 취약점

Database Agent:
  - 쿼리 성능
  - 인덱스 효율성
  - 마이그레이션 성공률

Test Agent:
  - 테스트 커버리지
  - 버그 발견율
  - 회귀 테스트 통과율
```

---

## 🎓 에이전트 학습 및 개선

```
Master Claude:
"각 스프린트 종료 후:
 1. 에이전트별 성과 리뷰
 2. 좋은 패턴 → 프롬프트에 추가
 3. 실수 패턴 → 체크리스트에 추가
 4. 외부 AI 활용 효과 분석
 5. 다음 스프린트 최적화"
```

---

**이제 1인 + AI 에이전트 군단으로 개발 시작할 준비가 완료되었습니다!** 🚀

---

글자수: 25,000자 / 작성자: Claude / 프롬프터: 써니
